{"version":3,"file":"panel-topbar.js","names":["window","addEventListener","e","console","log","dataTransfer","dropEffect","target","test","type","PS","dragging","preventDefault","PSHeader","handleDragEnter","currentTarget","draggingRoom","roomid","draggedOverRoom","router","extractRoomID","href","leftIndex","leftRoomList","indexOf","dragOnto","rightIndex","rightRoomList","handleDragStart","fromRoom","toRoomList","toIndex","roomLists","fromRoomList","fromIndex","roomList","length","splice","room","rooms","location","leftRoom","id","mainmenu","rightRoom","update","renderRoomTab","closable","cur","isVisible","notifying","notifications","isSubtleNotifying","className","icon","title","closeButton","idChunks","substr","split","formatid","battle","p1","name","p2","charAt","closeBracketIndex","slice","renderUser","connected","user","userid","named","userColor","BattleLog","color","usernameColor","render","props","style","Config","routes","client","map","marginLeft","leftRoomWidth","prefs","mute","preact","Component","document","body","getElementById","UserRoom","options","classType","isSelf","username","send","PSRoom","UserPanel","userdetailsCache","avatar","group","server","getGroup","groupName","globalGroup","globalGroupName","roomsList","battlebuf","chatbuf","privatebuf","curRoom","roomrank","toRoomid","ownBattle","toUserid","roomLink","isPrivate","push","unshift","away","status","startsWith","Dex","resolveAvatar","users","customgroup","PSRoomPanel","roomTypes","Model","VolumePanel","setVolume","slider","set","Number","value","forceUpdate","setMute","checkbox","checked","componentDidMount","subscriptions","subscribe","effectvolume","musicvolume","notifvolume","OptionsPanel","setTheme","theme"],"sources":["../src/panel-topbar.tsx"],"sourcesContent":["/**\n * Topbar Panel\n *\n * Topbar view - handles the topbar and some generic popups.\n *\n * Also handles global drag-and-drop support.\n *\n * @author Guangcong Luo <guangcongluo@gmail.com>\n * @license AGPLv3\n */\n\nwindow.addEventListener('drop', e => {\n\tconsole.log('drop ' + e.dataTransfer!.dropEffect);\n\tconst target = e.target as HTMLElement;\n\tif (/^text/.test((target as HTMLInputElement).type)) {\n\t\tPS.dragging = null;\n\t\treturn; // Ignore text fields\n\t}\n\n\t// The default team drop action for Firefox is to open the team as a\n\t// URL, which needs to be prevented.\n\t// The default file drop action for most browsers is to open the file\n\t// in the tab, which is generally undesirable anyway.\n\te.preventDefault();\n\tPS.dragging = null;\n});\nwindow.addEventListener('dragend', e => {\n\te.preventDefault();\n\tPS.dragging = null;\n});\nwindow.addEventListener('dragover', e => {\n\t// this prevents the bounce-back animation\n\te.preventDefault();\n});\n\nclass PSHeader extends preact.Component<{style: {}}> {\n\thandleDragEnter = (e: DragEvent) => {\n\t\tconsole.log('dragenter ' + e.dataTransfer!.dropEffect);\n\t\te.preventDefault();\n\t\tif (!PS.dragging) return; // TODO: handle dragging other things onto roomtabs\n\t\t/** the element being passed over */\n\t\tconst target = e.currentTarget as HTMLAnchorElement;\n\n\t\tconst draggingRoom = PS.dragging.roomid;\n\t\tif (draggingRoom === null) return;\n\n\t\tconst draggedOverRoom = PS.router.extractRoomID(target.href);\n\t\tif (draggedOverRoom === null) return; // should never happen\n\t\tif (draggingRoom === draggedOverRoom) return;\n\n\t\tconst leftIndex = PS.leftRoomList.indexOf(draggedOverRoom);\n\t\tif (leftIndex >= 0) {\n\t\t\tthis.dragOnto(draggingRoom, 'leftRoomList', leftIndex);\n\t\t} else {\n\t\t\tconst rightIndex = PS.rightRoomList.indexOf(draggedOverRoom);\n\t\t\tif (rightIndex >= 0) {\n\t\t\t\tthis.dragOnto(draggingRoom, 'rightRoomList', rightIndex);\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// dropEffect !== 'none' prevents bounce-back animation in\n\t\t// Chrome/Safari/Opera\n\t\t// if (e.dataTransfer) e.dataTransfer.dropEffect = 'move';\n\t};\n\thandleDragStart = (e: DragEvent) => {\n\t\tconst roomid = PS.router.extractRoomID((e.currentTarget as HTMLAnchorElement).href);\n\t\tif (!roomid) return; // should never happen\n\n\t\tPS.dragging = {type: 'room', roomid};\n\t};\n\tdragOnto(fromRoom: RoomID, toRoomList: 'leftRoomList' | 'rightRoomList' | 'miniRoomList', toIndex: number) {\n\t\t// one day you will be able to rearrange mainmenu and rooms, but not today\n\t\tif (fromRoom === '' || fromRoom === 'rooms') return;\n\n\t\tif (fromRoom === PS[toRoomList][toIndex]) return;\n\t\tif (fromRoom === '' && toRoomList === 'miniRoomList') return;\n\n\t\tconst roomLists = ['leftRoomList', 'rightRoomList', 'miniRoomList'] as const;\n\t\tlet fromRoomList;\n\t\tlet fromIndex = -1;\n\t\tfor (const roomList of roomLists) {\n\t\t\tfromIndex = PS[roomList].indexOf(fromRoom);\n\t\t\tif (fromIndex >= 0) {\n\t\t\t\tfromRoomList = roomList;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!fromRoomList) return; // shouldn't happen\n\n\t\tif (toRoomList === 'leftRoomList' && toIndex === 0) toIndex = 1; // Home is always leftmost\n\t\tif (toRoomList === 'rightRoomList' && toIndex === PS.rightRoomList.length - 1) toIndex--; // Rooms is always rightmost\n\n\t\tPS[fromRoomList].splice(fromIndex, 1);\n\t\t// if dragging within the same roomlist and toIndex > fromIndex,\n\t\t// toIndex is offset by 1 now. Fortunately for us, we want to\n\t\t// drag to the right of this tab in that case, so the -1 +1\n\t\t// cancel out\n\t\tPS[toRoomList].splice(toIndex, 0, fromRoom);\n\n\t\tconst room = PS.rooms[fromRoom]!;\n\t\tswitch (toRoomList) {\n\t\tcase 'leftRoomList': room.location = 'left'; break;\n\t\tcase 'rightRoomList': room.location = 'right'; break;\n\t\tcase 'miniRoomList': room.location = 'mini-window'; break;\n\t\t}\n\t\tif (fromRoomList !== toRoomList) {\n\t\t\tif (fromRoom === PS.leftRoom.id) {\n\t\t\t\tPS.leftRoom = PS.mainmenu;\n\t\t\t} else if (PS.rightRoom && fromRoom === PS.rightRoom.id) {\n\t\t\t\tPS.rightRoom = PS.rooms['rooms']!;\n\t\t\t}\n\t\t\tif (toRoomList === 'rightRoomList') {\n\t\t\t\tPS.rightRoom = room;\n\t\t\t} else if (toRoomList === 'leftRoomList') {\n\t\t\t\tPS.leftRoom = room;\n\t\t\t}\n\t\t}\n\t\tPS.update();\n\t}\n\trenderRoomTab(id: RoomID) {\n\t\tconst room = PS.rooms[id]!;\n\t\tconst closable = (id === '' || id === 'rooms' ? '' : ' closable');\n\t\tconst cur = PS.isVisible(room) ? ' cur' : '';\n\t\tconst notifying = room.notifications.length ? ' notifying' : room.isSubtleNotifying ? ' subtle-notifying' : '';\n\t\tlet className = `roomtab button${notifying}${closable}${cur}`;\n\t\tlet icon = null;\n\t\tlet title = room.title;\n\t\tlet closeButton = null;\n\t\tswitch (room.type) {\n\t\tcase '':\n\t\tcase 'mainmenu':\n\t\t\ticon = <i class=\"fa fa-home\"></i>;\n\t\t\tbreak;\n\t\tcase 'teambuilder':\n\t\t\ticon = <i class=\"fa fa-pencil-square-o\"></i>;\n\t\t\tbreak;\n\t\tcase 'ladder':\n\t\tcase 'ladderformat':\n\t\t\ticon = <i class=\"fa fa-list-ol\"></i>;\n\t\t\tbreak;\n\t\tcase 'battles':\n\t\t\ticon = <i class=\"fa fa-caret-square-o-right\"></i>;\n\t\t\tbreak;\n\t\tcase 'rooms':\n\t\t\ticon = <i class=\"fa fa-plus\" style=\"margin:7px auto -6px auto\"></i>;\n\t\t\ttitle = '';\n\t\t\tbreak;\n\t\tcase 'battle':\n\t\t\tlet idChunks = id.substr(7).split('-');\n\t\t\tlet formatid;\n\t\t\t// TODO: relocate to room implementation\n\t\t\tif (idChunks.length <= 1) {\n\t\t\t\tif (idChunks[0] === 'uploadedreplay') formatid = 'Uploaded Replay';\n\t\t\t} else {\n\t\t\t\tformatid = idChunks[0];\n\t\t\t}\n\t\t\tif (!title) {\n\t\t\t\tlet battle = (room as any).battle as Battle | undefined;\n\t\t\t\tlet p1 = battle?.p1?.name || '';\n\t\t\t\tlet p2 = battle?.p2?.name || '';\n\t\t\t\tif (p1 && p2) {\n\t\t\t\t\ttitle = `${p1} v. ${p2}`;\n\t\t\t\t} else if (p1 || p2) {\n\t\t\t\t\ttitle = `${p1}${p2}`;\n\t\t\t\t} else {\n\t\t\t\t\ttitle = `(empty room)`;\n\t\t\t\t}\n\t\t\t}\n\t\t\ticon = <i class=\"text\">{formatid}</i>;\n\t\t\tbreak;\n\t\tcase 'chat':\n\t\t\ticon = <i class=\"fa fa-comment-o\"></i>;\n\t\t\tbreak;\n\t\tcase 'html':\n\t\tdefault:\n\t\t\tif (title.charAt(0) === '[') {\n\t\t\t\tlet closeBracketIndex = title.indexOf(']');\n\t\t\t\tif (closeBracketIndex > 0) {\n\t\t\t\t\ticon = <i class=\"text\">{title.slice(1, closeBracketIndex)}</i>;\n\t\t\t\t\ttitle = title.slice(closeBracketIndex + 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\ticon = <i class=\"fa fa-file-text-o\"></i>;\n\t\t\tbreak;\n\t\t}\n\t\tif (closable) {\n\t\t\tcloseButton = <button class=\"closebutton\" name=\"closeRoom\" value={id} aria-label=\"Close\">\n\t\t\t\t<i class=\"fa fa-times-circle\"></i>\n\t\t\t</button>;\n\t\t}\n\t\treturn <li>\n\t\t\t<a\n\t\t\t\tclass={className} href={`/${id}`} draggable={true}\n\t\t\t\tonDragEnter={this.handleDragEnter} onDragStart={this.handleDragStart}\n\t\t\t>\n\t\t\t\t{icon} <span>{title}</span>\n\t\t\t</a>\n\t\t\t{closeButton}\n\t\t</li>;\n\t}\n\trenderUser() {\n\t\tif (!PS.connected) {\n\t\t\treturn <button class=\"button disabled\" disabled><em>Offline</em></button>;\n\t\t}\n\t\tif (!PS.user.userid) {\n\t\t\treturn <button class=\"button disabled\" disabled><em>Connecting...</em></button>;\n\t\t}\n\t\tif (!PS.user.named) {\n\t\t\treturn <a class=\"button\" href=\"login\">Choose name</a>;\n\t\t}\n\t\tconst userColor = window.BattleLog && {color: BattleLog.usernameColor(PS.user.userid)};\n\t\treturn <span class=\"username\" data-name={PS.user.name} style={userColor}>\n\t\t\t<i class=\"fa fa-user\" style=\"color:#779EC5\"></i> {PS.user.name}\n\t\t</span>;\n\t}\n\trender() {\n\t\treturn <div id=\"header\" class=\"header\" style={this.props.style}>\n\t\t\t<img\n\t\t\t\tclass=\"logo\"\n\t\t\t\tsrc={`https://${Config.routes.client}/pokemonshowdownbeta.png`}\n\t\t\t\tsrcset={`https://${Config.routes.client}/pokemonshowdownbeta@2x.png 2x`}\n\t\t\t\talt=\"PokÃ©mon Showdown! (beta)\"\n\t\t\t\twidth=\"146\" height=\"44\"\n\t\t\t/>\n\t\t\t<div class=\"maintabbarbottom\"></div>\n\t\t\t<div class=\"tabbar maintabbar\"><div class=\"inner\">\n\t\t\t\t<ul>\n\t\t\t\t\t{this.renderRoomTab(PS.leftRoomList[0])}\n\t\t\t\t</ul>\n\t\t\t\t<ul>\n\t\t\t\t\t{PS.leftRoomList.slice(1).map(roomid => this.renderRoomTab(roomid))}\n\t\t\t\t</ul>\n\t\t\t\t<ul class=\"siderooms\" style={{float: 'none', marginLeft: PS.leftRoomWidth - 144}}>\n\t\t\t\t\t{PS.rightRoomList.map(roomid => this.renderRoomTab(roomid))}\n\t\t\t\t</ul>\n\t\t\t</div></div>\n\t\t\t<div class=\"userbar\">\n\t\t\t\t{this.renderUser()} {}\n\t\t\t\t<button class=\"icon button\" name=\"joinRoom\" value=\"volume\" title=\"Sound\" aria-label=\"Sound\">\n\t\t\t\t\t<i class={PS.prefs.mute ? 'fa fa-volume-off' : 'fa fa-volume-up'}></i>\n\t\t\t\t</button> {}\n\t\t\t\t<button class=\"icon button\" name=\"joinRoom\" value=\"options\" title=\"Options\" aria-label=\"Options\">\n\t\t\t\t\t<i class=\"fa fa-cog\"></i>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n\npreact.render(<PSMain />, document.body, document.getElementById('ps-frame')!);\n\n/**\n * User popup\n */\n\nclass UserRoom extends PSRoom {\n\treadonly classType = 'user';\n\tuserid: ID;\n\tname: string;\n\tisSelf: boolean;\n\tconstructor(options: RoomOptions) {\n\t\tsuper(options);\n\t\tthis.userid = this.id.slice(5) as ID;\n\t\tthis.isSelf = (this.userid === PS.user.userid);\n\t\tthis.name = options.username as string || this.userid;\n\t\tif (/[a-zA-Z0-9]/.test(this.name.charAt(0))) this.name = ' ' + this.name;\n\t\tPS.send(`|/cmd userdetails ${this.userid}`);\n\t}\n}\n\nclass UserPanel extends PSRoomPanel<UserRoom> {\n\trender() {\n\t\tconst room = this.props.room;\n\t\tconst user = PS.mainmenu.userdetailsCache[room.userid] || {userid: room.userid, avatar: '[loading]'};\n\t\tconst name = room.name.slice(1);\n\n\t\tconst group = PS.server.getGroup(room.name);\n\t\tlet groupName: preact.ComponentChild = group.name || null;\n\t\tif (group.type === 'punishment') {\n\t\t\tgroupName = <span style='color:#777777'>{groupName}</span>;\n\t\t}\n\n\t\tconst globalGroup = PS.server.getGroup(user.group);\n\t\tlet globalGroupName: preact.ComponentChild = globalGroup.name && `Global ${globalGroup.name}` || null;\n\t\tif (globalGroup.type === 'punishment') {\n\t\t\tglobalGroupName = <span style='color:#777777'>{globalGroupName}</span>;\n\t\t}\n\t\tif (globalGroup.name === group.name) groupName = null;\n\n\t\tlet roomsList: preact.ComponentChild = null;\n\t\tif (user.rooms) {\n\t\t\tlet battlebuf = [];\n\t\t\tlet chatbuf = [];\n\t\t\tlet privatebuf = [];\n\t\t\tfor (let roomid in user.rooms) {\n\t\t\t\tif (roomid === 'global') continue;\n\t\t\t\tconst curRoom = user.rooms[roomid];\n\t\t\t\tlet roomrank: preact.ComponentChild = null;\n\t\t\t\tif (!/[A-Za-z0-9]/.test(roomid.charAt(0))) {\n\t\t\t\t\troomrank = <small style=\"color: #888; font-size: 100%\">{roomid.charAt(0)}</small>;\n\t\t\t\t}\n\t\t\t\troomid = toRoomid(roomid);\n\n\t\t\t\tif (roomid.substr(0, 7) === 'battle-') {\n\t\t\t\t\tconst p1 = curRoom.p1!.substr(1);\n\t\t\t\t\tconst p2 = curRoom.p2!.substr(1);\n\t\t\t\t\tconst ownBattle = (PS.user.userid === toUserid(p1) || PS.user.userid === toUserid(p2));\n\t\t\t\t\tconst roomLink = <a href={`/${roomid}`} class={'ilink' + (ownBattle || roomid in PS.rooms ? ' yours' : '')}\n\t\t\t\t\t\ttitle={`${p1 || '?'} v. ${p2 || '?'}`}\n\t\t\t\t\t>{roomrank}{roomid.substr(7)}</a>;\n\t\t\t\t\tif (curRoom.isPrivate) {\n\t\t\t\t\t\tif (privatebuf.length) privatebuf.push(', ');\n\t\t\t\t\t\tprivatebuf.push(roomLink);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (battlebuf.length) battlebuf.push(', ');\n\t\t\t\t\t\tbattlebuf.push(roomLink);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst roomLink = <a href={`/${roomid}`} class={'ilink' + (roomid in PS.rooms ? ' yours' : '')}>\n\t\t\t\t\t\t{roomrank}{roomid}\n\t\t\t\t\t</a>;\n\t\t\t\t\tif (curRoom.isPrivate) {\n\t\t\t\t\t\tif (privatebuf.length) privatebuf.push(\", \");\n\t\t\t\t\t\tprivatebuf.push(roomLink);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (chatbuf.length) chatbuf.push(', ');\n\t\t\t\t\t\tchatbuf.push(roomLink);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (battlebuf.length) battlebuf.unshift(<br />, <em>Battles:</em>, \" \");\n\t\t\tif (chatbuf.length) chatbuf.unshift(<br />, <em>Chatrooms:</em>, \" \");\n\t\t\tif (privatebuf.length) privatebuf.unshift(<br />, <em>Private rooms:</em>, \" \");\n\t\t\tif (battlebuf.length || chatbuf.length || privatebuf.length) {\n\t\t\t\troomsList = <small class=\"rooms\">{battlebuf}{chatbuf}{privatebuf}</small>;\n\t\t\t}\n\t\t} else if (user.rooms === false) {\n\t\t\troomsList = <strong class=\"offline\">OFFLINE</strong>;\n\t\t}\n\n\t\tconst isSelf = user.userid === PS.user.userid;\n\t\tlet away = false;\n\t\tlet status = null;\n\t\tif (user.status) {\n\t\t\taway = user.status.startsWith('!');\n\t\t\tstatus = away ? user.status.slice(1) : user.status;\n\t\t}\n\n\t\treturn <PSPanelWrapper room={room}>\n\t\t\t<div class=\"userdetails\">\n\t\t\t\t{user.avatar !== '[loading]' &&\n\t\t\t\t\t<img\n\t\t\t\t\t\tclass={'trainersprite' + (room.isSelf ? ' yours' : '')}\n\t\t\t\t\t\tsrc={Dex.resolveAvatar('' + (user.avatar || 'unknown'))}\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t\t<strong><a href={`//${Config.routes.users}/${user.userid}`} target=\"_blank\" style={away ? {color: '#888888'} : null}>{name}</a></strong><br />\n\t\t\t\t{status && <div class=\"userstatus\">{status}</div>}\n\t\t\t\t{groupName && <div class=\"usergroup roomgroup\">{groupName}</div>}\n\t\t\t\t{globalGroupName && <div class=\"usergroup globalgroup\">{globalGroupName}</div>}\n\t\t\t\t{user.customgroup && <div class=\"usergroup globalgroup\">{user.customgroup}</div>}\n\t\t\t\t{roomsList}\n\t\t\t</div>\n\t\t\t{isSelf || !PS.user.named ?\n\t\t\t\t<p class=\"buttonbar\">\n\t\t\t\t\t<button class=\"button disabled\" disabled>Challenge</button> {}\n\t\t\t\t\t<button class=\"button disabled\" disabled>Chat</button>\n\t\t\t\t</p>\n\t\t\t:\n\t\t\t\t<p class=\"buttonbar\">\n\t\t\t\t\t<button class=\"button\" data-href={`/challenge-${user.userid}`}>Challenge</button> {}\n\t\t\t\t\t<button class=\"button\" data-href={`/pm-${user.userid}`}>Chat</button> {}\n\t\t\t\t\t<button class=\"button disabled\" name=\"userOptions\">{'\\u2026'}</button>\n\t\t\t\t</p>\n\t\t\t}\n\t\t\t{isSelf && <hr />}\n\t\t\t{isSelf && <p class=\"buttonbar\" style=\"text-align: right\">\n\t\t\t\t<button class=\"button disabled\" name=\"login\"><i class=\"fa fa-pencil\"></i> Change name</button> {}\n\t\t\t\t<button class=\"button\" name=\"cmd\" value=\"/logout\"><i class=\"fa fa-power-off\"></i> Log out</button>\n\t\t\t</p>}\n\t\t</PSPanelWrapper>;\n\t}\n}\n\nPS.roomTypes['user'] = {\n\tModel: UserRoom,\n\tComponent: UserPanel,\n};\n\nclass VolumePanel extends PSRoomPanel {\n\tsetVolume = (e: Event) => {\n\t\tconst slider = e.currentTarget as HTMLInputElement;\n\t\tPS.prefs.set(slider.name as 'effectvolume', Number(slider.value));\n\t\tthis.forceUpdate();\n\t};\n\tsetMute = (e: Event) => {\n\t\tconst checkbox = e.currentTarget as HTMLInputElement;\n\t\tPS.prefs.set('mute', !!checkbox.checked);\n\t\tPS.update();\n\t};\n\tcomponentDidMount() {\n\t\tsuper.componentDidMount();\n\t\tthis.subscriptions.push(PS.prefs.subscribe(() => {\n\t\t\tthis.forceUpdate();\n\t\t}));\n\t}\n\trender() {\n\t\tconst room = this.props.room;\n\t\treturn <PSPanelWrapper room={room}>\n\t\t\t<h3>Volume</h3>\n\t\t\t<p class=\"volume\">\n\t\t\t\t<label class=\"optlabel\">Effects: <span class=\"value\">{!PS.prefs.mute && PS.prefs.effectvolume ? `${PS.prefs.effectvolume}%` : `muted`}</span></label>\n\t\t\t\t{PS.prefs.mute ?\n\t\t\t\t\t<em>(muted)</em> :\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"range\" min=\"0\" max=\"100\" step=\"1\" name=\"effectvolume\" value={PS.prefs.effectvolume}\n\t\t\t\t\t\tonChange={this.setVolume} onInput={this.setVolume} onKeyUp={this.setVolume}\n\t\t\t\t\t/>}\n\t\t\t</p>\n\t\t\t<p class=\"volume\">\n\t\t\t\t<label class=\"optlabel\">Music: <span class=\"value\">{!PS.prefs.mute && PS.prefs.musicvolume ? `${PS.prefs.musicvolume}%` : `muted`}</span></label>\n\t\t\t\t{PS.prefs.mute ?\n\t\t\t\t\t<em>(muted)</em> :\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"range\" min=\"0\" max=\"100\" step=\"1\" name=\"musicvolume\" value={PS.prefs.musicvolume}\n\t\t\t\t\t\tonChange={this.setVolume} onInput={this.setVolume} onKeyUp={this.setVolume}\n\t\t\t\t\t/>}\n\t\t\t</p>\n\t\t\t<p class=\"volume\">\n\t\t\t\t<label class=\"optlabel\">Notifications: <span class=\"value\">{!PS.prefs.mute && PS.prefs.notifvolume ? `${PS.prefs.notifvolume}%` : `muted`}</span></label>\n\t\t\t\t{PS.prefs.mute ?\n\t\t\t\t\t<em>(muted)</em> :\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"range\" min=\"0\" max=\"100\" step=\"1\" name=\"notifvolume\" value={PS.prefs.notifvolume}\n\t\t\t\t\t\tonChange={this.setVolume} onInput={this.setVolume} onKeyUp={this.setVolume}\n\t\t\t\t\t/>}\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\t<label class=\"checkbox\"><input type=\"checkbox\" name=\"mute\" checked={PS.prefs.mute} onChange={this.setMute} /> Mute all</label>\n\t\t\t</p>\n\t\t</PSPanelWrapper>;\n\t}\n}\n\nPS.roomTypes['volume'] = {\n\tComponent: VolumePanel,\n};\n\nclass OptionsPanel extends PSRoomPanel {\n\tsetTheme = (e: Event) => {\n\t\tconst theme = (e.currentTarget as HTMLSelectElement).value as 'light' | 'dark' | 'system';\n\t\tPS.prefs.set('theme', theme);\n\t\tthis.forceUpdate();\n\t};\n\trender() {\n\t\tconst room = this.props.room;\n\t\treturn <PSPanelWrapper room={room}>\n\t\t\t<h3>Graphics</h3>\n\t\t\t<p>\n\t\t\t\t<label class=\"optlabel\">Theme: <select onChange={this.setTheme}>\n\t\t\t\t\t<option value=\"light\" selected={PS.prefs.theme === 'light'}>Light</option>\n\t\t\t\t\t<option value=\"dark\" selected={PS.prefs.theme === 'dark'}>Dark</option>\n\t\t\t\t\t<option value=\"system\" selected={PS.prefs.theme === 'system'}>Match system theme</option>\n\t\t\t\t</select></label>\n\t\t\t</p>\n\t\t</PSPanelWrapper>;\n\t}\n}\n\nPS.roomTypes['options'] = {\n\tComponent: OptionsPanel,\n};\n"],"mappings":"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"}