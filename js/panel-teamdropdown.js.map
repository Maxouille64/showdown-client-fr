{"version":3,"file":"panel-teamdropdown.js","names":["PSTeambuilder","packTeam","team","buf","set","hasHP","name","species","id","toID","item","ability","moves","j","length","moveid","substr","slice","nature","evs","gender","ivs","shiny","level","happiness","undefined","pokeball","hpType","gigantamax","dynamaxLevel","unpackTeam","split","setBuf","parts","push","Dex","get","items","baseSpecies","includes","abilities","map","hp","Number","atk","def","spa","spd","spe","parseInt","misc","exportSet","text","move","first","statNames","stat","BattleStatNames","isNaN","exportTeam","sets","splitPrefix","buffer","delimiter","prefixOffset","delimIndex","indexOf","splitLast","lastIndexOf","parseExportedTeamLine","line","isFirstLine","endsWith","parenIndex","charAt","startsWith","evLines","evLine","trim","spaceIndex","statid","BattleStatIDs","statval","ivLines","ivLine","match","natureIndex","types","isName","hpIVs","HPivs","importTeam","lines","curSet","shift","pop","PS","teams","unpackLine","packedTeam","importTeamBackup","curTeam","format","folder","key","iconCache","packedTeamNames","i","k","TeamFolder","props","cur","value","children","TeamBox","contents","icons","getPokemonIcon","button","noLink","TeamDropdownPanel","gen","setFormat","e","target","currentTarget","forceUpdate","click","curTarget","tagName","parentElement","chooseParentValue","getTeams","list","filter","render","room","parentElem","baseFormat","getAttribute","modid","isFirstLoad","availableWidth","document","body","offsetWidth","width","teamBuckets","teamList","baseGen","genList","hasOtherGens","sort","isEmpty","PSRoomPanel","FormatDropdownPanel","formatsLoaded","window","BattleFormats","selectType","formats","Object","values","challengeShow","searchShow","curSection","curColumnNum","curColumn","columns","column","section","replace","roomTypes","Component"],"sources":["../src/panel-teamdropdown.tsx"],"sourcesContent":["/**\n * Team Selector Panel\n *\n * @author Guangcong Luo <guangcongluo@gmail.com>\n * @license AGPLv3\n */\n\nclass PSTeambuilder {\n\tstatic packTeam(team: PokemonSet[]) {\n\t\tlet buf = '';\n\t\tif (!team) return '';\n\n\t\tfor (const set of team) {\n\t\t\tlet hasHP = '';\n\t\t\tif (buf) buf += ']';\n\n\t\t\t// name\n\t\t\tbuf += set.name || set.species;\n\n\t\t\t// species\n\t\t\tlet id = toID(set.species);\n\t\t\tbuf += '|' + (toID(set.name || set.species) === id ? '' : id);\n\n\t\t\t// item\n\t\t\tbuf += '|' + toID(set.item);\n\n\t\t\t// ability\n\t\t\tid = toID(set.ability);\n\t\t\tbuf += '|' + (id || '-');\n\n\t\t\t// moves\n\t\t\tbuf += '|';\n\t\t\tif (set.moves) {\n\t\t\t\tfor (let j = 0; j < set.moves.length; j++) {\n\t\t\t\t\tlet moveid = toID(set.moves[j]);\n\t\t\t\t\tif (j && !moveid) continue;\n\t\t\t\t\tbuf += (j ? ',' : '') + moveid;\n\t\t\t\t\tif (moveid.substr(0, 11) === 'hiddenpower' && moveid.length > 11) {\n\t\t\t\t\t\thasHP = moveid.slice(11);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// nature\n\t\t\tbuf += '|' + (set.nature || '');\n\n\t\t\t// evs\n\t\t\tif (set.evs) {\n\t\t\t\tbuf += '|' + (set.evs['hp'] || '') + ',' +\n\t\t\t\t\t(set.evs['atk'] || '') + ',' +\n\t\t\t\t\t(set.evs['def'] || '') + ',' +\n\t\t\t\t\t(set.evs['spa'] || '') + ',' +\n\t\t\t\t\t(set.evs['spd'] || '') + ',' +\n\t\t\t\t\t(set.evs['spe'] || '');\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\t// gender\n\t\t\tif (set.gender) {\n\t\t\t\tbuf += '|' + set.gender;\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\t// ivs\n\t\t\tif (set.ivs) {\n\t\t\t\tbuf += '|' + (set.ivs['hp'] === 31 ? '' : set.ivs['hp']) + ',' +\n\t\t\t\t\t(set.ivs['atk'] === 31 ? '' : set.ivs['atk']) + ',' +\n\t\t\t\t\t(set.ivs['def'] === 31 ? '' : set.ivs['def']) + ',' +\n\t\t\t\t\t(set.ivs['spa'] === 31 ? '' : set.ivs['spa']) + ',' +\n\t\t\t\t\t(set.ivs['spd'] === 31 ? '' : set.ivs['spd']) + ',' +\n\t\t\t\t\t(set.ivs['spe'] === 31 ? '' : set.ivs['spe']);\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\t// shiny\n\t\t\tif (set.shiny) {\n\t\t\t\tbuf += '|S';\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\t// level\n\t\t\tif (set.level) {\n\t\t\t\tbuf += '|' + set.level;\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\t// happiness\n\t\t\tif (set.happiness !== undefined) {\n\t\t\t\tbuf += '|' + set.happiness;\n\t\t\t} else {\n\t\t\t\tbuf += '|';\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tset.pokeball || (set.hpType && toID(set.hpType) !== hasHP) || set.gigantamax ||\n\t\t\t\t(set.dynamaxLevel !== undefined && set.dynamaxLevel !== 10)\n\t\t\t) {\n\t\t\t\tbuf += ',' + (set.hpType || '');\n\t\t\t\tbuf += ',' + toID(set.pokeball);\n\t\t\t\tbuf += ',' + (set.gigantamax ? 'G' : '');\n\t\t\t\tbuf += ',' + (set.dynamaxLevel !== undefined && set.dynamaxLevel !== 10 ? set.dynamaxLevel : '');\n\t\t\t}\n\t\t}\n\n\t\treturn buf;\n\t}\n\n\tstatic unpackTeam(buf: string) {\n\t\tif (!buf) return [];\n\n\t\tlet team: PokemonSet[] = [];\n\n\t\tfor (const setBuf of buf.split(`]`)) {\n\t\t\tconst parts = setBuf.split(`|`);\n\t\t\tif (parts.length < 11) continue;\n\t\t\tlet set: PokemonSet = {species: '', moves: []};\n\t\t\tteam.push(set);\n\n\t\t\t// name\n\t\t\tset.name = parts[0];\n\n\t\t\t// species\n\t\t\tset.species = Dex.species.get(parts[1]).name || set.name;\n\n\t\t\t// item\n\t\t\tset.item = Dex.items.get(parts[2]).name;\n\n\t\t\t// ability\n\t\t\tconst species = Dex.species.get(set.species);\n\t\t\tset.ability = parts[3] === '-' ?\n\t\t\t\t'' :\n\t\t\t\t(species.baseSpecies === 'Zygarde' && parts[3] === 'H') ?\n\t\t\t\t'Power Construct' :\n\t\t\t\t['', '0', '1', 'H', 'S'].includes(parts[3]) ?\n\t\t\t\tspecies.abilities[parts[3] as '0' || '0'] || (parts[3] === '' ? '' : '!!!ERROR!!!') :\n\t\t\t\tDex.abilities.get(parts[3]).name;\n\n\t\t\t// moves\n\t\t\tset.moves = parts[4].split(',').map(moveid =>\n\t\t\t\tDex.moves.get(moveid).name\n\t\t\t);\n\n\t\t\t// nature\n\t\t\tset.nature = parts[5] as NatureName;\n\t\t\tif (set.nature as any === 'undefined') set.nature = undefined;\n\n\t\t\t// evs\n\t\t\tif (parts[6]) {\n\t\t\t\tif (parts[6].length > 5) {\n\t\t\t\t\tconst evs = parts[6].split(',');\n\t\t\t\t\tset.evs = {\n\t\t\t\t\t\thp: Number(evs[0]) || 0,\n\t\t\t\t\t\tatk: Number(evs[1]) || 0,\n\t\t\t\t\t\tdef: Number(evs[2]) || 0,\n\t\t\t\t\t\tspa: Number(evs[3]) || 0,\n\t\t\t\t\t\tspd: Number(evs[4]) || 0,\n\t\t\t\t\t\tspe: Number(evs[5]) || 0,\n\t\t\t\t\t};\n\t\t\t\t} else if (parts[6] === '0') {\n\t\t\t\t\tset.evs = {hp: 0, atk: 0, def: 0, spa: 0, spd: 0, spe: 0};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// gender\n\t\t\tif (parts[7]) set.gender = parts[7];\n\n\t\t\t// ivs\n\t\t\tif (parts[8]) {\n\t\t\t\tconst ivs = parts[8].split(',');\n\t\t\t\tset.ivs = {\n\t\t\t\t\thp: ivs[0] === '' ? 31 : Number(ivs[0]),\n\t\t\t\t\tatk: ivs[1] === '' ? 31 : Number(ivs[1]),\n\t\t\t\t\tdef: ivs[2] === '' ? 31 : Number(ivs[2]),\n\t\t\t\t\tspa: ivs[3] === '' ? 31 : Number(ivs[3]),\n\t\t\t\t\tspd: ivs[4] === '' ? 31 : Number(ivs[4]),\n\t\t\t\t\tspe: ivs[5] === '' ? 31 : Number(ivs[5]),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// shiny\n\t\t\tif (parts[9]) set.shiny = true;\n\n\t\t\t// level\n\t\t\tif (parts[10]) set.level = parseInt(parts[9], 10);\n\n\t\t\t// happiness\n\t\t\tif (parts[11]) {\n\t\t\t\tlet misc = parts[11].split(',', 4);\n\t\t\t\tset.happiness = (misc[0] ? Number(misc[0]) : undefined);\n\t\t\t\tset.hpType = misc[1];\n\t\t\t\tset.pokeball = misc[2];\n\t\t\t\tset.gigantamax = !!misc[3];\n\t\t\t\tset.dynamaxLevel = (misc[4] ? Number(misc[4]) : 10);\n\t\t\t}\n\t\t}\n\n\t\treturn team;\n\t}\n\t/**\n\t * (Exports end with two spaces so linebreaks are preserved in Markdown;\n\t * I assume mostly for Reddit.)\n\t */\n\tstatic exportSet(set: PokemonSet) {\n\t\tlet text = '';\n\n\t\t// core\n\t\tif (set.name && set.name !== set.species) {\n\t\t\ttext += `${set.name} (${set.species})`;\n\t\t} else {\n\t\t\ttext += `${set.species}`;\n\t\t}\n\t\tif (set.gender === 'M') text += ` (M)`;\n\t\tif (set.gender === 'F') text += ` (F)`;\n\t\tif (set.item) {\n\t\t\ttext += ` @ ${set.item}`;\n\t\t}\n\t\ttext += `  \\n`;\n\t\tif (set.ability) {\n\t\t\ttext += `Ability: ${set.ability}  \\n`;\n\t\t}\n\t\tif (set.moves) {\n\t\t\tfor (let move of set.moves) {\n\t\t\t\tif (move.substr(0, 13) === 'Hidden Power ') {\n\t\t\t\t\tconst hpType = move.slice(13);\n\t\t\t\t\tmove = move.slice(0, 13);\n\t\t\t\t\tmove = `${move}[${hpType}]`;\n\t\t\t\t}\n\t\t\t\tif (move) {\n\t\t\t\t\ttext += `- ${move}  \\n`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// stats\n\t\tlet first = true;\n\t\tif (set.evs) {\n\t\t\tfor (const stat of Dex.statNames) {\n\t\t\t\tif (!set.evs[stat]) continue;\n\t\t\t\tif (first) {\n\t\t\t\t\ttext += `EVs: `;\n\t\t\t\t\tfirst = false;\n\t\t\t\t} else {\n\t\t\t\t\ttext += ` / `;\n\t\t\t\t}\n\t\t\t\ttext += `${set.evs[stat]} ${BattleStatNames[stat]}`;\n\t\t\t}\n\t\t}\n\t\tif (!first) {\n\t\t\ttext += `  \\n`;\n\t\t}\n\t\tif (set.nature) {\n\t\t\ttext += `${set.nature} Nature  \\n`;\n\t\t}\n\t\tfirst = true;\n\t\tif (set.ivs) {\n\t\t\tfor (const stat of Dex.statNames) {\n\t\t\t\tif (set.ivs[stat] === undefined || isNaN(set.ivs[stat]) || set.ivs[stat] === 31) continue;\n\t\t\t\tif (first) {\n\t\t\t\t\ttext += `IVs: `;\n\t\t\t\t\tfirst = false;\n\t\t\t\t} else {\n\t\t\t\t\ttext += ` / `;\n\t\t\t\t}\n\t\t\t\ttext += `${set.ivs[stat]} ${BattleStatNames[stat]}`;\n\t\t\t}\n\t\t}\n\t\tif (!first) {\n\t\t\ttext += `  \\n`;\n\t\t}\n\n\t\t// details\n\t\tif (set.level && set.level !== 100) {\n\t\t\ttext += `Level: ${set.level}  \\n`;\n\t\t}\n\t\tif (set.shiny) {\n\t\t\ttext += `Shiny: Yes  \\n`;\n\t\t}\n\t\tif (typeof set.happiness === 'number' && set.happiness !== 255 && !isNaN(set.happiness)) {\n\t\t\ttext += `Happiness: ${set.happiness}  \\n`;\n\t\t}\n\t\tif (typeof set.dynamaxLevel === 'number' && set.dynamaxLevel !== 255 && !isNaN(set.dynamaxLevel)) {\n\t\t\ttext += `Dynamax Level: ${set.dynamaxLevel}  \\n`;\n\t\t}\n\t\tif (set.gigantamax) {\n\t\t\ttext += `Gigantamax: Yes  \\n`;\n\t\t}\n\n\t\ttext += `\\n`;\n\t\treturn text;\n\t}\n\tstatic exportTeam(sets: PokemonSet[]) {\n\t\tlet text = '';\n\t\tfor (const set of sets) {\n\t\t\t// core\n\t\t\ttext += PSTeambuilder.exportSet(set);\n\t\t}\n\t\treturn text;\n\t}\n\tstatic splitPrefix(buffer: string, delimiter: string, prefixOffset = 0): [string, string] {\n\t\tconst delimIndex = buffer.indexOf(delimiter);\n\t\tif (delimIndex < 0) return ['', buffer];\n\t\treturn [buffer.slice(prefixOffset, delimIndex), buffer.slice(delimIndex + delimiter.length)];\n\t}\n\tstatic splitLast(buffer: string, delimiter: string): [string, string] {\n\t\tconst delimIndex = buffer.lastIndexOf(delimiter);\n\t\tif (delimIndex < 0) return [buffer, ''];\n\t\treturn [buffer.slice(0, delimIndex), buffer.slice(delimIndex + delimiter.length)];\n\t}\n\tstatic parseExportedTeamLine(line: string, isFirstLine: boolean, set: PokemonSet) {\n\t\tif (isFirstLine) {\n\t\t\tlet item;\n\t\t\t[line, item] = line.split(' @ ');\n\t\t\tif (item) {\n\t\t\t\tset.item = item;\n\t\t\t\tif (toID(set.item) === 'noitem') set.item = '';\n\t\t\t}\n\t\t\tif (line.endsWith(' (M)')) {\n\t\t\t\tset.gender = 'M';\n\t\t\t\tline = line.slice(0, -4);\n\t\t\t}\n\t\t\tif (line.endsWith(' (F)')) {\n\t\t\t\tset.gender = 'F';\n\t\t\t\tline = line.slice(0, -4);\n\t\t\t}\n\t\t\tlet parenIndex = line.lastIndexOf(' (');\n\t\t\tif (line.charAt(line.length - 1) === ')' && parenIndex !== -1) {\n\t\t\t\tset.species = Dex.species.get(line.slice(parenIndex + 2, -1)).name;\n\t\t\t\tset.name = line.slice(0, parenIndex);\n\t\t\t} else {\n\t\t\t\tset.species = Dex.species.get(line).name;\n\t\t\t\tset.name = '';\n\t\t\t}\n\t\t} else if (line.startsWith('Trait: ')) {\n\t\t\tline = line.slice(7);\n\t\t\tset.ability = line;\n\t\t} else if (line.startsWith('Ability: ')) {\n\t\t\tline = line.slice(9);\n\t\t\tset.ability = line;\n\t\t} else if (line === 'Shiny: Yes') {\n\t\t\tset.shiny = true;\n\t\t} else if (line.startsWith('Level: ')) {\n\t\t\tline = line.slice(7);\n\t\t\tset.level = +line;\n\t\t} else if (line.startsWith('Happiness: ')) {\n\t\t\tline = line.slice(11);\n\t\t\tset.happiness = +line;\n\t\t} else if (line.startsWith('Pokeball: ')) {\n\t\t\tline = line.slice(10);\n\t\t\tset.pokeball = line;\n\t\t} else if (line.startsWith('Hidden Power: ')) {\n\t\t\tline = line.slice(14);\n\t\t\tset.hpType = line;\n\t\t} else if (line.startsWith('Dynamax Level: ')) {\n\t\t\tline = line.substr(15);\n\t\t\tset.dynamaxLevel = +line;\n\t\t} else if (line === 'Gigantamax: Yes') {\n\t\t\tset.gigantamax = true;\n\t\t} else if (line.startsWith('EVs: ')) {\n\t\t\tline = line.slice(5);\n\t\t\tlet evLines = line.split('/');\n\t\t\tset.evs = {hp: 0, atk: 0, def: 0, spa: 0, spd: 0, spe: 0};\n\t\t\tfor (let evLine of evLines) {\n\t\t\t\tevLine = evLine.trim();\n\t\t\t\tlet spaceIndex = evLine.indexOf(' ');\n\t\t\t\tif (spaceIndex === -1) continue;\n\t\t\t\tlet statid = BattleStatIDs[evLine.slice(spaceIndex + 1)];\n\t\t\t\tif (!statid) continue;\n\t\t\t\tlet statval = parseInt(evLine.slice(0, spaceIndex), 10);\n\t\t\t\tset.evs[statid] = statval;\n\t\t\t}\n\t\t} else if (line.startsWith('IVs: ')) {\n\t\t\tline = line.slice(5);\n\t\t\tlet ivLines = line.split(' / ');\n\t\t\tset.ivs = {hp: 31, atk: 31, def: 31, spa: 31, spd: 31, spe: 31};\n\t\t\tfor (let ivLine of ivLines) {\n\t\t\t\tivLine = ivLine.trim();\n\t\t\t\tlet spaceIndex = ivLine.indexOf(' ');\n\t\t\t\tif (spaceIndex === -1) continue;\n\t\t\t\tlet statid = BattleStatIDs[ivLine.slice(spaceIndex + 1)];\n\t\t\t\tif (!statid) continue;\n\t\t\t\tlet statval = parseInt(ivLine.slice(0, spaceIndex), 10);\n\t\t\t\tif (isNaN(statval)) statval = 31;\n\t\t\t\tset.ivs[statid] = statval;\n\t\t\t}\n\t\t} else if (line.match(/^[A-Za-z]+ (N|n)ature/)) {\n\t\t\tlet natureIndex = line.indexOf(' Nature');\n\t\t\tif (natureIndex === -1) natureIndex = line.indexOf(' nature');\n\t\t\tif (natureIndex === -1) return;\n\t\t\tline = line.substr(0, natureIndex);\n\t\t\tif (line !== 'undefined') set.nature = line as NatureName;\n\t\t} else if (line.charAt(0) === '-' || line.charAt(0) === '~') {\n\t\t\tline = line.slice(line.charAt(1) === ' ' ? 2 : 1);\n\t\t\tif (line.startsWith('Hidden Power [')) {\n\t\t\t\tconst hpType = line.slice(14, -1) as TypeName;\n\t\t\t\tline = 'Hidden Power ' + hpType;\n\t\t\t\tif (!set.ivs && Dex.types.isName(hpType)) {\n\t\t\t\t\tset.ivs = {hp: 31, atk: 31, def: 31, spa: 31, spd: 31, spe: 31};\n\t\t\t\t\tconst hpIVs = Dex.types.get(hpType).HPivs || {};\n\t\t\t\t\tfor (let stat in hpIVs) {\n\t\t\t\t\t\tset.ivs[stat as StatName] = hpIVs[stat as StatName]!;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (line === 'Frustration' && set.happiness === undefined) {\n\t\t\t\tset.happiness = 0;\n\t\t\t}\n\t\t\tset.moves.push(line);\n\t\t}\n\t}\n\tstatic importTeam(buffer: string): PokemonSet[] {\n\t\tconst lines = buffer.split(\"\\n\");\n\n\t\tconst sets: PokemonSet[] = [];\n\t\tlet curSet: PokemonSet | null = null;\n\n\t\twhile (lines.length && !lines[0]) lines.shift();\n\t\twhile (lines.length && !lines[lines.length - 1]) lines.pop();\n\n\t\tif (lines.length === 1 && lines[0].includes('|')) {\n\t\t\treturn this.unpackTeam(lines[0]);\n\t\t}\n\t\tfor (let line of lines) {\n\t\t\tline = line.trim();\n\t\t\tif (line === '' || line === '---') {\n\t\t\t\tcurSet = null;\n\t\t\t} else if (line.startsWith('===')) {\n\t\t\t\t// team backup format; ignore\n\t\t\t} else if (line.includes('|')) {\n\t\t\t\t// packed format\n\t\t\t\tconst team = PS.teams.unpackLine(line);\n\t\t\t\tif (!team) continue;\n\t\t\t\treturn this.unpackTeam(team.packedTeam);\n\t\t\t} else if (!curSet) {\n\t\t\t\tcurSet = {\n\t\t\t\t\tname: '', species: '', gender: '',\n\t\t\t\t\tmoves: [],\n\t\t\t\t};\n\t\t\t\tsets.push(curSet);\n\t\t\t\tthis.parseExportedTeamLine(line, true, curSet);\n\t\t\t} else {\n\t\t\t\tthis.parseExportedTeamLine(line, false, curSet);\n\t\t\t}\n\t\t}\n\t\treturn sets;\n\t}\n\tstatic importTeamBackup(buffer: string): Team[] {\n\t\tconst teams: Team[] = [];\n\t\tconst lines = buffer.split(\"\\n\");\n\n\t\tlet curTeam: Team | null = null;\n\t\tlet sets: PokemonSet[] | null = null;\n\n\t\tlet curSet: PokemonSet | null = null;\n\n\t\twhile (lines.length && !lines[0]) lines.shift();\n\t\twhile (lines.length && !lines[lines.length - 1]) lines.pop();\n\n\t\tfor (let line of lines) {\n\t\t\tline = line.trim();\n\t\t\tif (line === '' || line === '---') {\n\t\t\t\tcurSet = null;\n\t\t\t} else if (line.startsWith('===')) {\n\t\t\t\tif (curTeam) {\n\t\t\t\t\t// not the first team, store the previous team\n\t\t\t\t\tcurTeam.packedTeam = this.packTeam(sets!);\n\t\t\t\t\tteams.push(curTeam);\n\t\t\t\t}\n\n\t\t\t\tcurTeam = {\n\t\t\t\t\tname: '',\n\t\t\t\t\tformat: '' as ID,\n\t\t\t\t\tpackedTeam: '',\n\t\t\t\t\tfolder: '',\n\t\t\t\t\tkey: '',\n\t\t\t\t\ticonCache: '',\n\t\t\t\t};\n\t\t\t\tsets = [];\n\n\t\t\t\tline = line.slice(3, -3).trim();\n\t\t\t\t[curTeam.format, line] = this.splitPrefix(line, ']', 1) as [ID, string];\n\t\t\t\tif (!curTeam.format) curTeam.format = 'gen8' as ID;\n\t\t\t\telse if (!curTeam.format.startsWith('gen')) curTeam.format = `gen6${curTeam.format}` as ID;\n\n\t\t\t\t[curTeam.folder, curTeam.name] = this.splitPrefix(line, '/');\n\t\t\t} else if (line.includes('|')) {\n\t\t\t\tif (curTeam) {\n\t\t\t\t\t// not the first team, store the previous team\n\t\t\t\t\tcurTeam.packedTeam = this.packTeam(sets!);\n\t\t\t\t\tteams.push(curTeam);\n\t\t\t\t}\n\t\t\t\tcurTeam = null;\n\t\t\t\tcurSet = null;\n\t\t\t\tconst team = PS.teams.unpackLine(line);\n\t\t\t\tif (team) teams.push(team);\n\t\t\t} else if (!curSet) {\n\t\t\t\tif (!sets) continue; // corruption\n\t\t\t\tcurSet = {\n\t\t\t\t\tname: '', species: '', gender: '',\n\t\t\t\t\tmoves: [],\n\t\t\t\t};\n\t\t\t\tsets.push(curSet);\n\t\t\t\tthis.parseExportedTeamLine(line, true, curSet);\n\t\t\t} else {\n\t\t\t\tthis.parseExportedTeamLine(line, false, curSet);\n\t\t\t}\n\t\t}\n\t\tif (curTeam) {\n\t\t\tcurTeam.packedTeam = this.packTeam(sets!);\n\t\t\tteams.push(curTeam);\n\t\t}\n\t\treturn teams;\n\t}\n\n\tstatic packedTeamNames(buf: string) {\n\t\tif (!buf) return [];\n\n\t\tconst team = [];\n\t\tlet i = 0;\n\n\t\twhile (true) {\n\t\t\tconst name = buf.slice(i, buf.indexOf('|', i));\n\t\t\ti = buf.indexOf('|', i) + 1;\n\n\t\t\tteam.push(buf.slice(i, buf.indexOf('|', i)) || name);\n\n\t\t\tfor (let k = 0; k < 9; k++) {\n\t\t\t\ti = buf.indexOf('|', i) + 1;\n\t\t\t}\n\n\t\t\ti = buf.indexOf(']', i) + 1;\n\n\t\t\tif (i < 1) break;\n\t\t}\n\n\t\treturn team;\n\t}\n}\n\nfunction TeamFolder(props: {cur?: boolean, value: string, children: preact.ComponentChildren}) {\n\t// folders are <div>s rather than <button>s because in theory it has\n\t// less weird interactions with HTML5 drag-and-drop\n\tif (props.cur) {\n\t\treturn <div class=\"folder cur\"><div class=\"folderhack3\">\n\t\t\t<div class=\"folderhack1\"></div><div class=\"folderhack2\"></div>\n\t\t\t<div class=\"selectFolder\" data-value={props.value}>{props.children}</div>\n\t\t</div></div>;\n\t}\n\treturn <div class=\"folder\">\n\t\t<div class=\"selectFolder\" data-value={props.value}>{props.children}</div>\n\t</div>;\n}\n\nfunction TeamBox(props: {team: Team | null, noLink?: boolean, button?: boolean}) {\n\tconst team = props.team;\n\tlet contents;\n\tif (team) {\n\t\tlet icons = team.iconCache;\n\t\tif (!icons) {\n\t\t\tif (!team.packedTeam) {\n\t\t\t\ticons = <em>(empty team)</em>;\n\t\t\t} else {\n\t\t\t\ticons = PSTeambuilder.packedTeamNames(team.packedTeam).map(species =>\n\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(species)}></span>\n\t\t\t\t);\n\t\t\t}\n\t\t\tteam.iconCache = icons;\n\t\t}\n\t\tlet format = team.format as string;\n\t\tif (format.startsWith('gen8')) format = format.slice(4);\n\t\tformat = (format ? `[${format}] ` : ``) + (team.folder ? `${team.folder}/` : ``);\n\t\tcontents = [\n\t\t\t<strong>{format && <span>{format}</span>}{team.name}</strong>,\n\t\t\t<small>{icons}</small>,\n\t\t];\n\t} else {\n\t\tcontents = [\n\t\t\t<em>Select a team</em>,\n\t\t];\n\t}\n\tif (props.button) {\n\t\treturn <button class=\"team\" value={team ? team.key : ''}>\n\t\t\t{contents}\n\t\t</button>;\n\t}\n\treturn <div data-href={props.noLink ? '' : `/team-${team ? team.key : ''}`} class=\"team\" draggable>\n\t\t{contents}\n\t</div>;\n}\n\n/**\n * Team selector popup\n */\n\nclass TeamDropdownPanel extends PSRoomPanel {\n\tgen = '';\n\tformat: string | null = null;\n\tgetTeams() {\n\t\tif (!this.format && !this.gen) return PS.teams.list;\n\t\treturn PS.teams.list.filter(team => {\n\t\t\tif (this.gen && !team.format.startsWith(this.gen)) return false;\n\t\t\tif (this.format && team.format !== this.format) return false;\n\t\t\treturn true;\n\t\t});\n\t}\n\tsetFormat = (e: MouseEvent) => {\n\t\tconst target = e.currentTarget as HTMLButtonElement;\n\t\tthis.format = (target.name === 'format' && target.value) || '';\n\t\tthis.gen = (target.name === 'gen' && target.value) || '';\n\t\tthis.forceUpdate();\n\t};\n\tclick = (e: MouseEvent) => {\n\t\tlet curTarget = e.target as HTMLElement | null;\n\t\tlet target;\n\t\twhile (curTarget && curTarget !== e.currentTarget) {\n\t\t\tif (curTarget.tagName === 'BUTTON') {\n\t\t\t\ttarget = curTarget as HTMLButtonElement;\n\t\t\t}\n\t\t\tcurTarget = curTarget.parentElement;\n\t\t}\n\t\tif (!target) return;\n\n\t\tthis.chooseParentValue(target.value);\n\t};\n\trender() {\n\t\tconst room = this.props.room;\n\t\tif (!room.parentElem) {\n\t\t\treturn <PSPanelWrapper room={room}>\n\t\t\t\t<p>Error: You tried to open a team selector, but you have nothing to select a team for.</p>\n\t\t\t</PSPanelWrapper>;\n\t\t}\n\t\tconst baseFormat = room.parentElem.getAttribute('data-format') || Dex.modid;\n\t\tlet isFirstLoad = this.format === null;\n\t\tif (isFirstLoad) {\n\t\t\tthis.format = baseFormat;\n\t\t}\n\t\tlet teams = this.getTeams();\n\t\tif (!teams.length && this.format && isFirstLoad) {\n\t\t\tthis.gen = this.format.slice(0, 4);\n\t\t\tthis.format = '';\n\t\t\tteams = this.getTeams();\n\t\t}\n\t\tif (!teams.length && this.gen && isFirstLoad) {\n\t\t\tthis.gen = '';\n\t\t\tteams = this.getTeams();\n\t\t}\n\n\t\tlet availableWidth = document.body.offsetWidth;\n\t\tlet width = 307;\n\t\tif (availableWidth > 636) width = 613;\n\t\tif (availableWidth > 945) width = 919;\n\n\t\tlet teamBuckets: {[folder: string]: Team[]} = {};\n\t\tfor (const team of teams) {\n\t\t\tconst list = teamBuckets[team.folder] || (teamBuckets[team.folder] = []);\n\t\t\tlist.push(team);\n\t\t}\n\n\t\tlet teamList = [];\n\n\t\tconst baseGen = baseFormat.slice(0, 4);\n\t\tlet genList: string[] = [];\n\t\tfor (const team of PS.teams.list) {\n\t\t\tconst gen = team.format.slice(0, 4);\n\t\t\tif (gen && !genList.includes(gen)) genList.push(gen);\n\t\t}\n\t\tconst hasOtherGens = genList.length > 1 || genList[0] !== baseGen;\n\n\t\tteamList.push(<p>\n\t\t\t{baseFormat.length > 4 && <button class={'button' + (baseFormat === this.format ? ' disabled' : '')} onClick={this.setFormat} name=\"format\" value={baseFormat}>\n\t\t\t\t<i class=\"fa fa-folder-o\"></i> [{baseFormat.slice(0, 4)}] {baseFormat.slice(4)}\n\t\t\t</button>} <button class={'button' + (baseGen === this.format ? ' disabled' : '')} onClick={this.setFormat} name=\"format\" value={baseGen}>\n\t\t\t\t<i class=\"fa fa-folder-o\"></i> [{baseGen}] <em>(uncategorized)</em>\n\t\t\t</button> <button class={'button' + (baseGen === this.gen ? ' disabled' : '')} onClick={this.setFormat} name=\"gen\" value={baseGen}>\n\t\t\t\t<i class=\"fa fa-folder-o\"></i> [{baseGen}] <em>(all)</em>\n\t\t\t</button> {hasOtherGens && !this.gen && <button class=\"button\" onClick={this.setFormat} name=\"gen\" value={baseGen}>Other gens</button>}\n\t\t</p>);\n\n\t\tif (hasOtherGens && this.gen) {\n\t\t\tteamList.push(<h2>Other gens</h2>);\n\t\t\tteamList.push(<p>{genList.sort().map(gen => [\n\t\t\t\t<button class={'button' + (gen === this.gen ? ' disabled' : '')} onClick={this.setFormat} name=\"gen\" value={gen}>\n\t\t\t\t\t<i class=\"fa fa-folder-o\"></i> [{gen}] <em>(all)</em>\n\t\t\t\t</button>,\n\t\t\t\t\" \",\n\t\t\t])}</p>);\n\t\t}\n\n\t\tlet isEmpty = true;\n\t\tfor (let folder in teamBuckets) {\n\t\t\tif (folder && (this.gen || this.format)) {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open\"></i> {folder} + {}\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\"></i> {this.format || this.gen}\n\t\t\t\t</h2>);\n\t\t\t} else if (folder) {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open\"></i> {folder}\n\t\t\t\t</h2>);\n\t\t\t} else if (this.gen || this.format) {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\"></i> {this.format || this.gen}\n\t\t\t\t</h2>);\n\t\t\t} else {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\"></i> Teams not in any folders\n\t\t\t\t</h2>);\n\t\t\t}\n\t\t\tteamList.push(<ul class=\"teamdropdown\" onClick={this.click}>\n\t\t\t\t{teamBuckets[folder].map(team => <li key={team.key} style={\"display:inline-block\"}>\n\t\t\t\t\t<TeamBox team={team} button />\n\t\t\t\t</li>)}\n\t\t\t</ul>);\n\t\t\tisEmpty = false;\n\t\t}\n\n\t\treturn <PSPanelWrapper room={room} width={width}>\n\t\t\t{teamList}\n\t\t\t{isEmpty && <p><em>No teams found</em></p>}\n\t\t</PSPanelWrapper>;\n\t}\n}\n\ninterface FormatData {\n\tid: ID;\n\tname: string;\n\tteam?: 'preset' | null;\n\tsection: string;\n\tcolumn: number;\n\tsearchShow?: boolean;\n\tchallengeShow?: boolean;\n\ttournamentShow?: boolean;\n\trated: boolean;\n\tteambuilderLevel?: number | null;\n\tteambuilderFormat?: ID;\n\tbattleFormat?: string;\n\tisTeambuilderFormat: boolean;\n\teffectType: 'Format';\n}\n\ndeclare var BattleFormats: {[id: string]: FormatData};\n/** id:name */\ndeclare var NonBattleGames: {[id: string]: string};\n\nclass FormatDropdownPanel extends PSRoomPanel {\n\tgen = '';\n\tformat: string | null = null;\n\tclick = (e: MouseEvent) => {\n\t\tlet curTarget = e.target as HTMLElement | null;\n\t\tlet target;\n\t\twhile (curTarget && curTarget !== e.currentTarget) {\n\t\t\tif (curTarget.tagName === 'BUTTON') {\n\t\t\t\ttarget = curTarget as HTMLButtonElement;\n\t\t\t}\n\t\t\tcurTarget = curTarget.parentElement;\n\t\t}\n\t\tif (!target) return;\n\n\t\tthis.chooseParentValue(target.value);\n\t};\n\trender() {\n\t\tconst room = this.props.room;\n\t\tif (!room.parentElem) {\n\t\t\treturn <PSPanelWrapper room={room}>\n\t\t\t\t<p>Error: You tried to open a format selector, but you have nothing to select a format for.</p>\n\t\t\t</PSPanelWrapper>;\n\t\t}\n\n\t\tlet formatsLoaded = !!window.BattleFormats;\n\t\tif (formatsLoaded) {\n\t\t\tformatsLoaded = false;\n\t\t\tfor (let i in window.BattleFormats) {\n\t\t\t\tformatsLoaded = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!formatsLoaded) {\n\t\t\treturn <PSPanelWrapper room={room}>\n\t\t\t\t<p>Loading...</p>\n\t\t\t</PSPanelWrapper>;\n\t\t}\n\n\t\t/**\n\t\t * 'challenge' hides search-only formats, and 'search' hides challenge-only\n\t\t * formats. 'teambuilder' shows teambuilder formats (removing parentheses\n\t\t * from format names).\n\t\t */\n\t\tconst selectType: 'teambuilder' | 'challenge' | 'search' = (\n\t\t\troom.parentElem.getAttribute('data-selecttype') as any || 'challenge'\n\t\t);\n\n\t\tconst formats = Object.values(BattleFormats).filter(format => {\n\t\t\tif (selectType === 'challenge' && format.challengeShow === false) return false;\n\t\t\tif (selectType === 'search' && format.searchShow === false) return false;\n\t\t\treturn true;\n\t\t});\n\n\t\tlet curSection = '';\n\t\tlet curColumnNum = 0;\n\t\tlet curColumn: (FormatData | {id: null, section: string})[] = [];\n\t\tconst columns = [curColumn];\n\t\tfor (const format of formats) {\n\t\t\tif (format.column !== curColumnNum) {\n\t\t\t\tif (curColumn.length) {\n\t\t\t\t\tcurColumn = [];\n\t\t\t\t\tcolumns.push(curColumn);\n\t\t\t\t}\n\t\t\t\tcurColumnNum = format.column;\n\t\t\t}\n\t\t\tif (format.section !== curSection) {\n\t\t\t\tcurSection = format.section;\n\t\t\t\tif (curSection) {\n\t\t\t\t\tcurColumn.push({id: null, section: curSection});\n\t\t\t\t}\n\t\t\t}\n\t\t\tcurColumn.push(format);\n\t\t}\n\n\t\tconst width = columns.length * 225 + 10;\n\n\t\treturn <PSPanelWrapper room={room} width={width}>\n\t\t\t{columns.map(column => <ul class=\"options\" onClick={this.click}>\n\t\t\t\t{column.map(format => format.id ? (\n\t\t\t\t\t<li><button value={format.name} class=\"option\">\n\t\t\t\t\t\t{format.name.replace('[Gen 8 ', '[').replace('[Gen 9] ', '').replace('[Gen 7 ', '[')}\n\t\t\t\t\t</button></li>\n\t\t\t\t) : (\n\t\t\t\t\t<li><h3>\n\t\t\t\t\t\t{format.section}\n\t\t\t\t\t</h3></li>\n\t\t\t\t))}\n\t\t\t</ul>)}\n\t\t\t<div style=\"float: left\"></div>\n\t\t</PSPanelWrapper>;\n\t}\n}\n\nPS.roomTypes['teamdropdown'] = {\n\tComponent: TeamDropdownPanel,\n};\n\nPS.roomTypes['formatdropdown'] = {\n\tComponent: FormatDropdownPanel,\n};\n"],"mappings":"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"}