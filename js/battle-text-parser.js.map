{"version":3,"file":"battle-text-parser.js","names":["BattleTextParser","perspective","p1","p2","p3","p4","gen","turn","curLineSection","lowercaseRegExp","undefined","pokemonName","pokemon","startsWith","charAt","slice","trim","parseLine","line","noDefault","index","indexOf","cmd","index2a","index2b","index3b","split","parseBattleLine","args","kwArgs","length","lastArg","bracketPos","pop","upgradeArgs","parseNameParts","text","group","test","name","atIndex","status","away","item","move","number","ability","effect","arg3","arg4","target","of","id","effectId","block","from","includes","ability2","extractMessage","buf","out","parseArgs","fixLowercase","input","prefixes","map","templateId","template","BattleText","toUpperCase","bracketIndex","filter","prefix","escapeRegExp","join","RegExp","replace","match","side","isNear","allyID","pokemonFull","details","nickname","species","trainer","sideid","team","isFar","opposingTeam","own","party","opposingParty","toID","type","namespaces","namespace","maybeAbility","holder","abilityActivation","stat","entry","statName","lineSection","sectionBreak","prevSection","curSection","noSectionBreak","parseArgsInner","num","parseInt","Number","fullname","arg2","newSpecies","newSpeciesId","templateName","msg","line1","isNaN","zeffect","message","already","fatigue","damage","upkeep","oldAbility","fail","hasTarget","eat","weaken","thaw","weather","fromitem","percentage","partiallytrapped","wisher","amount","multiple","source","spread","attacker","blocker","heavy","weak","forme","ohko","template2","require","global"],"sources":["../src/battle-text-parser.ts"],"sourcesContent":["/**\n * Text parser\n *\n * No dependencies\n * Optional dependency: BattleText\n *\n * @author Guangcong Luo <guangcongluo@gmail.com>\n * @license MIT\n */\n\ndeclare const BattleText: {[id: string]: {[templateName: string]: string}};\n\ntype Args = [string, ...string[]];\ntype KWArgs = {[kw: string]: string};\ntype SideID = 'p1' | 'p2' | 'p3' | 'p4';\n\nclass BattleTextParser {\n\tp1 = \"Player 1\";\n\tp2 = \"Player 2\";\n\tp3 = \"Player 3\";\n\tp4 = \"Player 4\";\n\tperspective: SideID;\n\tgen = 9;\n\tturn = 0;\n\tcurLineSection: 'break' | 'preMajor' | 'major' | 'postMajor' = 'break';\n\tlowercaseRegExp: RegExp | null | undefined = undefined;\n\n\tconstructor(perspective: SideID = 'p1') {\n\t\tthis.perspective = perspective;\n\t}\n\n\tstatic parseLine(line: string, noDefault: true): Args | null;\n\tstatic parseLine(line: string): Args;\n\tstatic parseLine(line: string, noDefault?: boolean): Args | null {\n\t\tif (!line.startsWith('|')) {\n\t\t\treturn ['', line];\n\t\t}\n\t\tif (line === '|') {\n\t\t\treturn ['done'];\n\t\t}\n\t\tconst index = line.indexOf('|', 1);\n\t\tconst cmd = line.slice(1, index);\n\t\tswitch (cmd) {\n\t\tcase 'chatmsg': case 'chatmsg-raw': case 'raw': case 'error': case 'html':\n\t\tcase 'inactive': case 'inactiveoff': case 'warning':\n\t\tcase 'fieldhtml': case 'controlshtml': case 'bigerror':\n\t\tcase 'debug': case 'tier': case 'challstr': case 'popup': case '':\n\t\t\treturn [cmd, line.slice(index + 1)];\n\t\tcase 'c': case 'chat': case 'uhtml': case 'uhtmlchange': case 'queryresponse':\n\t\t\t// three parts\n\t\t\tconst index2a = line.indexOf('|', index + 1);\n\t\t\treturn [cmd, line.slice(index + 1, index2a), line.slice(index2a + 1)];\n\t\tcase 'c:': case 'pm':\n\t\t\t// four parts\n\t\t\tconst index2b = line.indexOf('|', index + 1);\n\t\t\tconst index3b = line.indexOf('|', index2b + 1);\n\t\t\treturn [cmd, line.slice(index + 1, index2b), line.slice(index2b + 1, index3b), line.slice(index3b + 1)];\n\t\t}\n\t\tif (noDefault) return null;\n\t\treturn line.slice(1).split('|') as [string, ...string[]];\n\t}\n\n\tstatic parseBattleLine(line: string): {args: Args, kwArgs: KWArgs} {\n\t\tlet args = this.parseLine(line, true);\n\t\tif (args) return {args, kwArgs: {}};\n\n\t\targs = line.slice(1).split('|') as [string, ...string[]];\n\t\tconst kwArgs: KWArgs = {};\n\t\twhile (args.length > 1) {\n\t\t\tconst lastArg = args[args.length - 1];\n\t\t\tif (lastArg.charAt(0) !== '[') break;\n\t\t\tconst bracketPos = lastArg.indexOf(']');\n\t\t\tif (bracketPos <= 0) break;\n\t\t\t// default to '.' so it evaluates to boolean true\n\t\t\tkwArgs[lastArg.slice(1, bracketPos)] = lastArg.slice(bracketPos + 1).trim() || '.';\n\t\t\targs.pop();\n\t\t}\n\t\treturn BattleTextParser.upgradeArgs({args, kwArgs});\n\t}\n\n\tstatic parseNameParts(text: string) {\n\t\tlet group = '';\n\t\t// names can't start with a symbol\n\t\tif (!/[A-Za-z0-9]/.test(text.charAt(0))) {\n\t\t\tgroup = text.charAt(0);\n\t\t\ttext = text.slice(1);\n\t\t}\n\n\t\tlet name = text;\n\t\tconst atIndex = text.indexOf('@');\n\t\tlet status = '';\n\t\tlet away = false;\n\t\tif (atIndex > 0) {\n\t\t\tname = text.slice(0, atIndex);\n\t\t\tstatus = text.slice(atIndex + 1);\n\t\t\tif (status.startsWith('!')) {\n\t\t\t\taway = true;\n\t\t\t\tstatus = status.slice(1);\n\t\t\t}\n\t\t}\n\t\treturn {group, name, away, status};\n\t}\n\n\tstatic upgradeArgs({args, kwArgs}: {args: Args, kwArgs: KWArgs}): {args: Args, kwArgs: KWArgs} {\n\t\tswitch (args[0]) {\n\t\tcase '-activate': {\n\t\t\tif (kwArgs.item || kwArgs.move || kwArgs.number || kwArgs.ability) return {args, kwArgs};\n\t\t\tlet [, pokemon, effect, arg3, arg4] = args;\n\t\t\tlet target = kwArgs.of;\n\t\t\tconst id = BattleTextParser.effectId(effect);\n\n\t\t\tif (kwArgs.block) return {args: ['-fail', pokemon], kwArgs};\n\n\t\t\tif (id === 'wonderguard') return {args: ['-immune', pokemon], kwArgs: {from: 'ability:Wonder Guard'}};\n\n\t\t\tif (id === 'beatup' && kwArgs.of) return {args, kwArgs: {name: kwArgs.of}};\n\n\t\t\tif ([\n\t\t\t\t'ingrain', 'quickguard', 'wideguard', 'craftyshield', 'matblock', 'protect', 'mist', 'safeguard',\n\t\t\t\t'electricterrain', 'mistyterrain', 'psychicterrain', 'telepathy', 'stickyhold', 'suctioncups', 'aromaveil',\n\t\t\t\t'flowerveil', 'sweetveil', 'disguise', 'safetygoggles', 'protectivepads',\n\t\t\t].includes(id)) {\n\t\t\t\tif (target) {\n\t\t\t\t\tkwArgs.of = pokemon;\n\t\t\t\t\treturn {args: ['-block', target, effect, arg3], kwArgs};\n\t\t\t\t}\n\t\t\t\treturn {args: ['-block', pokemon, effect, arg3], kwArgs};\n\t\t\t}\n\n\t\t\tif (id === 'charge') {\n\t\t\t\treturn {args: ['-singlemove', pokemon, effect], kwArgs: {of: target}};\n\t\t\t}\n\t\t\tif ([\n\t\t\t\t'bind', 'wrap', 'clamp', 'whirlpool', 'firespin', 'magmastorm', 'sandtomb', 'infestation', 'snaptrap', 'thundercage', 'trapped',\n\t\t\t].includes(id)) {\n\t\t\t\treturn {args: ['-start', pokemon, effect], kwArgs: {of: target}};\n\t\t\t}\n\n\t\t\tif (id === 'fairylock') {\n\t\t\t\treturn {args: ['-fieldactivate', effect], kwArgs: {}};\n\t\t\t}\n\n\t\t\tif (id === 'symbiosis' || id === 'poltergeist') {\n\t\t\t\tkwArgs.item = arg3;\n\t\t\t} else if (id === 'magnitude') {\n\t\t\t\tkwArgs.number = arg3;\n\t\t\t} else if (id === 'skillswap' || id === 'mummy' || id === 'wanderingspirit') {\n\t\t\t\tkwArgs.ability = arg3;\n\t\t\t\tkwArgs.ability2 = arg4;\n\t\t\t} else if ([\n\t\t\t\t'eeriespell', 'gmaxdepletion', 'spite', 'grudge', 'forewarn', 'sketch', 'leppaberry', 'mysteryberry',\n\t\t\t].includes(id)) {\n\t\t\t\tkwArgs.move = arg3;\n\t\t\t\tkwArgs.number = arg4;\n\t\t\t}\n\t\t\targs = ['-activate', pokemon, effect, target || ''];\n\t\t\tbreak;\n\t\t}\n\n\t\tcase '-fail': {\n\t\t\tif (kwArgs.from === 'ability: Flower Veil') {\n\t\t\t\treturn {args: ['-block', kwArgs.of, 'ability: Flower Veil'], kwArgs: {of: args[1]}};\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tcase '-start': {\n\t\t\tif (kwArgs.from === 'Protean' || kwArgs.from === 'Color Change') kwArgs.from = 'ability:' + kwArgs.from;\n\t\t\tbreak;\n\t\t}\n\n\t\tcase 'move': {\n\t\t\tif (kwArgs.from === 'Magic Bounce') kwArgs.from = 'ability:Magic Bounce';\n\t\t\tbreak;\n\t\t}\n\n\t\tcase 'cant': {\n\t\t\tlet [, pokemon, effect, move] = args;\n\t\t\tif (['ability: Damp', 'ability: Dazzling', 'ability: Queenly Majesty', 'ability: Armor Tail'].includes(effect)) {\n\t\t\t\targs[0] = '-block';\n\t\t\t\treturn {args: ['-block', pokemon, effect, move, kwArgs.of], kwArgs: {}};\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tcase '-nothing':\n\t\t\t// OLD: |-nothing\n\t\t\t// NEW: |-activate||move:Splash\n\t\t\treturn {args: ['-activate', '', 'move:Splash'], kwArgs};\n\t\t}\n\t\treturn {args, kwArgs};\n\t}\n\n\textractMessage(buf: string) {\n\t\tlet out = '';\n\t\tfor (const line of buf.split('\\n')) {\n\t\t\tconst {args, kwArgs} = BattleTextParser.parseBattleLine(line);\n\t\t\tout += this.parseArgs(args, kwArgs) || '';\n\t\t}\n\t\treturn out;\n\t}\n\n\tfixLowercase(input: string) {\n\t\tif (this.lowercaseRegExp === undefined) {\n\t\t\tconst prefixes = ['pokemon', 'opposingPokemon', 'team', 'opposingTeam', 'party', 'opposingParty'].map(templateId => {\n\t\t\t\tconst template = BattleText.default[templateId];\n\t\t\t\tif (template.charAt(0) === template.charAt(0).toUpperCase()) return '';\n\t\t\t\tconst bracketIndex = template.indexOf('[');\n\t\t\t\tif (bracketIndex >= 0) return template.slice(0, bracketIndex);\n\t\t\t\treturn template;\n\t\t\t}).filter(prefix => prefix);\n\t\t\tif (prefixes.length) {\n\t\t\t\tlet buf = `((?:^|\\n)(?:  |  \\\\\\(|\\\\\\[)?)(` +\n\t\t\t\t\tprefixes.map(BattleTextParser.escapeRegExp).join('|') +\n\t\t\t\t\t`)`;\n\t\t\t\tthis.lowercaseRegExp = new RegExp(buf, 'g');\n\t\t\t} else {\n\t\t\t\tthis.lowercaseRegExp = null;\n\t\t\t}\n\t\t}\n\t\tif (!this.lowercaseRegExp) return input;\n\t\treturn input.replace(this.lowercaseRegExp, (match, p1, p2) => (\n\t\t\tp1 + p2.charAt(0).toUpperCase() + p2.slice(1)\n\t\t));\n\t}\n\n\tstatic escapeRegExp(input: string) {\n\t\treturn input.replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&');\n\t}\n\n\tpokemonName = (pokemon: string) => {\n\t\tif (!pokemon) return '';\n\t\tif (!pokemon.startsWith('p')) return `???pokemon:${pokemon}???`;\n\t\tif (pokemon.charAt(3) === ':') return pokemon.slice(4).trim();\n\t\telse if (pokemon.charAt(2) === ':') return pokemon.slice(3).trim();\n\t\treturn `???pokemon:${pokemon}???`;\n\t};\n\n\tpokemon(pokemon: string) {\n\t\tif (!pokemon) return '';\n\t\tlet side = pokemon.slice(0, 2);\n\t\tif (!['p1', 'p2', 'p3', 'p4'].includes(side)) return `???pokemon:${pokemon}???`;\n\t\tconst name = this.pokemonName(pokemon);\n\t\tconst isNear = side === this.perspective || side === BattleTextParser.allyID(side as SideID);\n\t\tconst template = BattleText.default[isNear ? 'pokemon' : 'opposingPokemon'];\n\t\treturn template.replace('[NICKNAME]', name);\n\t}\n\n\tpokemonFull(pokemon: string, details: string): [string, string] {\n\t\tconst nickname = this.pokemonName(pokemon);\n\n\t\tconst species = details.split(',')[0];\n\t\tif (nickname === species) return [pokemon.slice(0, 2), `**${species}**`];\n\t\treturn [pokemon.slice(0, 2), `${nickname} (**${species}**)`];\n\t}\n\n\ttrainer(side: string) {\n\t\tside = side.slice(0, 2);\n\t\tif (side === 'p1') return this.p1;\n\t\tif (side === 'p2') return this.p2;\n\t\tif (side === 'p3') return this.p3;\n\t\tif (side === 'p4') return this.p4;\n\t\treturn `???side:${side}???`;\n\t}\n\n\tstatic allyID(sideid: SideID): SideID | '' {\n\t\tif (sideid === 'p1') return 'p3';\n\t\tif (sideid === 'p2') return 'p4';\n\t\tif (sideid === 'p3') return 'p1';\n\t\tif (sideid === 'p4') return 'p2';\n\t\treturn '';\n\t}\n\n\tteam(side: string, isFar: boolean = false) {\n\t\tside = side.slice(0, 2);\n\t\tif (side === this.perspective || side === BattleTextParser.allyID(side as SideID)) {\n\t\t\treturn !isFar ? BattleText.default.team : BattleText.default.opposingTeam;\n\t\t}\n\t\treturn isFar ? BattleText.default.team : BattleText.default.opposingTeam;\n\t}\n\n\town(side: string) {\n\t\tside = side.slice(0, 2);\n\t\tif (side === this.perspective) {\n\t\t\treturn 'OWN';\n\t\t}\n\t\treturn '';\n\t}\n\n\tparty(side: string) {\n\t\tside = side.slice(0, 2);\n\t\tif (side === this.perspective || side === BattleTextParser.allyID(side as SideID)) {\n\t\t\treturn BattleText.default.party;\n\t\t}\n\t\treturn BattleText.default.opposingParty;\n\t}\n\n\tstatic effectId(effect?: string) {\n\t\tif (!effect) return '';\n\t\tif (effect.startsWith('item:') || effect.startsWith('move:')) {\n\t\t\teffect = effect.slice(5);\n\t\t} else if (effect.startsWith('ability:')) {\n\t\t\teffect = effect.slice(8);\n\t\t}\n\t\treturn toID(effect);\n\t}\n\n\teffect(effect?: string) {\n\t\tif (!effect) return '';\n\t\tif (effect.startsWith('item:') || effect.startsWith('move:')) {\n\t\t\teffect = effect.slice(5);\n\t\t} else if (effect.startsWith('ability:')) {\n\t\t\teffect = effect.slice(8);\n\t\t}\n\t\treturn effect.trim();\n\t}\n\n\ttemplate(type: string, ...namespaces: (string | undefined)[]) {\n\t\tfor (const namespace of namespaces) {\n\t\t\tif (!namespace) continue;\n\t\t\tif (namespace === 'OWN') {\n\t\t\t\treturn BattleText.default[type + 'Own'] + '\\n';\n\t\t\t}\n\t\t\tif (namespace === 'NODEFAULT') {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tlet id = BattleTextParser.effectId(namespace);\n\t\t\tif (BattleText[id] && type in BattleText[id]) {\n\t\t\t\tif (BattleText[id][type].charAt(1) === '.') type = BattleText[id][type].slice(2) as ID;\n\t\t\t\tif (BattleText[id][type].charAt(0) === '#') id = BattleText[id][type].slice(1) as ID;\n\t\t\t\tif (!BattleText[id][type]) return '';\n\t\t\t\treturn BattleText[id][type] + '\\n';\n\t\t\t}\n\t\t}\n\t\tif (!BattleText.default[type]) return '';\n\t\treturn BattleText.default[type] + '\\n';\n\t}\n\n\tmaybeAbility(effect: string | undefined, holder: string) {\n\t\tif (!effect) return '';\n\t\tif (!effect.startsWith('ability:')) return '';\n\t\treturn this.ability(effect.slice(8).trim(), holder);\n\t}\n\n\tability(name: string | undefined, holder: string) {\n\t\tif (!name) return '';\n\t\treturn BattleText.default.abilityActivation.replace('[POKEMON]', this.pokemon(holder)).replace('[ABILITY]', this.effect(name)) + '\\n';\n\t}\n\n\tstatic stat(stat: string) {\n\t\tconst entry = BattleText[stat || \"stats\"];\n\t\tif (!entry || !entry.statName) return `???stat:${stat}???`;\n\t\treturn entry.statName;\n\t}\n\n\tlineSection(args: Args, kwArgs: KWArgs) {\n\t\tconst cmd = args[0];\n\t\tswitch (cmd) {\n\t\tcase 'done' : case 'turn':\n\t\t\treturn 'break';\n\t\tcase 'move' : case 'cant': case 'switch': case 'drag': case 'upkeep': case 'start':\n\t\tcase '-mega': case '-candynamax': case '-terastallize':\n\t\t\treturn 'major';\n\t\tcase 'switchout': case 'faint':\n\t\t\treturn 'preMajor';\n\t\tcase '-zpower':\n\t\t\treturn 'postMajor';\n\t\tcase '-damage': {\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\n\t\t\tif (id === 'confusion') return 'major';\n\t\t\treturn 'postMajor';\n\t\t}\n\t\tcase '-curestatus': {\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\n\t\t\tif (id === 'naturalcure') return 'preMajor';\n\t\t\treturn 'postMajor';\n\t\t}\n\t\tcase '-start': {\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\n\t\t\tif (id === 'protean') return 'preMajor';\n\t\t\treturn 'postMajor';\n\t\t}\n\t\tcase '-activate': {\n\t\t\tconst id = BattleTextParser.effectId(args[2]);\n\t\t\tif (id === 'confusion' || id === 'attract') return 'preMajor';\n\t\t\treturn 'postMajor';\n\t\t}\n\t\t}\n\t\treturn (cmd.charAt(0) === '-' ? 'postMajor' : '');\n\t}\n\n\tsectionBreak(args: Args, kwArgs: KWArgs) {\n\t\tconst prevSection = this.curLineSection;\n\t\tconst curSection = this.lineSection(args, kwArgs);\n\t\tif (!curSection) return false;\n\t\tthis.curLineSection = curSection;\n\t\tswitch (curSection) {\n\t\tcase 'break':\n\t\t\tif (prevSection !== 'break') return true;\n\t\t\treturn false;\n\t\tcase 'preMajor':\n\t\tcase 'major':\n\t\t\tif (prevSection === 'postMajor' || prevSection === 'major') return true;\n\t\t\treturn false;\n\t\tcase 'postMajor':\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tparseArgs(args: Args, kwArgs: KWArgs, noSectionBreak?: boolean) {\n\t\tlet buf = !noSectionBreak && this.sectionBreak(args, kwArgs) ? '\\n' : '';\n\t\treturn buf + this.fixLowercase(this.parseArgsInner(args, kwArgs) || '');\n\t}\n\n\tparseArgsInner(args: Args, kwArgs: KWArgs) {\n\t\tlet cmd = args[0];\n\t\tswitch (cmd) {\n\t\tcase 'player': {\n\t\t\tconst [, side, name] = args;\n\t\t\tif (side === 'p1' && name) {\n\t\t\t\tthis.p1 = name;\n\t\t\t} else if (side === 'p2' && name) {\n\t\t\t\tthis.p2 = name;\n\t\t\t} else if (side === 'p3' && name) {\n\t\t\t\tthis.p3 = name;\n\t\t\t} else if (side === 'p4' && name) {\n\t\t\t\tthis.p4 = name;\n\t\t\t}\n\t\t\treturn '';\n\t\t}\n\n\t\tcase 'gen': {\n\t\t\tconst [, num] = args;\n\t\t\tthis.gen = parseInt(num, 10);\n\t\t\treturn '';\n\t\t}\n\n\t\tcase 'turn': {\n\t\t\tconst [, num] = args;\n\t\t\tthis.turn = Number.parseInt(num, 10);\n\t\t\treturn this.template('turn').replace('[NUMBER]', num) + '\\n';\n\t\t}\n\n\t\tcase 'start': {\n\t\t\treturn this.template('startBattle').replace('[TRAINER]', this.p1).replace('[TRAINER]', this.p2);\n\t\t}\n\n\t\tcase 'win': case 'tie': {\n\t\t\tconst [, name] = args;\n\t\t\tif (cmd === 'tie' || !name) {\n\t\t\t\treturn this.template('tieBattle').replace('[TRAINER]', this.p1).replace('[TRAINER]', this.p2);\n\t\t\t}\n\t\t\treturn this.template('winBattle').replace('[TRAINER]', name);\n\t\t}\n\n\t\tcase 'switch': {\n\t\t\tconst [, pokemon, details] = args;\n\t\t\tconst [side, fullname] = this.pokemonFull(pokemon, details);\n\t\t\tconst template = this.template('switchIn', this.own(side));\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side)).replace('[FULLNAME]', fullname);\n\t\t}\n\n\t\tcase 'drag': {\n\t\t\tconst [, pokemon, details] = args;\n\t\t\tconst [side, fullname] = this.pokemonFull(pokemon, details);\n\t\t\tconst template = this.template('drag');\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side)).replace('[FULLNAME]', fullname);\n\t\t}\n\n\t\tcase 'detailschange': case '-transform': case '-formechange': {\n\t\t\tconst [, pokemon, arg2, arg3] = args;\n\t\t\tlet newSpecies = '';\n\t\t\tswitch (cmd) {\n\t\t\tcase 'detailschange': newSpecies = arg2.split(',')[0].trim(); break;\n\t\t\tcase '-transform': newSpecies = arg3; break;\n\t\t\tcase '-formechange': newSpecies = arg2; break;\n\t\t\t}\n\t\t\tlet newSpeciesId = toID(newSpecies);\n\t\t\tlet id = '';\n\t\t\tlet templateName = 'transform';\n\t\t\tif (cmd !== '-transform') {\n\t\t\t\tswitch (newSpeciesId) {\n\t\t\t\tcase 'greninjaash': id = 'battlebond'; break;\n\t\t\t\tcase 'mimikyubusted': id = 'disguise'; break;\n\t\t\t\tcase 'zygardecomplete': id = 'powerconstruct'; break;\n\t\t\t\tcase 'necrozmaultra': id = 'ultranecroziumz'; break;\n\t\t\t\tcase 'darmanitanzen': id = 'zenmode'; break;\n\t\t\t\tcase 'darmanitan': id = 'zenmode'; templateName = 'transformEnd'; break;\n\t\t\t\tcase 'darmanitangalarzen': id = 'zenmode'; break;\n\t\t\t\tcase 'darmanitangalar': id = 'zenmode'; templateName = 'transformEnd'; break;\n\t\t\t\tcase 'aegislashblade': id = 'stancechange'; break;\n\t\t\t\tcase 'aegislash': id = 'stancechange'; templateName = 'transformEnd'; break;\n\t\t\t\tcase 'wishiwashischool': id = 'schooling'; break;\n\t\t\t\tcase 'wishiwashi': id = 'schooling'; templateName = 'transformEnd'; break;\n\t\t\t\tcase 'miniormeteor': id = 'shieldsdown'; break;\n\t\t\t\tcase 'minior': id = 'shieldsdown'; templateName = 'transformEnd'; break;\n\t\t\t\tcase 'eiscuenoice': id = 'iceface'; break;\n\t\t\t\tcase 'eiscue': id = 'iceface'; templateName = 'transformEnd'; break;\n\t\t\t\t}\n\t\t\t} else if (newSpecies) {\n\t\t\t\tid = 'transform';\n\t\t\t}\n\t\t\tconst template = this.template(templateName, id, kwArgs.msg ? '' : 'NODEFAULT');\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SPECIES]', newSpecies);\n\t\t}\n\n\t\tcase 'switchout': {\n\t\t\tconst [, pokemon] = args;\n\t\t\tconst side = pokemon.slice(0, 2);\n\t\t\tconst template = this.template('switchOut', kwArgs.from, this.own(side));\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side)).replace('[NICKNAME]', this.pokemonName(pokemon)).replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase 'faint': {\n\t\t\tconst [, pokemon] = args;\n\t\t\tconst template = this.template('faint');\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase 'swap': {\n\t\t\tconst [, pokemon, target] = args;\n\t\t\tif (!target || !isNaN(Number(target))) {\n\t\t\t\tconst template = this.template('swapCenter');\n\t\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t\t}\n\t\t\tconst template = this.template('swap');\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\n\t\t}\n\n\t\tcase 'move': {\n\t\t\tconst [, pokemon, move] = args;\n\t\t\tlet line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tif (kwArgs.zeffect) {\n\t\t\t\tline1 = this.template('zEffect').replace('[POKEMON]', this.pokemon(pokemon));\n\t\t\t}\n\t\t\tconst template = this.template('move', kwArgs.from);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', move);\n\t\t}\n\n\t\tcase 'cant': {\n\t\t\tlet [, pokemon, effect, move] = args;\n\t\t\tconst template = this.template('cant', effect, 'NODEFAULT') ||\n\t\t\t\tthis.template(move ? 'cant' : 'cantNoMove');\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', move);\n\t\t}\n\n\t\tcase '-candynamax': {\n\t\t\tlet [, side] = args;\n\t\t\tconst own = this.own(side);\n\t\t\tlet template = '';\n\t\t\tif (this.turn === 1) {\n\t\t\t\tif (own) template = this.template('canDynamax', own);\n\t\t\t} else {\n\t\t\t\ttemplate = this.template('canDynamax', own);\n\t\t\t}\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side));\n\t\t}\n\n\t\tcase 'message': {\n\t\t\tlet [, message] = args;\n\t\t\treturn '' + message + '\\n';\n\t\t}\n\n\t\tcase '-start': {\n\t\t\tlet [, pokemon, effect, arg3] = args;\n\t\t\tconst line1 = this.maybeAbility(effect, pokemon) || this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tlet id = BattleTextParser.effectId(effect);\n\t\t\tif (id === 'typechange') {\n\t\t\t\tconst template = this.template('typeChange', kwArgs.from);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TYPE]', arg3).replace('[SOURCE]', this.pokemon(kwArgs.of));\n\t\t\t}\n\t\t\tif (id === 'typeadd') {\n\t\t\t\tconst template = this.template('typeAdd', kwArgs.from);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TYPE]', arg3);\n\t\t\t}\n\t\t\tif (id.startsWith('stockpile')) {\n\t\t\t\tconst num = id.slice(9);\n\t\t\t\tconst template = this.template('start', 'stockpile');\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[NUMBER]', num);\n\t\t\t}\n\t\t\tif (id.startsWith('perish')) {\n\t\t\t\tconst num = id.slice(6);\n\t\t\t\tconst template = this.template('activate', 'perishsong');\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[NUMBER]', num);\n\t\t\t}\n\t\t\tif (id.startsWith('protosynthesis') || id.startsWith('quarkdrive')) {\n\t\t\t\tconst stat = id.slice(-3);\n\t\t\t\tconst template = this.template('start', id.slice(0, id.length - 3));\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[STAT]', BattleTextParser.stat(stat));\n\t\t\t}\n\t\t\tlet templateId = 'start';\n\t\t\tif (kwArgs.already) templateId = 'alreadyStarted';\n\t\t\tif (kwArgs.fatigue) templateId = 'startFromFatigue';\n\t\t\tif (kwArgs.zeffect) templateId = 'startFromZEffect';\n\t\t\tif (kwArgs.damage) templateId = 'activate';\n\t\t\tif (kwArgs.block) templateId = 'block';\n\t\t\tif (kwArgs.upkeep) templateId = 'upkeep';\n\t\t\tif (id === 'mist' && this.gen <= 2) templateId = 'startGen' + this.gen;\n\t\t\tif (id === 'reflect' || id === 'lightscreen') templateId = 'startGen1';\n\t\t\tif (templateId === 'start' && kwArgs.from?.startsWith('item:')) {\n\t\t\t\ttemplateId += 'FromItem';\n\t\t\t}\n\t\t\tconst template = this.template(templateId, effect);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[EFFECT]', this.effect(effect)).replace('[MOVE]', arg3).replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(kwArgs.from));\n\t\t}\n\n\t\tcase '-end': {\n\t\t\tlet [, pokemon, effect] = args;\n\t\t\tconst line1 = this.maybeAbility(effect, pokemon) || this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tlet id = BattleTextParser.effectId(effect);\n\t\t\tif (id === 'doomdesire' || id === 'futuresight') {\n\t\t\t\tconst template = this.template('activate', effect);\n\t\t\t\treturn line1 + template.replace('[TARGET]', this.pokemon(pokemon));\n\t\t\t}\n\t\t\tlet templateId = 'end';\n\t\t\tlet template = '';\n\t\t\tif (kwArgs.from?.startsWith('item:')) {\n\t\t\t\ttemplate = this.template('endFromItem', effect);\n\t\t\t}\n\t\t\tif (!template) template = this.template(templateId, effect);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[EFFECT]', this.effect(effect)).replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(kwArgs.from));\n\t\t}\n\n\t\tcase '-ability': {\n\t\t\tlet [, pokemon, ability, oldAbility, arg4] = args;\n\t\t\tlet line1 = '';\n\t\t\tif (oldAbility && (oldAbility.startsWith('p1') || oldAbility.startsWith('p2') || oldAbility === 'boost')) {\n\t\t\t\targ4 = oldAbility;\n\t\t\t\toldAbility = '';\n\t\t\t}\n\t\t\tif (oldAbility) line1 += this.ability(oldAbility, pokemon);\n\t\t\tline1 += this.ability(ability, pokemon);\n\t\t\tif (kwArgs.fail) {\n\t\t\t\tconst template = this.template('block', kwArgs.from);\n\t\t\t\treturn line1 + template;\n\t\t\t}\n\t\t\tif (kwArgs.from) {\n\t\t\t\tline1 = this.maybeAbility(kwArgs.from, pokemon) + line1;\n\t\t\t\tconst template = this.template('changeAbility', kwArgs.from);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ABILITY]', this.effect(ability)).replace('[SOURCE]', this.pokemon(kwArgs.of));\n\t\t\t}\n\t\t\tconst id = BattleTextParser.effectId(ability);\n\t\t\tif (id === 'unnerve') {\n\t\t\t\tconst template = this.template('start', ability);\n\t\t\t\treturn line1 + template.replace('[TEAM]', this.team(pokemon.slice(0, 2), true));\n\t\t\t}\n\t\t\tlet templateId = 'start';\n\t\t\tif (id === 'anticipation' || id === 'sturdy') templateId = 'activate';\n\t\t\tconst template = this.template(templateId, ability, 'NODEFAULT');\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-endability': {\n\t\t\tlet [, pokemon, ability] = args;\n\t\t\tif (ability) return this.ability(ability, pokemon);\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tconst template = this.template('start', 'Gastro Acid');\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-item': {\n\t\t\tconst [, pokemon, item] = args;\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\n\t\t\tlet target = '';\n\t\t\tif (['magician', 'pickpocket'].includes(id)) {\n\t\t\t\t[target, kwArgs.of] = [kwArgs.of, ''];\n\t\t\t}\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tif (['thief', 'covet', 'bestow', 'magician', 'pickpocket'].includes(id)) {\n\t\t\t\tconst template = this.template('takeItem', kwArgs.from);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item)).replace('[SOURCE]', this.pokemon(target || kwArgs.of));\n\t\t\t}\n\t\t\tif (id === 'frisk') {\n\t\t\t\tconst hasTarget = kwArgs.of && pokemon && kwArgs.of !== pokemon;\n\t\t\t\tconst template = this.template(hasTarget ? 'activate' : 'activateNoTarget', \"Frisk\");\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(item)).replace('[TARGET]', this.pokemon(pokemon));\n\t\t\t}\n\t\t\tif (kwArgs.from) {\n\t\t\t\tconst template = this.template('addItem', kwArgs.from);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item));\n\t\t\t}\n\t\t\tconst template = this.template('start', item, 'NODEFAULT');\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-enditem': {\n\t\t\tlet [, pokemon, item] = args;\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tif (kwArgs.eat) {\n\t\t\t\tconst template = this.template('eatItem', kwArgs.from);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item));\n\t\t\t}\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\n\t\t\tif (id === 'gem') {\n\t\t\t\tconst template = this.template('useGem', item);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item)).replace('[MOVE]', kwArgs.move);\n\t\t\t}\n\t\t\tif (id === 'stealeat') {\n\t\t\t\tconst template = this.template('removeItem', \"Bug Bite\");\n\t\t\t\treturn line1 + template.replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(item));\n\t\t\t}\n\t\t\tif (kwArgs.from) {\n\t\t\t\tconst template = this.template('removeItem', kwArgs.from);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item)).replace('[SOURCE]', this.pokemon(kwArgs.of));\n\t\t\t}\n\t\t\tif (kwArgs.weaken) {\n\t\t\t\tconst template = this.template('activateWeaken');\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item));\n\t\t\t}\n\t\t\tlet template = this.template('end', item, 'NODEFAULT');\n\t\t\tif (!template) template = this.template('activateItem').replace('[ITEM]', this.effect(item));\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(kwArgs.of));\n\t\t}\n\n\t\tcase '-status': {\n\t\t\tconst [, pokemon, status] = args;\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tif (BattleTextParser.effectId(kwArgs.from) === 'rest') {\n\t\t\t\tconst template = this.template('startFromRest', status);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t\t}\n\t\t\tconst template = this.template('start', status);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-curestatus': {\n\t\t\tconst [, pokemon, status] = args;\n\t\t\tif (BattleTextParser.effectId(kwArgs.from) === 'naturalcure') {\n\t\t\t\tconst template = this.template('activate', kwArgs.from);\n\t\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t\t}\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tif (kwArgs.from?.startsWith('item:')) {\n\t\t\t\tconst template = this.template('endFromItem', status);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(kwArgs.from));\n\t\t\t}\n\t\t\tif (kwArgs.thaw) {\n\t\t\t\tconst template = this.template('endFromMove', status);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', this.effect(kwArgs.from));\n\t\t\t}\n\t\t\tlet template = this.template('end', status, 'NODEFAULT');\n\t\t\tif (!template) template = this.template('end').replace('[EFFECT]', status);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-cureteam': {\n\t\t\treturn this.template('activate', kwArgs.from);\n\t\t}\n\n\t\tcase '-singleturn': case '-singlemove': {\n\t\t\tconst [, pokemon, effect] = args;\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon) ||\n\t\t\t\tthis.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tlet id = BattleTextParser.effectId(effect);\n\t\t\tif (id === 'instruct') {\n\t\t\t\tconst template = this.template('activate', effect);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of)).replace('[TARGET]', this.pokemon(pokemon));\n\t\t\t}\n\t\t\tlet template = this.template('start', effect, 'NODEFAULT');\n\t\t\tif (!template) template = this.template('start').replace('[EFFECT]', this.effect(effect));\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[TEAM]', this.team(pokemon.slice(0, 2)));\n\t\t}\n\n\t\tcase '-sidestart': {\n\t\t\tlet [, side, effect] = args;\n\t\t\tlet template = this.template('start', effect, 'NODEFAULT');\n\t\t\tif (!template) template = this.template('startTeamEffect').replace('[EFFECT]', this.effect(effect));\n\t\t\treturn template.replace('[TEAM]', this.team(side)).replace('[PARTY]', this.party(side));\n\t\t}\n\n\t\tcase '-sideend': {\n\t\t\tlet [, side, effect] = args;\n\t\t\tlet template = this.template('end', effect, 'NODEFAULT');\n\t\t\tif (!template) template = this.template('endTeamEffect').replace('[EFFECT]', this.effect(effect));\n\t\t\treturn template.replace('[TEAM]', this.team(side)).replace('[PARTY]', this.party(side));\n\t\t}\n\n\t\tcase '-weather': {\n\t\t\tconst [, weather] = args;\n\t\t\tif (!weather || weather === 'none') {\n\t\t\t\tconst template = this.template('end', kwArgs.from, 'NODEFAULT');\n\t\t\t\tif (!template) return this.template('endFieldEffect').replace('[EFFECT]', this.effect(weather));\n\t\t\t\treturn template;\n\t\t\t}\n\t\t\tif (kwArgs.upkeep) {\n\t\t\t\treturn this.template('upkeep', weather, 'NODEFAULT');\n\t\t\t}\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of);\n\t\t\tif (BattleTextParser.effectId(kwArgs.from) === 'orichalcumpulse') {\n\t\t\t\treturn line1 + this.template('start', 'orichalcumpulse').replace('[POKEMON]', this.pokemon(kwArgs.of));\n\t\t\t}\n\t\t\tlet template = this.template('start', weather, 'NODEFAULT');\n\t\t\tif (!template) template = this.template('startFieldEffect').replace('[EFFECT]', this.effect(weather));\n\t\t\treturn line1 + template;\n\t\t}\n\n\t\tcase '-fieldstart': case '-fieldactivate': {\n\t\t\tconst [, effect] = args;\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of);\n\t\t\tif (BattleTextParser.effectId(kwArgs.from) === 'hadronengine') {\n\t\t\t\treturn line1 + this.template('start', 'hadronengine').replace('[POKEMON]', this.pokemon(kwArgs.of));\n\t\t\t}\n\t\t\tlet templateId = cmd.slice(6);\n\t\t\tif (BattleTextParser.effectId(effect) === 'perishsong') templateId = 'start';\n\t\t\tlet template = this.template(templateId, effect, 'NODEFAULT');\n\t\t\tif (!template) template = this.template('startFieldEffect').replace('[EFFECT]', this.effect(effect));\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of));\n\t\t}\n\n\t\tcase '-fieldend': {\n\t\t\tlet [, effect] = args;\n\t\t\tlet template = this.template('end', effect, 'NODEFAULT');\n\t\t\tif (!template) template = this.template('endFieldEffect').replace('[EFFECT]', this.effect(effect));\n\t\t\treturn template;\n\t\t}\n\n\t\tcase '-sethp': {\n\t\t\tlet effect = kwArgs.from;\n\t\t\treturn this.template('activate', effect);\n\t\t}\n\n\t\tcase '-message': {\n\t\t\tlet [, message] = args;\n\t\t\treturn '  ' + message + '\\n';\n\t\t}\n\n\t\tcase '-hint': {\n\t\t\tlet [, message] = args;\n\t\t\treturn '  (' + message + ')\\n';\n\t\t}\n\n\t\tcase '-activate': {\n\t\t\tlet [, pokemon, effect, target] = args;\n\t\t\tlet id = BattleTextParser.effectId(effect);\n\t\t\tif (id === 'celebrate') {\n\t\t\t\treturn this.template('activate', 'celebrate').replace('[TRAINER]', this.trainer(pokemon.slice(0, 2)));\n\t\t\t}\n\t\t\tif (!target &&\n\t\t\t\t['hyperdrill', 'hyperspacefury', 'hyperspacehole', 'phantomforce', 'shadowforce', 'feint'].includes(id)) {\n\t\t\t\t[pokemon, target] = [kwArgs.of, pokemon];\n\t\t\t\tif (!pokemon) pokemon = target;\n\t\t\t}\n\t\t\tif (!target) target = kwArgs.of || pokemon;\n\n\t\t\tlet line1 = this.maybeAbility(effect, pokemon);\n\n\t\t\tif (id === 'lockon' || id === 'mindreader') {\n\t\t\t\tconst template = this.template('start', effect);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of)).replace('[SOURCE]', this.pokemon(pokemon));\n\t\t\t}\n\n\t\t\tif ((id === 'mummy' || id === 'lingeringaroma') && kwArgs.ability) {\n\t\t\t\tline1 += this.ability(kwArgs.ability, target);\n\t\t\t\tline1 += this.ability(id === 'mummy' ? 'Mummy' : 'Lingering Aroma', target);\n\t\t\t\tconst template = this.template('changeAbility', id);\n\t\t\t\treturn line1 + template.replace('[TARGET]', this.pokemon(target));\n\t\t\t}\n\n\t\t\tlet templateId = 'activate';\n\t\t\tif (id === 'forewarn' && pokemon === target) {\n\t\t\t\ttemplateId = 'activateNoTarget';\n\t\t\t}\n\t\t\tif ((id === 'protosynthesis' || id === 'quarkdrive') && kwArgs.fromitem) {\n\t\t\t\ttemplateId = 'activateFromItem';\n\t\t\t}\n\t\t\tlet template = this.template(templateId, effect, 'NODEFAULT');\n\t\t\tif (!template) {\n\t\t\t\tif (line1) return line1; // Abilities don't have a default template\n\t\t\t\ttemplate = this.template('activate');\n\t\t\t\treturn line1 + template.replace('[EFFECT]', this.effect(effect));\n\t\t\t}\n\n\t\t\tif (id === 'brickbreak') {\n\t\t\t\ttemplate = template.replace('[TEAM]', this.team(target.slice(0, 2)));\n\t\t\t}\n\t\t\tif (kwArgs.ability) {\n\t\t\t\tline1 += this.ability(kwArgs.ability, pokemon);\n\t\t\t}\n\t\t\tif (kwArgs.ability2) {\n\t\t\t\tline1 += this.ability(kwArgs.ability2, target);\n\t\t\t}\n\t\t\tif (kwArgs.move || kwArgs.number || kwArgs.item || kwArgs.name) {\n\t\t\t\ttemplate = template.replace('[MOVE]', kwArgs.move).replace('[NUMBER]', kwArgs.number).replace('[ITEM]', kwArgs.item).replace('[NAME]', kwArgs.name);\n\t\t\t}\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target)).replace('[SOURCE]', this.pokemon(kwArgs.of));\n\t\t}\n\n\t\tcase '-prepare': {\n\t\t\tconst [, pokemon, effect, target] = args;\n\t\t\tconst template = this.template('prepare', effect);\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\n\t\t}\n\n\t\tcase '-damage': {\n\t\t\tlet [, pokemon, , percentage] = args;\n\t\t\tlet template = this.template('damage', kwArgs.from, 'NODEFAULT');\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\n\t\t\tif (template) {\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t\t}\n\n\t\t\tif (!kwArgs.from) {\n\t\t\t\ttemplate = this.template(percentage ? 'damagePercentage' : 'damage');\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[PERCENTAGE]', percentage);\n\t\t\t}\n\t\t\tif (kwArgs.from.startsWith('item:')) {\n\t\t\t\ttemplate = this.template(kwArgs.of ? 'damageFromPokemon' : 'damageFromItem');\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(kwArgs.from)).replace('[SOURCE]', this.pokemon(kwArgs.of));\n\t\t\t}\n\t\t\tif (kwArgs.partiallytrapped || id === 'bind' || id === 'wrap') {\n\t\t\t\ttemplate = this.template('damageFromPartialTrapping');\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', this.effect(kwArgs.from));\n\t\t\t}\n\n\t\t\ttemplate = this.template('damage');\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-heal': {\n\t\t\tlet [, pokemon] = args;\n\t\t\tlet template = this.template('heal', kwArgs.from, 'NODEFAULT');\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, pokemon);\n\t\t\tif (template) {\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[NICKNAME]', kwArgs.wisher);\n\t\t\t}\n\n\t\t\tif (kwArgs.from && !kwArgs.from.startsWith('ability:')) {\n\t\t\t\ttemplate = this.template('healFromEffect');\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[EFFECT]', this.effect(kwArgs.from));\n\t\t\t}\n\n\t\t\ttemplate = this.template('heal');\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-boost': case '-unboost': {\n\t\t\tlet [, pokemon, stat, num] = args;\n\t\t\tif (stat === 'spa' && this.gen === 1) stat = 'spc';\n\t\t\tconst amount = parseInt(num, 10);\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tlet templateId = cmd.slice(1);\n\t\t\tif (amount >= 3) templateId += '3';\n\t\t\telse if (amount >= 2) templateId += '2';\n\t\t\telse if (amount === 0) templateId += '0';\n\t\t\tif (amount && kwArgs.zeffect) {\n\t\t\t\ttemplateId += (kwArgs.multiple ? 'MultipleFromZEffect' : 'FromZEffect');\n\t\t\t} else if (amount && kwArgs.from?.startsWith('item:')) {\n\t\t\t\tconst template = this.template(templateId + 'FromItem', kwArgs.from);\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[STAT]', BattleTextParser.stat(stat)).replace('[ITEM]', this.effect(kwArgs.from));\n\t\t\t}\n\t\t\tconst template = this.template(templateId, kwArgs.from);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[STAT]', BattleTextParser.stat(stat));\n\t\t}\n\n\t\tcase '-setboost': {\n\t\t\tconst [, pokemon] = args;\n\t\t\tconst effect = kwArgs.from;\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon);\n\t\t\tconst template = this.template('boost', effect);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-swapboost': {\n\t\t\tconst [, pokemon, target] = args;\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\n\t\t\tlet templateId = 'swapBoost';\n\t\t\tif (id === 'guardswap') templateId = 'swapDefensiveBoost';\n\t\t\tif (id === 'powerswap') templateId = 'swapOffensiveBoost';\n\t\t\tconst template = this.template(templateId, kwArgs.from);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\n\t\t}\n\n\t\tcase '-copyboost': {\n\t\t\tconst [, pokemon, target] = args;\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tconst template = this.template('copyBoost', kwArgs.from);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\n\t\t}\n\n\t\tcase '-clearboost': case '-clearpositiveboost': case '-clearnegativeboost': {\n\t\t\tconst [, pokemon, source] = args;\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tlet templateId = 'clearBoost';\n\t\t\tif (kwArgs.zeffect) templateId = 'clearBoostFromZEffect';\n\t\t\tconst template = this.template(templateId, kwArgs.from);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(source));\n\t\t}\n\n\t\tcase '-invertboost': {\n\t\t\tconst [, pokemon] = args;\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tconst template = this.template('invertBoost', kwArgs.from);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-clearallboost': {\n\t\t\treturn this.template('clearAllBoost', kwArgs.from);\n\t\t}\n\n\t\tcase '-crit': case '-supereffective': case '-resisted': {\n\t\t\tconst [, pokemon] = args;\n\t\t\tlet templateId = cmd.slice(1);\n\t\t\tif (templateId === 'supereffective') templateId = 'superEffective';\n\t\t\tif (kwArgs.spread) templateId += 'Spread';\n\t\t\tconst template = this.template(templateId);\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-block': {\n\t\t\tlet [, pokemon, effect, move, attacker] = args;\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon);\n\t\t\tlet id = BattleTextParser.effectId(effect);\n\t\t\tlet templateId = 'block';\n\t\t\tif (id === 'mist' && this.gen <= 2) templateId = 'blockGen' + this.gen;\n\t\t\tconst template = this.template(templateId, effect);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(attacker || kwArgs.of)).replace('[MOVE]', move);\n\t\t}\n\n\t\tcase '-fail': {\n\t\t\tlet [, pokemon, effect, stat] = args;\n\t\t\tlet id = BattleTextParser.effectId(effect);\n\t\t\tlet blocker = BattleTextParser.effectId(kwArgs.from);\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tlet templateId = 'block';\n\t\t\tif (['desolateland', 'primordialsea'].includes(blocker) &&\n\t\t\t\t!['sunnyday', 'raindance', 'sandstorm', 'hail', 'snow'].includes(id)) {\n\t\t\t\ttemplateId = 'blockMove';\n\t\t\t} else if (blocker === 'uproar' && kwArgs.msg) {\n\t\t\t\ttemplateId = 'blockSelf';\n\t\t\t}\n\t\t\tlet template = this.template(templateId, kwArgs.from);\n\t\t\tif (template) {\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t\t}\n\n\t\t\tif (id === 'unboost') {\n\t\t\t\ttemplate = this.template(stat ? 'failSingular' : 'fail', 'unboost');\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[STAT]', stat);\n\t\t\t}\n\n\t\t\ttemplateId = 'fail';\n\t\t\tif (['brn', 'frz', 'par', 'psn', 'slp', 'substitute', 'shedtail'].includes(id)) {\n\t\t\t\ttemplateId = 'alreadyStarted';\n\t\t\t}\n\t\t\tif (kwArgs.heavy) templateId = 'failTooHeavy';\n\t\t\tif (kwArgs.weak) templateId = 'fail';\n\t\t\tif (kwArgs.forme) templateId = 'failWrongForme';\n\t\t\ttemplate = this.template(templateId, id);\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-immune': {\n\t\t\tconst [, pokemon] = args;\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tlet template = this.template('block', kwArgs.from);\n\t\t\tif (!template) {\n\t\t\t\tconst templateId = kwArgs.ohko ? 'immuneOHKO' : 'immune';\n\t\t\t\ttemplate = this.template(pokemon ? templateId : 'immuneNoPokemon', kwArgs.from);\n\t\t\t}\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-miss': {\n\t\t\tconst [, source, pokemon] = args;\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\n\t\t\tif (!pokemon) {\n\t\t\t\tconst template = this.template('missNoPokemon');\n\t\t\t\treturn line1 + template.replace('[SOURCE]', this.pokemon(source));\n\t\t\t}\n\t\t\tconst template = this.template('miss');\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-center': case '-ohko': case '-combine': {\n\t\t\treturn this.template(cmd.slice(1));\n\t\t}\n\n\t\tcase '-notarget': {\n\t\t\treturn this.template('noTarget');\n\t\t}\n\n\t\tcase '-mega': case '-primal': {\n\t\t\tconst [, pokemon, species, item] = args;\n\t\t\tlet id = '';\n\t\t\tlet templateId = cmd.slice(1);\n\t\t\tif (species === 'Rayquaza') {\n\t\t\t\tid = 'dragonascent';\n\t\t\t\ttemplateId = 'megaNoItem';\n\t\t\t}\n\t\t\tif (!id && cmd === '-mega' && this.gen < 7) templateId = 'megaGen6';\n\t\t\tif (!item && cmd === '-mega') templateId = 'megaNoItem';\n\t\t\tlet template = this.template(templateId, id);\n\t\t\tconst side = pokemon.slice(0, 2);\n\t\t\tconst pokemonName = this.pokemon(pokemon);\n\t\t\tif (cmd === '-mega') {\n\t\t\t\tconst template2 = this.template('transformMega');\n\t\t\t\ttemplate += template2.replace('[POKEMON]', pokemonName).replace('[SPECIES]', species);\n\t\t\t}\n\t\t\treturn template.replace('[POKEMON]', pokemonName).replace('[ITEM]', item).replace('[TRAINER]', this.trainer(side));\n\t\t}\n\n\t\tcase '-terastallize': {\n\t\t\tconst [, pokemon, type] = args;\n\t\t\tlet id = '';\n\t\t\tlet templateId = cmd.slice(1);\n\t\t\tlet template = this.template(templateId, id);\n\t\t\tconst pokemonName = this.pokemon(pokemon);\n\t\t\treturn template.replace('[POKEMON]', pokemonName).replace('[TYPE]', type);\n\t\t}\n\n\t\tcase '-zpower': {\n\t\t\tconst [, pokemon] = args;\n\t\t\tconst template = this.template('zPower');\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-burst': {\n\t\t\tconst [, pokemon] = args;\n\t\t\tconst template = this.template('activate', \"Ultranecrozium Z\");\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-zbroken': {\n\t\t\tconst [, pokemon] = args;\n\t\t\tconst template = this.template('zBroken');\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\n\t\t}\n\n\t\tcase '-hitcount': {\n\t\t\tconst [, , num] = args;\n\t\t\tif (num === '1') {\n\t\t\t\treturn this.template('hitCountSingular');\n\t\t\t}\n\t\t\treturn this.template('hitCount').replace('[NUMBER]', num);\n\t\t}\n\n\t\tcase '-waiting': {\n\t\t\tconst [, pokemon, target] = args;\n\t\t\tconst template = this.template('activate', \"Water Pledge\");\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\n\t\t}\n\n\t\tcase '-anim': {\n\t\t\treturn '';\n\t\t}\n\n\t\tdefault: {\n\t\t\treturn null;\n\t\t}\n\t\t}\n\t}\n}\n\nif (typeof require === 'function') {\n\t// in Node\n\t(global as any).BattleTextParser = BattleTextParser;\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GARA;;;;;;;;AAgBMA,gBAAgB;;;;;;;;;;;AAWrB,2BAAwC,IAA5BC,YAAmB,2DAAG,IAAI,MAVtCC,EAAE,CAAG,UAAU,MACfC,EAAE,CAAG,UAAU,MACfC,EAAE,CAAG,UAAU,MACfC,EAAE,CAAG,UAAU,MACfJ,WAAW,aACXK,GAAG,CAAG,CAAC,MACPC,IAAI,CAAG,CAAC,MACRC,cAAc,CAAiD,OAAO,MACtEC,eAAe,CAA8BC,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6MtDC,WAAW,CAAG,SAACC,OAAe,CAAK;AAClC,GAAI,CAACA,OAAO,CAAE,MAAO,EAAE;AACvB,GAAI,CAACA,OAAO,CAACC,UAAU,CAAC,GAAG,CAAC,CAAE,oBAAqBD,OAAO;AAC1D,GAAIA,OAAO,CAACE,MAAM,CAAC,CAAC,CAAC,GAAK,GAAG,CAAE,MAAOF,QAAO,CAACG,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,EAAE,CAAC;AACzD,GAAIJ,OAAO,CAACE,MAAM,CAAC,CAAC,CAAC,GAAK,GAAG,CAAE,MAAOF,QAAO,CAACG,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,EAAE;AAClE,oBAAqBJ,OAAO;AAC7B,CAAC,CAhNA,IAAI,CAACX,WAAW,CAAGA,WAAW,CAC/B,CAAC,iBAIMgB,SAAS,CAAhB,mBAAiBC,IAAY,CAAEC,SAAmB,CAAe,CAChE,GAAI,CAACD,IAAI,CAACL,UAAU,CAAC,GAAG,CAAC,CAAE,CAC1B,MAAO,CAAC,EAAE,CAAEK,IAAI,CAAC,CAClB,CACA,GAAIA,IAAI,GAAK,GAAG,CAAE,CACjB,MAAO,CAAC,MAAM,CAAC,CAChB,CACA,GAAME,MAAK,CAAGF,IAAI,CAACG,OAAO,CAAC,GAAG,CAAE,CAAC,CAAC,CAClC,GAAMC,IAAG,CAAGJ,IAAI,CAACH,KAAK,CAAC,CAAC,CAAEK,KAAK,CAAC,CAChC,OAAQE,GAAG,EACX,IAAK,SAAS,CAAE,IAAK,aAAa,CAAE,IAAK,KAAK,CAAE,IAAK,OAAO,CAAE,IAAK,MAAM,CACzE,IAAK,UAAU,CAAE,IAAK,aAAa,CAAE,IAAK,SAAS,CACnD,IAAK,WAAW,CAAE,IAAK,cAAc,CAAE,IAAK,UAAU,CACtD,IAAK,OAAO,CAAE,IAAK,MAAM,CAAE,IAAK,UAAU,CAAE,IAAK,OAAO,CAAE,IAAK,EAAE,CAChE,MAAO,CAACA,GAAG,CAAEJ,IAAI,CAACH,KAAK,CAACK,KAAK,CAAG,CAAC,CAAC,CAAC,CACpC,IAAK,GAAG,CAAE,IAAK,MAAM,CAAE,IAAK,OAAO,CAAE,IAAK,aAAa,CAAE,IAAK,eAAe,CAE5E,GAAMG,QAAO,CAAGL,IAAI,CAACG,OAAO,CAAC,GAAG,CAAED,KAAK,CAAG,CAAC,CAAC,CAC5C,MAAO,CAACE,GAAG,CAAEJ,IAAI,CAACH,KAAK,CAACK,KAAK,CAAG,CAAC,CAAEG,OAAO,CAAC,CAAEL,IAAI,CAACH,KAAK,CAACQ,OAAO,CAAG,CAAC,CAAC,CAAC,CACtE,IAAK,IAAI,CAAE,IAAK,IAAI,CAEnB,GAAMC,QAAO,CAAGN,IAAI,CAACG,OAAO,CAAC,GAAG,CAAED,KAAK,CAAG,CAAC,CAAC,CAC5C,GAAMK,QAAO,CAAGP,IAAI,CAACG,OAAO,CAAC,GAAG,CAAEG,OAAO,CAAG,CAAC,CAAC,CAC9C,MAAO,CAACF,GAAG,CAAEJ,IAAI,CAACH,KAAK,CAACK,KAAK,CAAG,CAAC,CAAEI,OAAO,CAAC,CAAEN,IAAI,CAACH,KAAK,CAACS,OAAO,CAAG,CAAC,CAAEC,OAAO,CAAC,CAAEP,IAAI,CAACH,KAAK,CAACU,OAAO,CAAG,CAAC,CAAC,CAAC,CAAC,CAEzG,GAAIN,SAAS,CAAE,MAAO,KAAI,CAC1B,MAAOD,KAAI,CAACH,KAAK,CAAC,CAAC,CAAC,CAACW,KAAK,CAAC,GAAG,CAAC,CAChC,CAAC,kBAEMC,eAAe,CAAtB,yBAAuBT,IAAY,CAAgC,CAClE,GAAIU,KAAI,CAAG,IAAI,CAACX,SAAS,CAACC,IAAI,CAAE,IAAI,CAAC,CACrC,GAAIU,IAAI,CAAE,MAAO,CAACA,IAAI,CAAJA,IAAI,CAAEC,MAAM,CAAE,CAAC,CAAC,CAAC,CAEnCD,IAAI,CAAGV,IAAI,CAACH,KAAK,CAAC,CAAC,CAAC,CAACW,KAAK,CAAC,GAAG,CAA0B,CACxD,GAAMG,OAAc,CAAG,CAAC,CAAC,CACzB,MAAOD,IAAI,CAACE,MAAM,CAAG,CAAC,CAAE,CACvB,GAAMC,QAAO,CAAGH,IAAI,CAACA,IAAI,CAACE,MAAM,CAAG,CAAC,CAAC,CACrC,GAAIC,OAAO,CAACjB,MAAM,CAAC,CAAC,CAAC,GAAK,GAAG,CAAE,MAC/B,GAAMkB,WAAU,CAAGD,OAAO,CAACV,OAAO,CAAC,GAAG,CAAC,CACvC,GAAIW,UAAU,EAAI,CAAC,CAAE,MAErBH,MAAM,CAACE,OAAO,CAAChB,KAAK,CAAC,CAAC,CAAEiB,UAAU,CAAC,CAAC,CAAGD,OAAO,CAAChB,KAAK,CAACiB,UAAU,CAAG,CAAC,CAAC,CAAChB,IAAI,EAAE,EAAI,GAAG,CAClFY,IAAI,CAACK,GAAG,EAAE,CACX,CACA,MAAOjC,iBAAgB,CAACkC,WAAW,CAAC,CAACN,IAAI,CAAJA,IAAI,CAAEC,MAAM,CAANA,MAAM,CAAC,CAAC,CACpD,CAAC,kBAEMM,cAAc,CAArB,wBAAsBC,IAAY,CAAE,CACnC,GAAIC,MAAK,CAAG,EAAE,CAEd,GAAI,CAAC,aAAa,CAACC,IAAI,CAACF,IAAI,CAACtB,MAAM,CAAC,CAAC,CAAC,CAAC,CAAE,CACxCuB,KAAK,CAAGD,IAAI,CAACtB,MAAM,CAAC,CAAC,CAAC,CACtBsB,IAAI,CAAGA,IAAI,CAACrB,KAAK,CAAC,CAAC,CAAC,CACrB,CAEA,GAAIwB,KAAI,CAAGH,IAAI,CACf,GAAMI,QAAO,CAAGJ,IAAI,CAACf,OAAO,CAAC,GAAG,CAAC,CACjC,GAAIoB,OAAM,CAAG,EAAE,CACf,GAAIC,KAAI,CAAG,KAAK,CAChB,GAAIF,OAAO,CAAG,CAAC,CAAE,CAChBD,IAAI,CAAGH,IAAI,CAACrB,KAAK,CAAC,CAAC,CAAEyB,OAAO,CAAC,CAC7BC,MAAM,CAAGL,IAAI,CAACrB,KAAK,CAACyB,OAAO,CAAG,CAAC,CAAC,CAChC,GAAIC,MAAM,CAAC5B,UAAU,CAAC,GAAG,CAAC,CAAE,CAC3B6B,IAAI,CAAG,IAAI,CACXD,MAAM,CAAGA,MAAM,CAAC1B,KAAK,CAAC,CAAC,CAAC,CACzB,CACD,CACA,MAAO,CAACsB,KAAK,CAALA,KAAK,CAAEE,IAAI,CAAJA,IAAI,CAAEG,IAAI,CAAJA,IAAI,CAAED,MAAM,CAANA,MAAM,CAAC,CACnC,CAAC,kBAEMP,WAAW,CAAlB,0BAA+F,IAA3EN,KAAI,MAAJA,IAAI,CAAEC,MAAM,MAANA,MAAM,CAC/B,OAAQD,IAAI,CAAC,CAAC,CAAC,EACf,IAAK,WAAW,CAAE,CACjB,GAAIC,MAAM,CAACc,IAAI,EAAId,MAAM,CAACe,IAAI,EAAIf,MAAM,CAACgB,MAAM,EAAIhB,MAAM,CAACiB,OAAO,CAAE,MAAO,CAAClB,IAAI,CAAJA,IAAI,CAAEC,MAAM,CAANA,MAAM,CAAC,CACxF,UAAsCD,IAAI,CAAnChB,OAAO,UAAEmC,MAAM,UAAEC,IAAI,UAAEC,IAAI,UAClC,GAAIC,OAAM,CAAGrB,MAAM,CAACsB,EAAE,CACtB,GAAMC,IAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACN,MAAM,CAAC,CAE5C,GAAIlB,MAAM,CAACyB,KAAK,CAAE,MAAO,CAAC1B,IAAI,CAAE,CAAC,OAAO,CAAEhB,OAAO,CAAC,CAAEiB,MAAM,CAANA,MAAM,CAAC,CAE3D,GAAIuB,GAAE,GAAK,aAAa,CAAE,MAAO,CAACxB,IAAI,CAAE,CAAC,SAAS,CAAEhB,OAAO,CAAC,CAAEiB,MAAM,CAAE,CAAC0B,IAAI,CAAE,sBAAsB,CAAC,CAAC,CAErG,GAAIH,GAAE,GAAK,QAAQ,EAAIvB,MAAM,CAACsB,EAAE,CAAE,MAAO,CAACvB,IAAI,CAAJA,IAAI,CAAEC,MAAM,CAAE,CAACU,IAAI,CAAEV,MAAM,CAACsB,EAAE,CAAC,CAAC,CAE1E,GAAI,CACH,SAAS,CAAE,YAAY,CAAE,WAAW,CAAE,cAAc,CAAE,UAAU,CAAE,SAAS,CAAE,MAAM,CAAE,WAAW,CAChG,iBAAiB,CAAE,cAAc,CAAE,gBAAgB,CAAE,WAAW,CAAE,YAAY,CAAE,aAAa,CAAE,WAAW,CAC1G,YAAY,CAAE,WAAW,CAAE,UAAU,CAAE,eAAe,CAAE,gBAAgB,CACxE,CAACK,QAAQ,CAACJ,GAAE,CAAC,CAAE,CACf,GAAIF,MAAM,CAAE,CACXrB,MAAM,CAACsB,EAAE,CAAGvC,OAAO,CACnB,MAAO,CAACgB,IAAI,CAAE,CAAC,QAAQ,CAAEsB,MAAM,CAAEH,MAAM,CAAEC,IAAI,CAAC,CAAEnB,MAAM,CAANA,MAAM,CAAC,CACxD,CACA,MAAO,CAACD,IAAI,CAAE,CAAC,QAAQ,CAAEhB,OAAO,CAAEmC,MAAM,CAAEC,IAAI,CAAC,CAAEnB,MAAM,CAANA,MAAM,CAAC,CACzD,CAEA,GAAIuB,GAAE,GAAK,QAAQ,CAAE,CACpB,MAAO,CAACxB,IAAI,CAAE,CAAC,aAAa,CAAEhB,OAAO,CAAEmC,MAAM,CAAC,CAAElB,MAAM,CAAE,CAACsB,EAAE,CAAED,MAAM,CAAC,CAAC,CACtE,CACA,GAAI,CACH,MAAM,CAAE,MAAM,CAAE,OAAO,CAAE,WAAW,CAAE,UAAU,CAAE,YAAY,CAAE,UAAU,CAAE,aAAa,CAAE,UAAU,CAAE,aAAa,CAAE,SAAS,CAC/H,CAACM,QAAQ,CAACJ,GAAE,CAAC,CAAE,CACf,MAAO,CAACxB,IAAI,CAAE,CAAC,QAAQ,CAAEhB,OAAO,CAAEmC,MAAM,CAAC,CAAElB,MAAM,CAAE,CAACsB,EAAE,CAAED,MAAM,CAAC,CAAC,CACjE,CAEA,GAAIE,GAAE,GAAK,WAAW,CAAE,CACvB,MAAO,CAACxB,IAAI,CAAE,CAAC,gBAAgB,CAAEmB,MAAM,CAAC,CAAElB,MAAM,CAAE,CAAC,CAAC,CAAC,CACtD,CAEA,GAAIuB,GAAE,GAAK,WAAW,EAAIA,GAAE,GAAK,aAAa,CAAE,CAC/CvB,MAAM,CAACc,IAAI,CAAGK,IAAI,CACnB,CAAC,IAAM,IAAII,GAAE,GAAK,WAAW,CAAE,CAC9BvB,MAAM,CAACgB,MAAM,CAAGG,IAAI,CACrB,CAAC,IAAM,IAAII,GAAE,GAAK,WAAW,EAAIA,GAAE,GAAK,OAAO,EAAIA,GAAE,GAAK,iBAAiB,CAAE,CAC5EvB,MAAM,CAACiB,OAAO,CAAGE,IAAI,CACrBnB,MAAM,CAAC4B,QAAQ,CAAGR,IAAI,CACvB,CAAC,IAAM,IAAI,CACV,YAAY,CAAE,eAAe,CAAE,OAAO,CAAE,QAAQ,CAAE,UAAU,CAAE,QAAQ,CAAE,YAAY,CAAE,cAAc,CACpG,CAACO,QAAQ,CAACJ,GAAE,CAAC,CAAE,CACfvB,MAAM,CAACe,IAAI,CAAGI,IAAI,CAClBnB,MAAM,CAACgB,MAAM,CAAGI,IAAI,CACrB,CACArB,IAAI,CAAG,CAAC,WAAW,CAAEhB,OAAO,CAAEmC,MAAM,CAAEG,MAAM,EAAI,EAAE,CAAC,CACnD,MACD,CAEA,IAAK,OAAO,CAAE,CACb,GAAIrB,MAAM,CAAC0B,IAAI,GAAK,sBAAsB,CAAE,CAC3C,MAAO,CAAC3B,IAAI,CAAE,CAAC,QAAQ,CAAEC,MAAM,CAACsB,EAAE,CAAE,sBAAsB,CAAC,CAAEtB,MAAM,CAAE,CAACsB,EAAE,CAAEvB,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CACpF,CACA,MACD,CAEA,IAAK,QAAQ,CAAE,CACd,GAAIC,MAAM,CAAC0B,IAAI,GAAK,SAAS,EAAI1B,MAAM,CAAC0B,IAAI,GAAK,cAAc,CAAE1B,MAAM,CAAC0B,IAAI,CAAG,UAAU,CAAG1B,MAAM,CAAC0B,IAAI,CACvG,MACD,CAEA,IAAK,MAAM,CAAE,CACZ,GAAI1B,MAAM,CAAC0B,IAAI,GAAK,cAAc,CAAE1B,MAAM,CAAC0B,IAAI,CAAG,sBAAsB,CACxE,MACD,CAEA,IAAK,MAAM,CAAE,CACZ,WAAgC3B,IAAI,CAA7BhB,SAAO,WAAEmC,QAAM,WAAEH,IAAI,WAC5B,GAAI,CAAC,eAAe,CAAE,mBAAmB,CAAE,0BAA0B,CAAE,qBAAqB,CAAC,CAACY,QAAQ,CAACT,QAAM,CAAC,CAAE,CAC/GnB,IAAI,CAAC,CAAC,CAAC,CAAG,QAAQ,CAClB,MAAO,CAACA,IAAI,CAAE,CAAC,QAAQ,CAAEhB,SAAO,CAAEmC,QAAM,CAAEH,IAAI,CAAEf,MAAM,CAACsB,EAAE,CAAC,CAAEtB,MAAM,CAAE,CAAC,CAAC,CAAC,CACxE,CACA,MACD,CAEA,IAAK,UAAU,CAGd,MAAO,CAACD,IAAI,CAAE,CAAC,WAAW,CAAE,EAAE,CAAE,aAAa,CAAC,CAAEC,MAAM,CAANA,MAAM,CAAC,CAAC,CAEzD,MAAO,CAACD,IAAI,CAAJA,IAAI,CAAEC,MAAM,CAANA,MAAM,CAAC,CACtB,CAAC,8CAED6B,cAAc,CAAd,wBAAeC,GAAW,CAAE,CAC3B,GAAIC,IAAG,CAAG,EAAE,CAAC,wBACMD,GAAG,CAACjC,KAAK,CAAC,IAAI,CAAC,2BAAE,CAA/B,GAAMR,MAAI,gBACd,0BAAuBlB,gBAAgB,CAAC2B,eAAe,CAACT,KAAI,CAAC,CAAtDU,IAAI,uBAAJA,IAAI,CAAEC,MAAM,uBAANA,MAAM,CACnB+B,GAAG,EAAI,IAAI,CAACC,SAAS,CAACjC,IAAI,CAAEC,MAAM,CAAC,EAAI,EAAE,CAC1C,CACA,MAAO+B,IAAG,CACX,CAAC,QAEDE,YAAY,CAAZ,sBAAaC,KAAa,CAAE,CAC3B,GAAI,IAAI,CAACtD,eAAe,GAAKC,SAAS,CAAE,CACvC,GAAMsD,SAAQ,CAAG,CAAC,SAAS,CAAE,iBAAiB,CAAE,MAAM,CAAE,cAAc,CAAE,OAAO,CAAE,eAAe,CAAC,CAACC,GAAG,CAAC,SAAAC,UAAU,CAAI,CACnH,GAAMC,SAAQ,CAAGC,UAAU,WAAQ,CAACF,UAAU,CAAC,CAC/C,GAAIC,QAAQ,CAACrD,MAAM,CAAC,CAAC,CAAC,GAAKqD,QAAQ,CAACrD,MAAM,CAAC,CAAC,CAAC,CAACuD,WAAW,EAAE,CAAE,MAAO,EAAE,CACtE,GAAMC,aAAY,CAAGH,QAAQ,CAAC9C,OAAO,CAAC,GAAG,CAAC,CAC1C,GAAIiD,YAAY,EAAI,CAAC,CAAE,MAAOH,SAAQ,CAACpD,KAAK,CAAC,CAAC,CAAEuD,YAAY,CAAC,CAC7D,MAAOH,SAAQ,CAChB,CAAC,CAAC,CAACI,MAAM,CAAC,SAAAC,MAAM,QAAIA,OAAM,GAAC,CAC3B,GAAIR,QAAQ,CAAClC,MAAM,CAAE,CACpB,GAAI6B,IAAG,CAAG,+BACTK,QAAQ,CAACC,GAAG,CAACjE,gBAAgB,CAACyE,YAAY,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC,IAClD,CACJ,IAAI,CAACjE,eAAe,CAAG,GAAIkE,OAAM,CAAChB,GAAG,CAAE,GAAG,CAAC,CAC5C,CAAC,IAAM,CACN,IAAI,CAAClD,eAAe,CAAG,IAAI,CAC5B,CACD,CACA,GAAI,CAAC,IAAI,CAACA,eAAe,CAAE,MAAOsD,MAAK,CACvC,MAAOA,MAAK,CAACa,OAAO,CAAC,IAAI,CAACnE,eAAe,CAAE,SAACoE,KAAK,CAAE3E,EAAE,CAAEC,EAAE,QACxDD,GAAE,CAAGC,EAAE,CAACW,MAAM,CAAC,CAAC,CAAC,CAACuD,WAAW,EAAE,CAAGlE,EAAE,CAACY,KAAK,CAAC,CAAC,CAAC,EAC7C,CAAC,CACH,CAAC,kBAEM0D,YAAY,CAAnB,sBAAoBV,KAAa,CAAE,CAClC,MAAOA,MAAK,CAACa,OAAO,CAAC,qBAAqB,CAAE,MAAM,CAAC,CACpD,CAAC;;AAUDhE,OAAO,CAAP,iBAAQA,QAAe,CAAE;AACxB,GAAI,CAACA,QAAO,CAAE,MAAO,EAAE;AACvB,GAAIkE,KAAI,CAAGlE,QAAO,CAACG,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC;AAC9B,GAAI,CAAC,CAAC,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,IAAI,CAAC,CAACyC,QAAQ,CAACsB,IAAI,CAAC,CAAE,oBAAqBlE,QAAO;AAC1E,GAAM2B,KAAI,CAAG,IAAI,CAAC5B,WAAW,CAACC,QAAO,CAAC;AACtC,GAAMmE,OAAM,CAAGD,IAAI,GAAK,IAAI,CAAC7E,WAAW,EAAI6E,IAAI,GAAK9E,gBAAgB,CAACgF,MAAM,CAACF,IAAI,CAAW;AAC5F,GAAMX,SAAQ,CAAGC,UAAU,WAAQ,CAACW,MAAM,CAAG,SAAS,CAAG,iBAAiB,CAAC;AAC3E,MAAOZ,SAAQ,CAACS,OAAO,CAAC,YAAY,CAAErC,IAAI,CAAC;AAC5C,CAAC;;AAED0C,WAAW,CAAX,qBAAYrE,OAAe,CAAEsE,OAAe,CAAoB;AAC/D,GAAMC,SAAQ,CAAG,IAAI,CAACxE,WAAW,CAACC,OAAO,CAAC;;AAE1C,GAAMwE,QAAO,CAAGF,OAAO,CAACxD,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;AACrC,GAAIyD,QAAQ,GAAKC,OAAO,CAAE,MAAO,CAACxE,OAAO,CAACG,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,MAAOqE,OAAO,MAAK;AACxE,MAAO,CAACxE,OAAO,CAACG,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAKoE,QAAQ,QAAOC,OAAO,OAAM;AAC7D,CAAC;;AAEDC,OAAO,CAAP,iBAAQP,IAAY,CAAE;AACrBA,IAAI,CAAGA,IAAI,CAAC/D,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC;AACvB,GAAI+D,IAAI,GAAK,IAAI,CAAE,MAAO,KAAI,CAAC5E,EAAE;AACjC,GAAI4E,IAAI,GAAK,IAAI,CAAE,MAAO,KAAI,CAAC3E,EAAE;AACjC,GAAI2E,IAAI,GAAK,IAAI,CAAE,MAAO,KAAI,CAAC1E,EAAE;AACjC,GAAI0E,IAAI,GAAK,IAAI,CAAE,MAAO,KAAI,CAACzE,EAAE;AACjC,iBAAkByE,IAAI;AACvB,CAAC;;AAEME,MAAM,CAAb,gBAAcM,MAAc,CAAe;AAC1C,GAAIA,MAAM,GAAK,IAAI,CAAE,MAAO,IAAI;AAChC,GAAIA,MAAM,GAAK,IAAI,CAAE,MAAO,IAAI;AAChC,GAAIA,MAAM,GAAK,IAAI,CAAE,MAAO,IAAI;AAChC,GAAIA,MAAM,GAAK,IAAI,CAAE,MAAO,IAAI;AAChC,MAAO,EAAE;AACV,CAAC;;AAEDC,IAAI,CAAJ,cAAKT,IAAY,CAA0B,IAAxBU,MAAc,2DAAG,KAAK;AACxCV,IAAI,CAAGA,IAAI,CAAC/D,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC;AACvB,GAAI+D,IAAI,GAAK,IAAI,CAAC7E,WAAW,EAAI6E,IAAI,GAAK9E,gBAAgB,CAACgF,MAAM,CAACF,IAAI,CAAW,CAAE;AAClF,MAAO,CAACU,KAAK,CAAGpB,UAAU,WAAQ,CAACmB,IAAI,CAAGnB,UAAU,WAAQ,CAACqB,YAAY;AAC1E;AACA,MAAOD,MAAK,CAAGpB,UAAU,WAAQ,CAACmB,IAAI,CAAGnB,UAAU,WAAQ,CAACqB,YAAY;AACzE,CAAC;;AAEDC,GAAG,CAAH,aAAIZ,IAAY,CAAE;AACjBA,IAAI,CAAGA,IAAI,CAAC/D,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC;AACvB,GAAI+D,IAAI,GAAK,IAAI,CAAC7E,WAAW,CAAE;AAC9B,MAAO,KAAK;AACb;AACA,MAAO,EAAE;AACV,CAAC;;AAED0F,KAAK,CAAL,eAAMb,IAAY,CAAE;AACnBA,IAAI,CAAGA,IAAI,CAAC/D,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC;AACvB,GAAI+D,IAAI,GAAK,IAAI,CAAC7E,WAAW,EAAI6E,IAAI,GAAK9E,gBAAgB,CAACgF,MAAM,CAACF,IAAI,CAAW,CAAE;AAClF,MAAOV,WAAU,WAAQ,CAACuB,KAAK;AAChC;AACA,MAAOvB,WAAU,WAAQ,CAACwB,aAAa;AACxC,CAAC;;AAEMvC,QAAQ,CAAf,kBAAgBN,MAAe,CAAE;AAChC,GAAI,CAACA,MAAM,CAAE,MAAO,EAAE;AACtB,GAAIA,MAAM,CAAClC,UAAU,CAAC,OAAO,CAAC,EAAIkC,MAAM,CAAClC,UAAU,CAAC,OAAO,CAAC,CAAE;AAC7DkC,MAAM,CAAGA,MAAM,CAAChC,KAAK,CAAC,CAAC,CAAC;AACzB,CAAC,IAAM,IAAIgC,MAAM,CAAClC,UAAU,CAAC,UAAU,CAAC,CAAE;AACzCkC,MAAM,CAAGA,MAAM,CAAChC,KAAK,CAAC,CAAC,CAAC;AACzB;AACA,MAAO8E,KAAI,CAAC9C,MAAM,CAAC;AACpB,CAAC;;AAEDA,MAAM,CAAN,gBAAOA,OAAe,CAAE;AACvB,GAAI,CAACA,OAAM,CAAE,MAAO,EAAE;AACtB,GAAIA,OAAM,CAAClC,UAAU,CAAC,OAAO,CAAC,EAAIkC,OAAM,CAAClC,UAAU,CAAC,OAAO,CAAC,CAAE;AAC7DkC,OAAM,CAAGA,OAAM,CAAChC,KAAK,CAAC,CAAC,CAAC;AACzB,CAAC,IAAM,IAAIgC,OAAM,CAAClC,UAAU,CAAC,UAAU,CAAC,CAAE;AACzCkC,OAAM,CAAGA,OAAM,CAAChC,KAAK,CAAC,CAAC,CAAC;AACzB;AACA,MAAOgC,QAAM,CAAC/B,IAAI,EAAE;AACrB,CAAC;;AAEDmD,QAAQ,CAAR,kBAAS2B,IAAY,CAAyC,+BAApCC,UAAU,qDAAVA,UAAU;AACXA,UAAU,cAAE,CAA/B,GAAMC,UAAS,CAAID,UAAU,KAAd;AACnB,GAAI,CAACC,SAAS,CAAE;AAChB,GAAIA,SAAS,GAAK,KAAK,CAAE;AACxB,MAAO5B,WAAU,WAAQ,CAAC0B,IAAI,CAAG,KAAK,CAAC,CAAG,IAAI;AAC/C;AACA,GAAIE,SAAS,GAAK,WAAW,CAAE;AAC9B,MAAO,EAAE;AACV;AACA,GAAI5C,KAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAAC2C,SAAS,CAAC;AAC7C,GAAI5B,UAAU,CAAChB,IAAE,CAAC,EAAI0C,IAAI,GAAI1B,WAAU,CAAChB,IAAE,CAAC,CAAE;AAC7C,GAAIgB,UAAU,CAAChB,IAAE,CAAC,CAAC0C,IAAI,CAAC,CAAChF,MAAM,CAAC,CAAC,CAAC,GAAK,GAAG,CAAEgF,IAAI,CAAG1B,UAAU,CAAChB,IAAE,CAAC,CAAC0C,IAAI,CAAC,CAAC/E,KAAK,CAAC,CAAC,CAAO;AACtF,GAAIqD,UAAU,CAAChB,IAAE,CAAC,CAAC0C,IAAI,CAAC,CAAChF,MAAM,CAAC,CAAC,CAAC,GAAK,GAAG,CAAEsC,IAAE,CAAGgB,UAAU,CAAChB,IAAE,CAAC,CAAC0C,IAAI,CAAC,CAAC/E,KAAK,CAAC,CAAC,CAAO;AACpF,GAAI,CAACqD,UAAU,CAAChB,IAAE,CAAC,CAAC0C,IAAI,CAAC,CAAE,MAAO,EAAE;AACpC,MAAO1B,WAAU,CAAChB,IAAE,CAAC,CAAC0C,IAAI,CAAC,CAAG,IAAI;AACnC;AACD;AACA,GAAI,CAAC1B,UAAU,WAAQ,CAAC0B,IAAI,CAAC,CAAE,MAAO,EAAE;AACxC,MAAO1B,WAAU,WAAQ,CAAC0B,IAAI,CAAC,CAAG,IAAI;AACvC,CAAC;;AAEDG,YAAY,CAAZ,sBAAalD,MAA0B,CAAEmD,MAAc,CAAE;AACxD,GAAI,CAACnD,MAAM,CAAE,MAAO,EAAE;AACtB,GAAI,CAACA,MAAM,CAAClC,UAAU,CAAC,UAAU,CAAC,CAAE,MAAO,EAAE;AAC7C,MAAO,KAAI,CAACiC,OAAO,CAACC,MAAM,CAAChC,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,EAAE,CAAEkF,MAAM,CAAC;AACpD,CAAC;;AAEDpD,OAAO,CAAP,iBAAQP,IAAwB,CAAE2D,MAAc,CAAE;AACjD,GAAI,CAAC3D,IAAI,CAAE,MAAO,EAAE;AACpB,MAAO6B,WAAU,WAAQ,CAAC+B,iBAAiB,CAACvB,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACsF,MAAM,CAAC,CAAC,CAACtB,OAAO,CAAC,WAAW,CAAE,IAAI,CAAC7B,MAAM,CAACR,IAAI,CAAC,CAAC,CAAG,IAAI;AACtI,CAAC;;AAEM6D,IAAI,CAAX,cAAYA,KAAY,CAAE;AACzB,GAAMC,MAAK,CAAGjC,UAAU,CAACgC,KAAI,EAAI,OAAO,CAAC;AACzC,GAAI,CAACC,KAAK,EAAI,CAACA,KAAK,CAACC,QAAQ,CAAE,iBAAkBF,KAAI;AACrD,MAAOC,MAAK,CAACC,QAAQ;AACtB,CAAC;;AAEDC,WAAW,CAAX,qBAAY3E,IAAU,CAAEC,MAAc,CAAE;AACvC,GAAMP,IAAG,CAAGM,IAAI,CAAC,CAAC,CAAC;AACnB,OAAQN,GAAG;AACX,IAAK,MAAM,CAAG,IAAK,MAAM;AACxB,MAAO,OAAO;AACf,IAAK,MAAM,CAAG,IAAK,MAAM,CAAE,IAAK,QAAQ,CAAE,IAAK,MAAM,CAAE,IAAK,QAAQ,CAAE,IAAK,OAAO;AAClF,IAAK,OAAO,CAAE,IAAK,aAAa,CAAE,IAAK,eAAe;AACrD,MAAO,OAAO;AACf,IAAK,WAAW,CAAE,IAAK,OAAO;AAC7B,MAAO,UAAU;AAClB,IAAK,SAAS;AACb,MAAO,WAAW;AACnB,IAAK,SAAS,CAAE;AACf,GAAM8B,KAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC;AACjD,GAAIH,IAAE,GAAK,WAAW,CAAE,MAAO,OAAO;AACtC,MAAO,WAAW;AACnB;AACA,IAAK,aAAa,CAAE;AACnB,GAAMA,KAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC;AACjD,GAAIH,IAAE,GAAK,aAAa,CAAE,MAAO,UAAU;AAC3C,MAAO,WAAW;AACnB;AACA,IAAK,QAAQ,CAAE;AACd,GAAMA,KAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC;AACjD,GAAIH,IAAE,GAAK,SAAS,CAAE,MAAO,UAAU;AACvC,MAAO,WAAW;AACnB;AACA,IAAK,WAAW,CAAE;AACjB,GAAMA,KAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACzB,IAAI,CAAC,CAAC,CAAC,CAAC;AAC7C,GAAIwB,IAAE,GAAK,WAAW,EAAIA,IAAE,GAAK,SAAS,CAAE,MAAO,UAAU;AAC7D,MAAO,WAAW;AACnB,CAAC;;AAED,MAAQ9B,IAAG,CAACR,MAAM,CAAC,CAAC,CAAC,GAAK,GAAG,CAAG,WAAW,CAAG,EAAE;AACjD,CAAC;;AAED0F,YAAY,CAAZ,sBAAa5E,IAAU,CAAEC,MAAc,CAAE;AACxC,GAAM4E,YAAW,CAAG,IAAI,CAACjG,cAAc;AACvC,GAAMkG,WAAU,CAAG,IAAI,CAACH,WAAW,CAAC3E,IAAI,CAAEC,MAAM,CAAC;AACjD,GAAI,CAAC6E,UAAU,CAAE,MAAO,MAAK;AAC7B,IAAI,CAAClG,cAAc,CAAGkG,UAAU;AAChC,OAAQA,UAAU;AAClB,IAAK,OAAO;AACX,GAAID,WAAW,GAAK,OAAO,CAAE,MAAO,KAAI;AACxC,MAAO,MAAK;AACb,IAAK,UAAU;AACf,IAAK,OAAO;AACX,GAAIA,WAAW,GAAK,WAAW,EAAIA,WAAW,GAAK,OAAO,CAAE,MAAO,KAAI;AACvE,MAAO,MAAK;AACb,IAAK,WAAW;AACf,MAAO,MAAK,CAAC;;AAEf,CAAC;;AAED5C,SAAS,CAAT,mBAAUjC,IAAU,CAAEC,MAAc,CAAE8E,cAAwB,CAAE;AAC/D,GAAIhD,IAAG,CAAG,CAACgD,cAAc,EAAI,IAAI,CAACH,YAAY,CAAC5E,IAAI,CAAEC,MAAM,CAAC,CAAG,IAAI,CAAG,EAAE;AACxE,MAAO8B,IAAG,CAAG,IAAI,CAACG,YAAY,CAAC,IAAI,CAAC8C,cAAc,CAAChF,IAAI,CAAEC,MAAM,CAAC,EAAI,EAAE,CAAC;AACxE,CAAC;;AAED+E,cAAc,CAAd,wBAAehF,IAAU,CAAEC,MAAc,CAAE;AAC1C,GAAIP,IAAG,CAAGM,IAAI,CAAC,CAAC,CAAC;AACjB,OAAQN,GAAG;AACX,IAAK,QAAQ,CAAE;AACd,GAASwD,KAAI,CAAUlD,IAAI,IAAZW,IAAI,CAAIX,IAAI;AAC3B,GAAIkD,IAAI,GAAK,IAAI,EAAIvC,IAAI,CAAE;AAC1B,IAAI,CAACrC,EAAE,CAAGqC,IAAI;AACf,CAAC,IAAM,IAAIuC,IAAI,GAAK,IAAI,EAAIvC,IAAI,CAAE;AACjC,IAAI,CAACpC,EAAE,CAAGoC,IAAI;AACf,CAAC,IAAM,IAAIuC,IAAI,GAAK,IAAI,EAAIvC,IAAI,CAAE;AACjC,IAAI,CAACnC,EAAE,CAAGmC,IAAI;AACf,CAAC,IAAM,IAAIuC,IAAI,GAAK,IAAI,EAAIvC,IAAI,CAAE;AACjC,IAAI,CAAClC,EAAE,CAAGkC,IAAI;AACf;AACA,MAAO,EAAE;AACV;;AAEA,IAAK,KAAK,CAAE;AACX,GAASsE,IAAG,CAAIjF,IAAI;AACpB,IAAI,CAACtB,GAAG,CAAGwG,QAAQ,CAACD,GAAG,CAAE,EAAE,CAAC;AAC5B,MAAO,EAAE;AACV;;AAEA,IAAK,MAAM,CAAE;AACZ,GAASA,KAAG,CAAIjF,IAAI;AACpB,IAAI,CAACrB,IAAI,CAAGwG,MAAM,CAACD,QAAQ,CAACD,IAAG,CAAE,EAAE,CAAC;AACpC,MAAO,KAAI,CAAC1C,QAAQ,CAAC,MAAM,CAAC,CAACS,OAAO,CAAC,UAAU,CAAEiC,IAAG,CAAC,CAAG,IAAI;AAC7D;;AAEA,IAAK,OAAO,CAAE;AACb,MAAO,KAAI,CAAC1C,QAAQ,CAAC,aAAa,CAAC,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAC1E,EAAE,CAAC,CAAC0E,OAAO,CAAC,WAAW,CAAE,IAAI,CAACzE,EAAE,CAAC;AAChG;;AAEA,IAAK,KAAK,CAAE,IAAK,KAAK,CAAE;AACvB,GAASoC,MAAI,CAAIX,IAAI;AACrB,GAAIN,GAAG,GAAK,KAAK,EAAI,CAACiB,KAAI,CAAE;AAC3B,MAAO,KAAI,CAAC4B,QAAQ,CAAC,WAAW,CAAC,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAC1E,EAAE,CAAC,CAAC0E,OAAO,CAAC,WAAW,CAAE,IAAI,CAACzE,EAAE,CAAC;AAC9F;AACA,MAAO,KAAI,CAACgE,QAAQ,CAAC,WAAW,CAAC,CAACS,OAAO,CAAC,WAAW,CAAErC,KAAI,CAAC;AAC7D;;AAEA,IAAK,QAAQ,CAAE;AACd,GAAS3B,QAAO,CAAagB,IAAI,IAAfsD,OAAO,CAAItD,IAAI;AACjC,sBAAyB,IAAI,CAACqD,WAAW,CAACrE,OAAO,CAAEsE,OAAO,CAAC,CAApDJ,KAAI,sBAAEkC,QAAQ;AACrB,GAAM7C,SAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,UAAU,CAAE,IAAI,CAACuB,GAAG,CAACZ,KAAI,CAAC,CAAC;AAC1D,MAAOX,SAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAACS,OAAO,CAACP,KAAI,CAAC,CAAC,CAACF,OAAO,CAAC,YAAY,CAAEoC,QAAQ,CAAC;AACzF;;AAEA,IAAK,MAAM,CAAE;AACZ,GAASpG,UAAO,CAAagB,IAAI,IAAfsD,QAAO,CAAItD,IAAI;AACjC,uBAAyB,IAAI,CAACqD,WAAW,CAACrE,SAAO,CAAEsE,QAAO,CAAC,CAApDJ,MAAI,uBAAEkC,SAAQ;AACrB,GAAM7C,UAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,MAAM,CAAC;AACtC,MAAOA,UAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAACS,OAAO,CAACP,MAAI,CAAC,CAAC,CAACF,OAAO,CAAC,YAAY,CAAEoC,SAAQ,CAAC;AACzF;;AAEA,IAAK,eAAe,CAAE,IAAK,YAAY,CAAE,IAAK,cAAc,CAAE;AAC7D,GAASpG,UAAO,CAAgBgB,IAAI,IAAlBqF,IAAI,CAAUrF,IAAI,IAAZoB,IAAI,CAAIpB,IAAI;AACpC,GAAIsF,WAAU,CAAG,EAAE;AACnB,OAAQ5F,GAAG;AACX,IAAK,eAAe,CAAE4F,UAAU,CAAGD,IAAI,CAACvF,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAACV,IAAI,EAAE,CAAE;AAC9D,IAAK,YAAY,CAAEkG,UAAU,CAAGlE,IAAI,CAAE;AACtC,IAAK,cAAc,CAAEkE,UAAU,CAAGD,IAAI,CAAE,MAAM;;AAE9C,GAAIE,aAAY,CAAGtB,IAAI,CAACqB,UAAU,CAAC;AACnC,GAAI9D,KAAE,CAAG,EAAE;AACX,GAAIgE,cAAY,CAAG,WAAW;AAC9B,GAAI9F,GAAG,GAAK,YAAY,CAAE;AACzB,OAAQ6F,YAAY;AACpB,IAAK,aAAa,CAAE/D,IAAE,CAAG,YAAY,CAAE;AACvC,IAAK,eAAe,CAAEA,IAAE,CAAG,UAAU,CAAE;AACvC,IAAK,iBAAiB,CAAEA,IAAE,CAAG,gBAAgB,CAAE;AAC/C,IAAK,eAAe,CAAEA,IAAE,CAAG,iBAAiB,CAAE;AAC9C,IAAK,eAAe,CAAEA,IAAE,CAAG,SAAS,CAAE;AACtC,IAAK,YAAY,CAAEA,IAAE,CAAG,SAAS,CAAEgE,aAAY,CAAG,cAAc,CAAE;AAClE,IAAK,oBAAoB,CAAEhE,IAAE,CAAG,SAAS,CAAE;AAC3C,IAAK,iBAAiB,CAAEA,IAAE,CAAG,SAAS,CAAEgE,aAAY,CAAG,cAAc,CAAE;AACvE,IAAK,gBAAgB,CAAEhE,IAAE,CAAG,cAAc,CAAE;AAC5C,IAAK,WAAW,CAAEA,IAAE,CAAG,cAAc,CAAEgE,aAAY,CAAG,cAAc,CAAE;AACtE,IAAK,kBAAkB,CAAEhE,IAAE,CAAG,WAAW,CAAE;AAC3C,IAAK,YAAY,CAAEA,IAAE,CAAG,WAAW,CAAEgE,aAAY,CAAG,cAAc,CAAE;AACpE,IAAK,cAAc,CAAEhE,IAAE,CAAG,aAAa,CAAE;AACzC,IAAK,QAAQ,CAAEA,IAAE,CAAG,aAAa,CAAEgE,aAAY,CAAG,cAAc,CAAE;AAClE,IAAK,aAAa,CAAEhE,IAAE,CAAG,SAAS,CAAE;AACpC,IAAK,QAAQ,CAAEA,IAAE,CAAG,SAAS,CAAEgE,aAAY,CAAG,cAAc,CAAE,MAAM;;AAErE,CAAC,IAAM,IAAIF,UAAU,CAAE;AACtB9D,IAAE,CAAG,WAAW;AACjB;AACA,GAAMe,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAACiD,aAAY,CAAEhE,IAAE,CAAEvB,MAAM,CAACwF,GAAG,CAAG,EAAE,CAAG,WAAW,CAAC;AAC/E,GAAMC,MAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,SAAO,CAAC;AAClE,MAAO0G,MAAK,CAAGnD,UAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,SAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,WAAW,CAAEsC,UAAU,CAAC;AACrG;;AAEA,IAAK,WAAW,CAAE;AACjB,GAAStG,UAAO,CAAIgB,IAAI;AACxB,GAAMkD,OAAI,CAAGlE,SAAO,CAACG,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC;AAChC,GAAMoD,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,WAAW,CAAEtC,MAAM,CAAC0B,IAAI,CAAE,IAAI,CAACmC,GAAG,CAACZ,MAAI,CAAC,CAAC;AACxE,MAAOX,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAACS,OAAO,CAACP,MAAI,CAAC,CAAC,CAACF,OAAO,CAAC,YAAY,CAAE,IAAI,CAACjE,WAAW,CAACC,SAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,SAAO,CAAC,CAAC;AACtJ;;AAEA,IAAK,OAAO,CAAE;AACb,GAASA,UAAO,CAAIgB,IAAI;AACxB,GAAMuC,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAC;AACvC,MAAOA,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,SAAO,CAAC,CAAC;AAC5D;;AAEA,IAAK,MAAM,CAAE;AACZ,GAASA,UAAO,CAAYgB,IAAI,IAAdsB,MAAM,CAAItB,IAAI;AAChC,GAAI,CAACsB,MAAM,EAAI,CAACqE,KAAK,CAACR,MAAM,CAAC7D,MAAM,CAAC,CAAC,CAAE;AACtC,GAAMiB,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,YAAY,CAAC;AAC5C,MAAOA,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,SAAO,CAAC,CAAC;AAC5D;AACA,GAAMuD,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,MAAM,CAAC;AACtC,MAAOA,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,SAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACsC,MAAM,CAAC,CAAC;AACtG;;AAEA,IAAK,MAAM,CAAE;AACZ,GAAStC,UAAO,CAAUgB,IAAI,IAAZgB,IAAI,CAAIhB,IAAI;AAC9B,GAAI0F,OAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,SAAO,CAAC;AAChE,GAAIiB,MAAM,CAAC2F,OAAO,CAAE;AACnBF,MAAK,CAAG,IAAI,CAACnD,QAAQ,CAAC,SAAS,CAAC,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,SAAO,CAAC,CAAC;AAC7E;AACA,GAAMuD,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,MAAM,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACnD,MAAO+D,OAAK,CAAGnD,UAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,SAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAEhC,IAAI,CAAC;AAC5F;;AAEA,IAAK,MAAM,CAAE;AACZ,GAAOhC,UAAO,CAAkBgB,IAAI,IAApBmB,MAAM,CAAUnB,IAAI,IAAZgB,KAAI,CAAIhB,IAAI;AACpC,GAAMuC,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,MAAM,CAAEpB,MAAM,CAAE,WAAW,CAAC;AAC1D,IAAI,CAACoB,QAAQ,CAACvB,KAAI,CAAG,MAAM,CAAG,YAAY,CAAC;AAC5C,GAAM0E,OAAK,CAAG,IAAI,CAACrB,YAAY,CAAClD,MAAM,CAAElB,MAAM,CAACsB,EAAE,EAAIvC,SAAO,CAAC;AAC7D,MAAO0G,OAAK,CAAGnD,UAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,SAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAEhC,KAAI,CAAC;AAC5F;;AAEA,IAAK,aAAa,CAAE;AACnB,GAAOkC,OAAI,CAAIlD,IAAI;AACnB,GAAM8D,IAAG,CAAG,IAAI,CAACA,GAAG,CAACZ,MAAI,CAAC;AAC1B,GAAIX,WAAQ,CAAG,EAAE;AACjB,GAAI,IAAI,CAAC5D,IAAI,GAAK,CAAC,CAAE;AACpB,GAAImF,GAAG,CAAEvB,UAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,YAAY,CAAEuB,GAAG,CAAC;AACrD,CAAC,IAAM;AACNvB,UAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,YAAY,CAAEuB,GAAG,CAAC;AAC5C;AACA,MAAOvB,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAACS,OAAO,CAACP,MAAI,CAAC,CAAC;AACzD;;AAEA,IAAK,SAAS,CAAE;AACf,GAAO2C,QAAO,CAAI7F,IAAI;AACtB,MAAO,EAAE,CAAG6F,OAAO,CAAG,IAAI;AAC3B;;AAEA,IAAK,QAAQ,CAAE;AACd,GAAO7G,WAAO,CAAkBgB,IAAI,IAApBmB,QAAM,CAAUnB,IAAI,IAAZoB,IAAI,CAAIpB,IAAI;AACpC,GAAM0F,OAAK,CAAG,IAAI,CAACrB,YAAY,CAAClD,QAAM,CAAEnC,UAAO,CAAC,EAAI,IAAI,CAACqF,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AACxG,GAAIwC,KAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACN,QAAM,CAAC;AAC1C,GAAIK,IAAE,GAAK,YAAY,CAAE;AACxB,GAAMe,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,YAAY,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACzD,MAAO+D,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE5B,IAAI,CAAC,CAAC4B,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC;AACzI;AACA,GAAIC,IAAE,GAAK,SAAS,CAAE;AACrB,GAAMe,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,SAAS,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACtD,MAAO+D,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE5B,IAAI,CAAC;AAC5F;AACA,GAAII,IAAE,CAACvC,UAAU,CAAC,WAAW,CAAC,CAAE;AAC/B,GAAMgG,MAAG,CAAGzD,IAAE,CAACrC,KAAK,CAAC,CAAC,CAAC;AACvB,GAAMoD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAE,WAAW,CAAC;AACpD,MAAOmD,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAEiC,KAAG,CAAC;AAC7F;AACA,GAAIzD,IAAE,CAACvC,UAAU,CAAC,QAAQ,CAAC,CAAE;AAC5B,GAAMgG,MAAG,CAAGzD,IAAE,CAACrC,KAAK,CAAC,CAAC,CAAC;AACvB,GAAMoD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,UAAU,CAAE,YAAY,CAAC;AACxD,MAAOmD,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAEiC,KAAG,CAAC;AAC7F;AACA,GAAIzD,IAAE,CAACvC,UAAU,CAAC,gBAAgB,CAAC,EAAIuC,IAAE,CAACvC,UAAU,CAAC,YAAY,CAAC,CAAE;AACnE,GAAMuF,KAAI,CAAGhD,IAAE,CAACrC,KAAK,CAAC,CAAC,CAAC,CAAC;AACzB,GAAMoD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAEf,IAAE,CAACrC,KAAK,CAAC,CAAC,CAAEqC,IAAE,CAACtB,MAAM,CAAG,CAAC,CAAC,CAAC;AACnE,MAAOwF,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE5E,gBAAgB,CAACoG,IAAI,CAACA,IAAI,CAAC,CAAC;AACnH;AACA,GAAIlC,WAAU,CAAG,OAAO;AACxB,GAAIrC,MAAM,CAAC6F,OAAO,CAAExD,UAAU,CAAG,gBAAgB;AACjD,GAAIrC,MAAM,CAAC8F,OAAO,CAAEzD,UAAU,CAAG,kBAAkB;AACnD,GAAIrC,MAAM,CAAC2F,OAAO,CAAEtD,UAAU,CAAG,kBAAkB;AACnD,GAAIrC,MAAM,CAAC+F,MAAM,CAAE1D,UAAU,CAAG,UAAU;AAC1C,GAAIrC,MAAM,CAACyB,KAAK,CAAEY,UAAU,CAAG,OAAO;AACtC,GAAIrC,MAAM,CAACgG,MAAM,CAAE3D,UAAU,CAAG,QAAQ;AACxC,GAAId,IAAE,GAAK,MAAM,EAAI,IAAI,CAAC9C,GAAG,EAAI,CAAC,CAAE4D,UAAU,CAAG,UAAU,CAAG,IAAI,CAAC5D,GAAG;AACtE,GAAI8C,IAAE,GAAK,SAAS,EAAIA,IAAE,GAAK,aAAa,CAAEc,UAAU,CAAG,WAAW;AACtE,GAAIA,UAAU,GAAK,OAAO,gBAAIrC,MAAM,CAAC0B,IAAI,SAAX,aAAa1C,UAAU,CAAC,OAAO,CAAC,CAAE;AAC/DqD,UAAU,EAAI,UAAU;AACzB;AACA,GAAMC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,UAAU,CAAEnB,QAAM,CAAC;AAClD,MAAOuE,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAACA,QAAM,CAAC,CAAC,CAAC6B,OAAO,CAAC,QAAQ,CAAE5B,IAAI,CAAC,CAAC4B,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC,CAACyB,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAAClB,MAAM,CAAC0B,IAAI,CAAC,CAAC;AAC9N;;AAEA,IAAK,MAAM,CAAE;AACZ,GAAO3C,WAAO,CAAYgB,IAAI,IAAdmB,QAAM,CAAInB,IAAI;AAC9B,GAAM0F,OAAK,CAAG,IAAI,CAACrB,YAAY,CAAClD,QAAM,CAAEnC,UAAO,CAAC,EAAI,IAAI,CAACqF,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AACxG,GAAIwC,KAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACN,QAAM,CAAC;AAC1C,GAAIK,IAAE,GAAK,YAAY,EAAIA,IAAE,GAAK,aAAa,CAAE;AAChD,GAAMe,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,UAAU,CAAEpB,QAAM,CAAC;AAClD,MAAOuE,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACnE;AACA,GAAIsD,YAAU,CAAG,KAAK;AACtB,GAAIC,YAAQ,CAAG,EAAE;AACjB,kBAAItC,MAAM,CAAC0B,IAAI,SAAX,cAAa1C,UAAU,CAAC,OAAO,CAAC,CAAE;AACrCsD,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,aAAa,CAAEpB,QAAM,CAAC;AAChD;AACA,GAAI,CAACoB,WAAQ,CAAEA,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,WAAU,CAAEnB,QAAM,CAAC;AAC3D,MAAOuE,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAACA,QAAM,CAAC,CAAC,CAAC6B,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC,CAACyB,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAAClB,MAAM,CAAC0B,IAAI,CAAC,CAAC;AACtM;;AAEA,IAAK,UAAU,CAAE;AAChB,GAAO3C,WAAO,CAA+BgB,IAAI,IAAjCkB,OAAO,CAAsBlB,IAAI,IAAxBkG,UAAU,CAAUlG,IAAI,IAAZqB,IAAI,CAAIrB,IAAI;AACjD,GAAI0F,OAAK,CAAG,EAAE;AACd,GAAIQ,UAAU,GAAKA,UAAU,CAACjH,UAAU,CAAC,IAAI,CAAC,EAAIiH,UAAU,CAACjH,UAAU,CAAC,IAAI,CAAC,EAAIiH,UAAU,GAAK,OAAO,CAAC,CAAE;AACzG7E,IAAI,CAAG6E,UAAU;AACjBA,UAAU,CAAG,EAAE;AAChB;AACA,GAAIA,UAAU,CAAER,MAAK,EAAI,IAAI,CAACxE,OAAO,CAACgF,UAAU,CAAElH,UAAO,CAAC;AAC1D0G,MAAK,EAAI,IAAI,CAACxE,OAAO,CAACA,OAAO,CAAElC,UAAO,CAAC;AACvC,GAAIiB,MAAM,CAACkG,IAAI,CAAE;AAChB,GAAM5D,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACpD,MAAO+D,OAAK,CAAGnD,WAAQ;AACxB;AACA,GAAItC,MAAM,CAAC0B,IAAI,CAAE;AAChB+D,MAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE3C,UAAO,CAAC,CAAG0G,MAAK;AACvD,GAAMnD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,eAAe,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AAC5D,MAAO+D,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,WAAW,CAAE,IAAI,CAAC7B,MAAM,CAACD,OAAO,CAAC,CAAC,CAAC8B,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC;AAC5J;AACA,GAAMC,MAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACP,OAAO,CAAC;AAC7C,GAAIM,KAAE,GAAK,SAAS,CAAE;AACrB,GAAMe,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAErB,OAAO,CAAC;AAChD,MAAOwE,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,QAAQ,CAAE,IAAI,CAACW,IAAI,CAAC3E,UAAO,CAACG,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAE,IAAI,CAAC,CAAC;AAChF;AACA,GAAImD,aAAU,CAAG,OAAO;AACxB,GAAId,KAAE,GAAK,cAAc,EAAIA,KAAE,GAAK,QAAQ,CAAEc,YAAU,CAAG,UAAU;AACrE,GAAMC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,YAAU,CAAEpB,OAAO,CAAE,WAAW,CAAC;AAChE,MAAOwE,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,aAAa,CAAE;AACnB,GAAOA,WAAO,CAAagB,IAAI,IAAfkB,QAAO,CAAIlB,IAAI;AAC/B,GAAIkB,QAAO,CAAE,MAAO,KAAI,CAACA,OAAO,CAACA,QAAO,CAAElC,UAAO,CAAC;AAClD,GAAM0G,OAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAMuD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAE,aAAa,CAAC;AACtD,MAAOmD,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,OAAO,CAAE;AACb,GAASA,WAAO,CAAUgB,IAAI,IAAZe,IAAI,CAAIf,IAAI;AAC9B,GAAMwB,MAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC;AACjD,GAAIL,QAAM,CAAG,EAAE;AACf,GAAI,CAAC,UAAU,CAAE,YAAY,CAAC,CAACM,QAAQ,CAACJ,KAAE,CAAC,CAAE;AACtB,CAACvB,MAAM,CAACsB,EAAE,CAAE,EAAE,CAAC,CAApCD,OAAM,UAAErB,MAAM,CAACsB,EAAE;AACnB;AACA,GAAMmE,OAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAI,CAAC,OAAO,CAAE,OAAO,CAAE,QAAQ,CAAE,UAAU,CAAE,YAAY,CAAC,CAAC4C,QAAQ,CAACJ,KAAE,CAAC,CAAE;AACxE,GAAMe,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,UAAU,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACvD,MAAO+D,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAACJ,IAAI,CAAC,CAAC,CAACiC,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACsC,OAAM,EAAIrB,MAAM,CAACsB,EAAE,CAAC,CAAC;AAChK;AACA,GAAIC,KAAE,GAAK,OAAO,CAAE;AACnB,GAAM4E,UAAS,CAAGnG,MAAM,CAACsB,EAAE,EAAIvC,UAAO,EAAIiB,MAAM,CAACsB,EAAE,GAAKvC,UAAO;AAC/D,GAAMuD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC6D,SAAS,CAAG,UAAU,CAAG,kBAAkB,CAAE,OAAO,CAAC;AACpF,MAAOV,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC,CAACyB,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAACJ,IAAI,CAAC,CAAC,CAACiC,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACtJ;AACA,GAAIiB,MAAM,CAAC0B,IAAI,CAAE;AAChB,GAAMY,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,SAAS,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACtD,MAAO+D,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAACJ,IAAI,CAAC,CAAC;AACzG;AACA,GAAMwB,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAExB,IAAI,CAAE,WAAW,CAAC;AAC1D,MAAO2E,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,UAAU,CAAE;AAChB,GAAOA,WAAO,CAAUgB,IAAI,IAAZe,KAAI,CAAIf,IAAI;AAC5B,GAAM0F,OAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAIiB,MAAM,CAACoG,GAAG,CAAE;AACf,GAAM9D,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,SAAS,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACtD,MAAO+D,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAACJ,KAAI,CAAC,CAAC;AACzG;AACA,GAAMS,MAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC;AACjD,GAAIH,KAAE,GAAK,KAAK,CAAE;AACjB,GAAMe,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,QAAQ,CAAExB,KAAI,CAAC;AAC9C,MAAO2E,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAACJ,KAAI,CAAC,CAAC,CAACiC,OAAO,CAAC,QAAQ,CAAE/C,MAAM,CAACe,IAAI,CAAC;AACxI;AACA,GAAIQ,KAAE,GAAK,UAAU,CAAE;AACtB,GAAMe,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,YAAY,CAAE,UAAU,CAAC;AACxD,MAAOmD,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC,CAACyB,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAACJ,KAAI,CAAC,CAAC;AAC1G;AACA,GAAId,MAAM,CAAC0B,IAAI,CAAE;AAChB,GAAMY,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,YAAY,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACzD,MAAO+D,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAACJ,KAAI,CAAC,CAAC,CAACiC,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC;AACtJ;AACA,GAAItB,MAAM,CAACqG,MAAM,CAAE;AAClB,GAAM/D,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,gBAAgB,CAAC;AAChD,MAAOmD,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAACJ,KAAI,CAAC,CAAC;AACzG;AACA,GAAIwB,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,KAAK,CAAExB,KAAI,CAAE,WAAW,CAAC;AACtD,GAAI,CAACwB,WAAQ,CAAEA,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,cAAc,CAAC,CAACS,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAACJ,KAAI,CAAC,CAAC;AAC5F,MAAO2E,OAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC;AACjH;;AAEA,IAAK,SAAS,CAAE;AACf,GAASvC,WAAO,CAAYgB,IAAI,IAAda,MAAM,CAAIb,IAAI;AAChC,GAAM0F,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAIZ,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC,GAAK,MAAM,CAAE;AACtD,GAAMY,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,eAAe,CAAE1B,MAAM,CAAC;AACvD,MAAO6E,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;AACA,GAAMuD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAE1B,MAAM,CAAC;AAC/C,MAAO6E,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,aAAa,CAAE;AACnB,GAASA,WAAO,CAAYgB,IAAI,IAAda,OAAM,CAAIb,IAAI;AAChC,GAAI5B,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC,GAAK,aAAa,CAAE;AAC7D,GAAMY,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,UAAU,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACvD,MAAOY,YAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AAC5D;AACA,GAAM0G,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,kBAAIiB,MAAM,CAAC0B,IAAI,SAAX,cAAa1C,UAAU,CAAC,OAAO,CAAC,CAAE;AACrC,GAAMsD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,aAAa,CAAE1B,OAAM,CAAC;AACrD,MAAO6E,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAAClB,MAAM,CAAC0B,IAAI,CAAC,CAAC;AAChH;AACA,GAAI1B,MAAM,CAACsG,IAAI,CAAE;AAChB,GAAMhE,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,aAAa,CAAE1B,OAAM,CAAC;AACrD,MAAO6E,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAAClB,MAAM,CAAC0B,IAAI,CAAC,CAAC;AAChH;AACA,GAAIY,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,KAAK,CAAE1B,OAAM,CAAE,WAAW,CAAC;AACxD,GAAI,CAAC0B,WAAQ,CAAEA,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,KAAK,CAAC,CAACS,OAAO,CAAC,UAAU,CAAEnC,OAAM,CAAC;AAC1E,MAAO6E,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,WAAW,CAAE;AACjB,MAAO,KAAI,CAACuD,QAAQ,CAAC,UAAU,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AAC9C;;AAEA,IAAK,aAAa,CAAE,IAAK,aAAa,CAAE;AACvC,GAAS3C,WAAO,CAAYgB,IAAI,IAAdmB,QAAM,CAAInB,IAAI;AAChC,GAAM0F,QAAK,CAAG,IAAI,CAACrB,YAAY,CAAClD,QAAM,CAAElB,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAC5D,IAAI,CAACqF,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AACrD,GAAIwC,MAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACN,QAAM,CAAC;AAC1C,GAAIK,KAAE,GAAK,UAAU,CAAE;AACtB,GAAMe,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,UAAU,CAAEpB,QAAM,CAAC;AAClD,MAAOuE,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC,CAACyB,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACjH;AACA,GAAIuD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAEpB,QAAM,CAAE,WAAW,CAAC;AAC1D,GAAI,CAACoB,WAAQ,CAAEA,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAC,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAACA,QAAM,CAAC,CAAC;AACzF,MAAOuE,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC,CAACyB,OAAO,CAAC,QAAQ,CAAE,IAAI,CAACW,IAAI,CAAC3E,UAAO,CAACG,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC,CAAC;AACnK;;AAEA,IAAK,YAAY,CAAE;AAClB,GAAO+D,OAAI,CAAYlD,IAAI,IAAdmB,QAAM,CAAInB,IAAI;AAC3B,GAAIuC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAEpB,QAAM,CAAE,WAAW,CAAC;AAC1D,GAAI,CAACoB,WAAQ,CAAEA,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,iBAAiB,CAAC,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAACA,QAAM,CAAC,CAAC;AACnG,MAAOoB,YAAQ,CAACS,OAAO,CAAC,QAAQ,CAAE,IAAI,CAACW,IAAI,CAACT,MAAI,CAAC,CAAC,CAACF,OAAO,CAAC,SAAS,CAAE,IAAI,CAACe,KAAK,CAACb,MAAI,CAAC,CAAC;AACxF;;AAEA,IAAK,UAAU,CAAE;AAChB,GAAOA,OAAI,CAAYlD,IAAI,IAAdmB,QAAM,CAAInB,IAAI;AAC3B,GAAIuC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,KAAK,CAAEpB,QAAM,CAAE,WAAW,CAAC;AACxD,GAAI,CAACoB,WAAQ,CAAEA,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,eAAe,CAAC,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAACA,QAAM,CAAC,CAAC;AACjG,MAAOoB,YAAQ,CAACS,OAAO,CAAC,QAAQ,CAAE,IAAI,CAACW,IAAI,CAACT,MAAI,CAAC,CAAC,CAACF,OAAO,CAAC,SAAS,CAAE,IAAI,CAACe,KAAK,CAACb,MAAI,CAAC,CAAC;AACxF;;AAEA,IAAK,UAAU,CAAE;AAChB,GAASsD,QAAO,CAAIxG,IAAI;AACxB,GAAI,CAACwG,OAAO,EAAIA,OAAO,GAAK,MAAM,CAAE;AACnC,GAAMjE,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,KAAK,CAAEtC,MAAM,CAAC0B,IAAI,CAAE,WAAW,CAAC;AAC/D,GAAI,CAACY,WAAQ,CAAE,MAAO,KAAI,CAACA,QAAQ,CAAC,gBAAgB,CAAC,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAACqF,OAAO,CAAC,CAAC;AAC/F,MAAOjE,YAAQ;AAChB;AACA,GAAItC,MAAM,CAACgG,MAAM,CAAE;AAClB,MAAO,KAAI,CAAC1D,QAAQ,CAAC,QAAQ,CAAEiE,OAAO,CAAE,WAAW,CAAC;AACrD;AACA,GAAMd,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,CAAC;AACvD,GAAInD,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC,GAAK,iBAAiB,CAAE;AACjE,MAAO+D,QAAK,CAAG,IAAI,CAACnD,QAAQ,CAAC,OAAO,CAAE,iBAAiB,CAAC,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC;AACvG;AACA,GAAIgB,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAEiE,OAAO,CAAE,WAAW,CAAC;AAC3D,GAAI,CAACjE,WAAQ,CAAEA,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,kBAAkB,CAAC,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAACqF,OAAO,CAAC,CAAC;AACrG,MAAOd,QAAK,CAAGnD,WAAQ;AACxB;;AAEA,IAAK,aAAa,CAAE,IAAK,gBAAgB,CAAE;AAC1C,GAASpB,SAAM,CAAInB,IAAI;AACvB,GAAM0F,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,CAAC;AACvD,GAAInD,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC,GAAK,cAAc,CAAE;AAC9D,MAAO+D,QAAK,CAAG,IAAI,CAACnD,QAAQ,CAAC,OAAO,CAAE,cAAc,CAAC,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC;AACpG;AACA,GAAIe,aAAU,CAAG5C,GAAG,CAACP,KAAK,CAAC,CAAC,CAAC;AAC7B,GAAIf,gBAAgB,CAACqD,QAAQ,CAACN,QAAM,CAAC,GAAK,YAAY,CAAEmB,YAAU,CAAG,OAAO;AAC5E,GAAIC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,YAAU,CAAEnB,QAAM,CAAE,WAAW,CAAC;AAC7D,GAAI,CAACoB,WAAQ,CAAEA,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,kBAAkB,CAAC,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAACA,QAAM,CAAC,CAAC;AACpG,MAAOuE,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC;AACtE;;AAEA,IAAK,WAAW,CAAE;AACjB,GAAOJ,SAAM,CAAInB,IAAI;AACrB,GAAIuC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,KAAK,CAAEpB,QAAM,CAAE,WAAW,CAAC;AACxD,GAAI,CAACoB,WAAQ,CAAEA,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,gBAAgB,CAAC,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAACA,QAAM,CAAC,CAAC;AAClG,MAAOoB,YAAQ;AAChB;;AAEA,IAAK,QAAQ,CAAE;AACd,GAAIpB,UAAM,CAAGlB,MAAM,CAAC0B,IAAI;AACxB,MAAO,KAAI,CAACY,QAAQ,CAAC,UAAU,CAAEpB,SAAM,CAAC;AACzC;;AAEA,IAAK,UAAU,CAAE;AAChB,GAAO0E,SAAO,CAAI7F,IAAI;AACtB,MAAO,IAAI,CAAG6F,QAAO,CAAG,IAAI;AAC7B;;AAEA,IAAK,OAAO,CAAE;AACb,GAAOA,UAAO,CAAI7F,IAAI;AACtB,MAAO,KAAK,CAAG6F,SAAO,CAAG,KAAK;AAC/B;;AAEA,IAAK,WAAW,CAAE;AACjB,GAAO7G,WAAO,CAAoBgB,IAAI,IAAtBmB,SAAM,CAAYnB,IAAI,IAAdsB,QAAM,CAAItB,IAAI;AACtC,GAAIwB,MAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACN,SAAM,CAAC;AAC1C,GAAIK,KAAE,GAAK,WAAW,CAAE;AACvB,MAAO,KAAI,CAACe,QAAQ,CAAC,UAAU,CAAE,WAAW,CAAC,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAACS,OAAO,CAACzE,UAAO,CAACG,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC,CAAC;AACtG;AACA,GAAI,CAACmC,QAAM;AACV,CAAC,YAAY,CAAE,gBAAgB,CAAE,gBAAgB,CAAE,cAAc,CAAE,aAAa,CAAE,OAAO,CAAC,CAACM,QAAQ,CAACJ,KAAE,CAAC,CAAE;AACrF,CAACvB,MAAM,CAACsB,EAAE,CAAEvC,UAAO,CAAC,CAAvCA,UAAO,UAAEsC,QAAM;AAChB,GAAI,CAACtC,UAAO,CAAEA,UAAO,CAAGsC,QAAM;AAC/B;AACA,GAAI,CAACA,QAAM,CAAEA,QAAM,CAAGrB,MAAM,CAACsB,EAAE,EAAIvC,UAAO;;AAE1C,GAAI0G,QAAK,CAAG,IAAI,CAACrB,YAAY,CAAClD,SAAM,CAAEnC,UAAO,CAAC;;AAE9C,GAAIwC,KAAE,GAAK,QAAQ,EAAIA,KAAE,GAAK,YAAY,CAAE;AAC3C,GAAMe,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAEpB,SAAM,CAAC;AAC/C,MAAOuE,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC,CAACyB,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACjH;;AAEA,GAAI,CAACwC,KAAE,GAAK,OAAO,EAAIA,KAAE,GAAK,gBAAgB,GAAKvB,MAAM,CAACiB,OAAO,CAAE;AAClEwE,OAAK,EAAI,IAAI,CAACxE,OAAO,CAACjB,MAAM,CAACiB,OAAO,CAAEI,QAAM,CAAC;AAC7CoE,OAAK,EAAI,IAAI,CAACxE,OAAO,CAACM,KAAE,GAAK,OAAO,CAAG,OAAO,CAAG,iBAAiB,CAAEF,QAAM,CAAC;AAC3E,GAAMiB,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,eAAe,CAAEf,KAAE,CAAC;AACnD,MAAOkE,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACsC,QAAM,CAAC,CAAC;AAClE;;AAEA,GAAIgB,aAAU,CAAG,UAAU;AAC3B,GAAId,KAAE,GAAK,UAAU,EAAIxC,UAAO,GAAKsC,QAAM,CAAE;AAC5CgB,YAAU,CAAG,kBAAkB;AAChC;AACA,GAAI,CAACd,KAAE,GAAK,gBAAgB,EAAIA,KAAE,GAAK,YAAY,GAAKvB,MAAM,CAACwG,QAAQ,CAAE;AACxEnE,YAAU,CAAG,kBAAkB;AAChC;AACA,GAAIC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,YAAU,CAAEnB,SAAM,CAAE,WAAW,CAAC;AAC7D,GAAI,CAACoB,WAAQ,CAAE;AACd,GAAImD,OAAK,CAAE,MAAOA,QAAK;AACvBnD,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,UAAU,CAAC;AACpC,MAAOmD,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAACA,SAAM,CAAC,CAAC;AACjE;;AAEA,GAAIK,KAAE,GAAK,YAAY,CAAE;AACxBe,WAAQ,CAAGA,WAAQ,CAACS,OAAO,CAAC,QAAQ,CAAE,IAAI,CAACW,IAAI,CAACrC,QAAM,CAACnC,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC,CAAC;AACrE;AACA,GAAIc,MAAM,CAACiB,OAAO,CAAE;AACnBwE,OAAK,EAAI,IAAI,CAACxE,OAAO,CAACjB,MAAM,CAACiB,OAAO,CAAElC,UAAO,CAAC;AAC/C;AACA,GAAIiB,MAAM,CAAC4B,QAAQ,CAAE;AACpB6D,OAAK,EAAI,IAAI,CAACxE,OAAO,CAACjB,MAAM,CAAC4B,QAAQ,CAAEP,QAAM,CAAC;AAC/C;AACA,GAAIrB,MAAM,CAACe,IAAI,EAAIf,MAAM,CAACgB,MAAM,EAAIhB,MAAM,CAACc,IAAI,EAAId,MAAM,CAACU,IAAI,CAAE;AAC/D4B,WAAQ,CAAGA,WAAQ,CAACS,OAAO,CAAC,QAAQ,CAAE/C,MAAM,CAACe,IAAI,CAAC,CAACgC,OAAO,CAAC,UAAU,CAAE/C,MAAM,CAACgB,MAAM,CAAC,CAAC+B,OAAO,CAAC,QAAQ,CAAE/C,MAAM,CAACc,IAAI,CAAC,CAACiC,OAAO,CAAC,QAAQ,CAAE/C,MAAM,CAACU,IAAI,CAAC;AACpJ;AACA,MAAO+E,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACsC,QAAM,CAAC,CAAC,CAAC0B,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC;AAC3J;;AAEA,IAAK,UAAU,CAAE;AAChB,GAASvC,WAAO,CAAoBgB,IAAI,IAAtBmB,SAAM,CAAYnB,IAAI,IAAdsB,QAAM,CAAItB,IAAI;AACxC,GAAMuC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,SAAS,CAAEpB,SAAM,CAAC;AACjD,MAAOoB,YAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACsC,QAAM,CAAC,CAAC;AACtG;;AAEA,IAAK,SAAS,CAAE;AACf,GAAOtC,WAAO,CAAkBgB,IAAI,IAAlB0G,UAAU,CAAI1G,IAAI;AACpC,GAAIuC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,QAAQ,CAAEtC,MAAM,CAAC0B,IAAI,CAAE,WAAW,CAAC;AAChE,GAAM+D,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAMwC,MAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC;AACjD,GAAIY,WAAQ,CAAE;AACb,MAAOmD,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,GAAI,CAACiB,MAAM,CAAC0B,IAAI,CAAE;AACjBY,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAACmE,UAAU,CAAG,kBAAkB,CAAG,QAAQ,CAAC;AACpE,MAAOhB,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,cAAc,CAAE0D,UAAU,CAAC;AACxG;AACA,GAAIzG,MAAM,CAAC0B,IAAI,CAAC1C,UAAU,CAAC,OAAO,CAAC,CAAE;AACpCsD,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAACtC,MAAM,CAACsB,EAAE,CAAG,mBAAmB,CAAG,gBAAgB,CAAC;AAC5E,MAAOmE,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAAClB,MAAM,CAAC0B,IAAI,CAAC,CAAC,CAACqB,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC;AAC7J;AACA,GAAItB,MAAM,CAAC0G,gBAAgB,EAAInF,KAAE,GAAK,MAAM,EAAIA,KAAE,GAAK,MAAM,CAAE;AAC9De,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,2BAA2B,CAAC;AACrD,MAAOmD,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAAClB,MAAM,CAAC0B,IAAI,CAAC,CAAC;AAChH;;AAEAY,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,QAAQ,CAAC;AAClC,MAAOmD,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,OAAO,CAAE;AACb,GAAOA,WAAO,CAAIgB,IAAI;AACtB,GAAIuC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,MAAM,CAAEtC,MAAM,CAAC0B,IAAI,CAAE,WAAW,CAAC;AAC9D,GAAM+D,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE3C,UAAO,CAAC;AACrD,GAAIuD,WAAQ,CAAE;AACb,MAAOmD,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiB,MAAM,CAACsB,EAAE,CAAC,CAAC,CAACyB,OAAO,CAAC,YAAY,CAAE/C,MAAM,CAAC2G,MAAM,CAAC;AACtJ;;AAEA,GAAI3G,MAAM,CAAC0B,IAAI,EAAI,CAAC1B,MAAM,CAAC0B,IAAI,CAAC1C,UAAU,CAAC,UAAU,CAAC,CAAE;AACvDsD,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,gBAAgB,CAAC;AAC1C,MAAOmD,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAC7B,MAAM,CAAClB,MAAM,CAAC0B,IAAI,CAAC,CAAC;AAClH;;AAEAY,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,MAAM,CAAC;AAChC,MAAOmD,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,QAAQ,CAAE,IAAK,UAAU,CAAE;AAC/B,GAAOA,WAAO,CAAegB,IAAI,IAAjBwE,MAAI,CAASxE,IAAI,IAAXiF,KAAG,CAAIjF,IAAI;AACjC,GAAIwE,MAAI,GAAK,KAAK,EAAI,IAAI,CAAC9F,GAAG,GAAK,CAAC,CAAE8F,MAAI,CAAG,KAAK;AAClD,GAAMqC,OAAM,CAAG3B,QAAQ,CAACD,KAAG,CAAE,EAAE,CAAC;AAChC,GAAMS,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAIsD,aAAU,CAAG5C,GAAG,CAACP,KAAK,CAAC,CAAC,CAAC;AAC7B,GAAI0H,MAAM,EAAI,CAAC,CAAEvE,YAAU,EAAI,GAAG,CAAC;AAC9B,GAAIuE,MAAM,EAAI,CAAC,CAAEvE,YAAU,EAAI,GAAG,CAAC;AACnC,GAAIuE,MAAM,GAAK,CAAC,CAAEvE,YAAU,EAAI,GAAG;AACxC,GAAIuE,MAAM,EAAI5G,MAAM,CAAC2F,OAAO,CAAE;AAC7BtD,YAAU,EAAKrC,MAAM,CAAC6G,QAAQ,CAAG,qBAAqB,CAAG,aAAc;AACxE,CAAC,IAAM,IAAID,MAAM,iBAAI5G,MAAM,CAAC0B,IAAI,SAAX,cAAa1C,UAAU,CAAC,OAAO,CAAC,CAAE;AACtD,GAAMsD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,YAAU,CAAG,UAAU,CAAErC,MAAM,CAAC0B,IAAI,CAAC;AACpE,MAAO+D,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE5E,gBAAgB,CAACoG,IAAI,CAACA,MAAI,CAAC,CAAC,CAACxB,OAAO,CAAC,QAAQ,CAAE,IAAI,CAAC7B,MAAM,CAAClB,MAAM,CAAC0B,IAAI,CAAC,CAAC;AAC/J;AACA,GAAMY,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,YAAU,CAAErC,MAAM,CAAC0B,IAAI,CAAC;AACvD,MAAO+D,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAE5E,gBAAgB,CAACoG,IAAI,CAACA,MAAI,CAAC,CAAC;AACnH;;AAEA,IAAK,WAAW,CAAE;AACjB,GAASxF,WAAO,CAAIgB,IAAI;AACxB,GAAMmB,UAAM,CAAGlB,MAAM,CAAC0B,IAAI;AAC1B,GAAM+D,QAAK,CAAG,IAAI,CAACrB,YAAY,CAAClD,SAAM,CAAElB,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAC7D,GAAMuD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAEpB,SAAM,CAAC;AAC/C,MAAOuE,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,YAAY,CAAE;AAClB,GAASA,WAAO,CAAYgB,IAAI,IAAdsB,QAAM,CAAItB,IAAI;AAChC,GAAM0F,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAMwC,MAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC;AACjD,GAAIW,aAAU,CAAG,WAAW;AAC5B,GAAId,KAAE,GAAK,WAAW,CAAEc,YAAU,CAAG,oBAAoB;AACzD,GAAId,KAAE,GAAK,WAAW,CAAEc,YAAU,CAAG,oBAAoB;AACzD,GAAMC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,YAAU,CAAErC,MAAM,CAAC0B,IAAI,CAAC;AACvD,MAAO+D,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACsC,QAAM,CAAC,CAAC;AAC9G;;AAEA,IAAK,YAAY,CAAE;AAClB,GAAStC,WAAO,CAAYgB,IAAI,IAAdsB,QAAM,CAAItB,IAAI;AAChC,GAAM0F,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAMuD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,WAAW,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACxD,MAAO+D,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACsC,QAAM,CAAC,CAAC;AAC9G;;AAEA,IAAK,aAAa,CAAE,IAAK,qBAAqB,CAAE,IAAK,qBAAqB,CAAE;AAC3E,GAAStC,WAAO,CAAYgB,IAAI,IAAd+G,MAAM,CAAI/G,IAAI;AAChC,GAAM0F,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAIsD,aAAU,CAAG,YAAY;AAC7B,GAAIrC,MAAM,CAAC2F,OAAO,CAAEtD,YAAU,CAAG,uBAAuB;AACxD,GAAMC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,YAAU,CAAErC,MAAM,CAAC0B,IAAI,CAAC;AACvD,MAAO+D,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAAC+H,MAAM,CAAC,CAAC;AAC9G;;AAEA,IAAK,cAAc,CAAE;AACpB,GAAS/H,WAAO,CAAIgB,IAAI;AACxB,GAAM0F,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAMuD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,aAAa,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AAC1D,MAAO+D,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,gBAAgB,CAAE;AACtB,MAAO,KAAI,CAACuD,QAAQ,CAAC,eAAe,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AACnD;;AAEA,IAAK,OAAO,CAAE,IAAK,iBAAiB,CAAE,IAAK,WAAW,CAAE;AACvD,GAAS3C,WAAO,CAAIgB,IAAI;AACxB,GAAIsC,aAAU,CAAG5C,GAAG,CAACP,KAAK,CAAC,CAAC,CAAC;AAC7B,GAAImD,YAAU,GAAK,gBAAgB,CAAEA,YAAU,CAAG,gBAAgB;AAClE,GAAIrC,MAAM,CAAC+G,MAAM,CAAE1E,YAAU,EAAI,QAAQ;AACzC,GAAMC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,YAAU,CAAC;AAC1C,MAAOC,YAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AAC5D;;AAEA,IAAK,QAAQ,CAAE;AACd,GAAOA,WAAO,CAA4BgB,IAAI,IAA9BmB,SAAM,CAAoBnB,IAAI,IAAtBgB,MAAI,CAAchB,IAAI,IAAhBiH,QAAQ,CAAIjH,IAAI;AAC9C,GAAM0F,QAAK,CAAG,IAAI,CAACrB,YAAY,CAAClD,SAAM,CAAElB,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAC7D,GAAIwC,MAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACN,SAAM,CAAC;AAC1C,GAAImB,aAAU,CAAG,OAAO;AACxB,GAAId,KAAE,GAAK,MAAM,EAAI,IAAI,CAAC9C,GAAG,EAAI,CAAC,CAAE4D,YAAU,CAAG,UAAU,CAAG,IAAI,CAAC5D,GAAG;AACtE,GAAM6D,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,YAAU,CAAEnB,SAAM,CAAC;AAClD,MAAOuE,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACiI,QAAQ,EAAIhH,MAAM,CAACsB,EAAE,CAAC,CAAC,CAACyB,OAAO,CAAC,QAAQ,CAAEhC,MAAI,CAAC;AACrJ;;AAEA,IAAK,OAAO,CAAE;AACb,GAAOhC,WAAO,CAAkBgB,IAAI,IAApBmB,SAAM,CAAUnB,IAAI,IAAZwE,MAAI,CAAIxE,IAAI;AACpC,GAAIwB,MAAE,CAAGpD,gBAAgB,CAACqD,QAAQ,CAACN,SAAM,CAAC;AAC1C,GAAI+F,QAAO,CAAG9I,gBAAgB,CAACqD,QAAQ,CAACxB,MAAM,CAAC0B,IAAI,CAAC;AACpD,GAAM+D,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAIsD,cAAU,CAAG,OAAO;AACxB,GAAI,CAAC,cAAc,CAAE,eAAe,CAAC,CAACV,QAAQ,CAACsF,OAAO,CAAC;AACtD,CAAC,CAAC,UAAU,CAAE,WAAW,CAAE,WAAW,CAAE,MAAM,CAAE,MAAM,CAAC,CAACtF,QAAQ,CAACJ,KAAE,CAAC,CAAE;AACtEc,aAAU,CAAG,WAAW;AACzB,CAAC,IAAM,IAAI4E,OAAO,GAAK,QAAQ,EAAIjH,MAAM,CAACwF,GAAG,CAAE;AAC9CnD,aAAU,CAAG,WAAW;AACzB;AACA,GAAIC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,aAAU,CAAErC,MAAM,CAAC0B,IAAI,CAAC;AACrD,GAAIY,WAAQ,CAAE;AACb,MAAOmD,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,GAAIwC,KAAE,GAAK,SAAS,CAAE;AACrBe,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAACiC,MAAI,CAAG,cAAc,CAAG,MAAM,CAAE,SAAS,CAAC;AACnE,MAAOkB,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,QAAQ,CAAEwB,MAAI,CAAC;AAC5F;;AAEAlC,aAAU,CAAG,MAAM;AACnB,GAAI,CAAC,KAAK,CAAE,KAAK,CAAE,KAAK,CAAE,KAAK,CAAE,KAAK,CAAE,YAAY,CAAE,UAAU,CAAC,CAACV,QAAQ,CAACJ,KAAE,CAAC,CAAE;AAC/Ec,aAAU,CAAG,gBAAgB;AAC9B;AACA,GAAIrC,MAAM,CAACkH,KAAK,CAAE7E,aAAU,CAAG,cAAc;AAC7C,GAAIrC,MAAM,CAACmH,IAAI,CAAE9E,aAAU,CAAG,MAAM;AACpC,GAAIrC,MAAM,CAACoH,KAAK,CAAE/E,aAAU,CAAG,gBAAgB;AAC/CC,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,aAAU,CAAEd,KAAE,CAAC;AACxC,MAAOkE,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,SAAS,CAAE;AACf,GAASA,WAAO,CAAIgB,IAAI;AACxB,GAAM0F,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAIuD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,OAAO,CAAEtC,MAAM,CAAC0B,IAAI,CAAC;AAClD,GAAI,CAACY,WAAQ,CAAE;AACd,GAAMD,cAAU,CAAGrC,MAAM,CAACqH,IAAI,CAAG,YAAY,CAAG,QAAQ;AACxD/E,WAAQ,CAAG,IAAI,CAACA,QAAQ,CAACvD,UAAO,CAAGsD,aAAU,CAAG,iBAAiB,CAAErC,MAAM,CAAC0B,IAAI,CAAC;AAChF;AACA,MAAO+D,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,OAAO,CAAE;AACb,GAAS+H,QAAM,CAAa/G,IAAI,IAAfhB,UAAO,CAAIgB,IAAI;AAChC,GAAM0F,QAAK,CAAG,IAAI,CAACrB,YAAY,CAACpE,MAAM,CAAC0B,IAAI,CAAE1B,MAAM,CAACsB,EAAE,EAAIvC,UAAO,CAAC;AAClE,GAAI,CAACA,UAAO,CAAE;AACb,GAAMuD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,eAAe,CAAC;AAC/C,MAAOmD,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAAC+H,OAAM,CAAC,CAAC;AAClE;AACA,GAAMxE,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,MAAM,CAAC;AACtC,MAAOmD,QAAK,CAAGnD,WAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AACpE;;AAEA,IAAK,SAAS,CAAE,IAAK,OAAO,CAAE,IAAK,UAAU,CAAE;AAC9C,MAAO,KAAI,CAACuD,QAAQ,CAAC7C,GAAG,CAACP,KAAK,CAAC,CAAC,CAAC,CAAC;AACnC;;AAEA,IAAK,WAAW,CAAE;AACjB,MAAO,KAAI,CAACoD,QAAQ,CAAC,UAAU,CAAC;AACjC;;AAEA,IAAK,OAAO,CAAE,IAAK,SAAS,CAAE;AAC7B,GAASvD,WAAO,CAAmBgB,IAAI,IAArBwD,OAAO,CAAUxD,IAAI,IAAZe,MAAI,CAAIf,IAAI;AACvC,GAAIwB,MAAE,CAAG,EAAE;AACX,GAAIc,cAAU,CAAG5C,GAAG,CAACP,KAAK,CAAC,CAAC,CAAC;AAC7B,GAAIqE,OAAO,GAAK,UAAU,CAAE;AAC3BhC,KAAE,CAAG,cAAc;AACnBc,aAAU,CAAG,YAAY;AAC1B;AACA,GAAI,CAACd,KAAE,EAAI9B,GAAG,GAAK,OAAO,EAAI,IAAI,CAAChB,GAAG,CAAG,CAAC,CAAE4D,aAAU,CAAG,UAAU;AACnE,GAAI,CAACvB,MAAI,EAAIrB,GAAG,GAAK,OAAO,CAAE4C,aAAU,CAAG,YAAY;AACvD,GAAIC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,aAAU,CAAEd,KAAE,CAAC;AAC5C,GAAM0B,OAAI,CAAGlE,UAAO,CAACG,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC;AAChC,GAAMJ,YAAW,CAAG,IAAI,CAACC,OAAO,CAACA,UAAO,CAAC;AACzC,GAAIU,GAAG,GAAK,OAAO,CAAE;AACpB,GAAM6H,UAAS,CAAG,IAAI,CAAChF,QAAQ,CAAC,eAAe,CAAC;AAChDA,WAAQ,EAAIgF,SAAS,CAACvE,OAAO,CAAC,WAAW,CAAEjE,WAAW,CAAC,CAACiE,OAAO,CAAC,WAAW,CAAEQ,OAAO,CAAC;AACtF;AACA,MAAOjB,YAAQ,CAACS,OAAO,CAAC,WAAW,CAAEjE,WAAW,CAAC,CAACiE,OAAO,CAAC,QAAQ,CAAEjC,MAAI,CAAC,CAACiC,OAAO,CAAC,WAAW,CAAE,IAAI,CAACS,OAAO,CAACP,MAAI,CAAC,CAAC;AACnH;;AAEA,IAAK,eAAe,CAAE;AACrB,GAASlE,WAAO,CAAUgB,IAAI,IAAZkE,IAAI,CAAIlE,IAAI;AAC9B,GAAIwB,MAAE,CAAG,EAAE;AACX,GAAIc,cAAU,CAAG5C,GAAG,CAACP,KAAK,CAAC,CAAC,CAAC;AAC7B,GAAIoD,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAACD,aAAU,CAAEd,KAAE,CAAC;AAC5C,GAAMzC,aAAW,CAAG,IAAI,CAACC,OAAO,CAACA,UAAO,CAAC;AACzC,MAAOuD,YAAQ,CAACS,OAAO,CAAC,WAAW,CAAEjE,YAAW,CAAC,CAACiE,OAAO,CAAC,QAAQ,CAAEkB,IAAI,CAAC;AAC1E;;AAEA,IAAK,SAAS,CAAE;AACf,GAASlF,WAAO,CAAIgB,IAAI;AACxB,GAAMuC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,QAAQ,CAAC;AACxC,MAAOA,YAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AAC5D;;AAEA,IAAK,QAAQ,CAAE;AACd,GAASA,WAAO,CAAIgB,IAAI;AACxB,GAAMuC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,UAAU,CAAE,kBAAkB,CAAC;AAC9D,MAAOA,YAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AAC5D;;AAEA,IAAK,UAAU,CAAE;AAChB,GAASA,WAAO,CAAIgB,IAAI;AACxB,GAAMuC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,SAAS,CAAC;AACzC,MAAOA,YAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC;AAC5D;;AAEA,IAAK,WAAW,CAAE;AACjB,GAAWiG,MAAG,CAAIjF,IAAI;AACtB,GAAIiF,KAAG,GAAK,GAAG,CAAE;AAChB,MAAO,KAAI,CAAC1C,QAAQ,CAAC,kBAAkB,CAAC;AACzC;AACA,MAAO,KAAI,CAACA,QAAQ,CAAC,UAAU,CAAC,CAACS,OAAO,CAAC,UAAU,CAAEiC,KAAG,CAAC;AAC1D;;AAEA,IAAK,UAAU,CAAE;AAChB,GAASjG,WAAO,CAAYgB,IAAI,IAAdsB,QAAM,CAAItB,IAAI;AAChC,GAAMuC,YAAQ,CAAG,IAAI,CAACA,QAAQ,CAAC,UAAU,CAAE,cAAc,CAAC;AAC1D,MAAOA,YAAQ,CAACS,OAAO,CAAC,WAAW,CAAE,IAAI,CAAChE,OAAO,CAACA,UAAO,CAAC,CAAC,CAACgE,OAAO,CAAC,UAAU,CAAE,IAAI,CAAChE,OAAO,CAACsC,QAAM,CAAC,CAAC;AACtG;;AAEA,IAAK,OAAO,CAAE;AACb,MAAO,EAAE;AACV;;AAEA,QAAS;AACR,MAAO,KAAI;AACZ,CAAC;;AAEF,CAAC;;;AAGF,GAAI,MAAOkG,QAAO,GAAK,UAAU,CAAE;;AAEjCC,MAAM,CAASrJ,gBAAgB,CAAGA,gBAAgB;AACpD"}